webpackJsonp([41],{"8CAr":function(t,i,a){"use strict";(function(t){var e=a("3SZ7"),s=a.n(e),n=a("C331");i.a={props:{data:{default:""}},data:function(){return{activityListData:[],creatAjax:null,pageIndex:0,pageSize:10,isLoadMoreData:!1,loadingText:!1,showFilter:!1,filterData:{},timer:null,activityStatusList:[{key:"BEFORE_APPLY_START",value:"报名未开始"},{key:"APPLY_ING",value:"报名进行中"},{key:"BEFORE_ACTIVITY_START",value:"活动未开始"},{key:"ACTIVITY_ING",value:"活动进行中"},{key:"AFTER_ACTIVITY_END",value:"活动已结束"}],pageStatus:{pageOptions:{sort:[{key:"HEAT_SCORE",value:"按热度排序"},{key:"PUBLISH_TIME",value:"按时间排序"}]}},noDataTips:"",isShowBoxShadow:!1,isShowNoMoreDataTips:!1}},created:function(){this._initActivityList({page:this.pageIndex,size:this.pageSize}),this._getActivityTypes(),this._getContentTypes()},methods:{_search:function(t){this.showFilter=!1,"reset"===t&&(this.filterData={}),this.pageIndex=0;var i=JSON.parse(s()(this.filterData));i.size=this.pageSize,i.page=this.pageIndex,this.activityListData=[],this._initActivityList(i)},_checkDetail:function(t){this.$emit("addBread",{route:"/activity/MActivityDetail",title:t.name,data:t})},_initActivityList:function(t){var i=this;this.loadingText=!0,this.isLoadMoreData=!1,this.creatAjax=Object(n.d)({url:"/api/sc/activities/pages",type:"get",data:t,success:function(t){t.state?(i.loadingText=!1,t.data.content.length>0?i.noDataTips="":i.noDataTips="暂无相关数据",t.data.content.forEach(function(t){i.activityListData.push(t)}),t.data.content.length<i.pageSize?(i.isLoadMoreData=!1,i.isShowNoMoreDataTips=!0):(i.isLoadMoreData=!0,i.isShowNoMoreDataTips=!1)):i._toast(t.message)}})},_publishActivity:function(){var t=this;Object(n.d)({url:"/api/sc/organizations/list/join",type:"get",success:function(i){i.state?i.data&&i.data.length>0?t.$emit("addBread",{route:"/activity/MPublishActivity",title:"",data:{publishers:i.data}}):t.$vux.alert.show({title:"您尚未加入任何组织，快去加入吧！"}):t._toast("发布权限检测失败，请稍后重试")}})},_searchActivity:function(){this.$emit("addBread",{route:"/activity/MActivitySearch",title:""})},_filterActivity:function(){this.showFilter=!0},_organizationManagePage:function(){var t=this;Object(n.d)({url:"/api/sc/organizations/list/join-audit",type:"get",success:function(i){i.state?0===i.data.length?t.$emit("addBread",{route:"/organization/MOrganizationSearch",title:""}):t.$emit("addBread",{route:"/organization/MOrganizationManage",title:""}):t._toast(i.message)}})},_toast:function(t){this.$vux.toast.show({text:t,position:"bottom",type:"text"})},_getActivityTimeStatus:function(t){var i=new Date(t.applyStartTime.replace(/-/g,"/")),a=new Date(t.applyEndTime.replace(/-/g,"/")),e=new Date(t.startTime.replace(/-/g,"/")),s=new Date(t.endTime.replace(/-/g,"/")),n=this.creatAjax.getResponseHeader("Date")?new Date(this.creatAjax.getResponseHeader("Date")):new Date,o=i.getTime()-n.getTime(),r=a.getTime()-n.getTime(),c=e.getTime()-n.getTime(),l=s.getTime()-n.getTime(),p="";return p=o>0?this._getTimeString(o,"报名开始","start"):r>0?this._getTimeString(r,"报名截止","end"):c>0?this._getTimeString(c,"活动开始","start"):l>0?this._getTimeString(l,"活动结束","end"):"活动已结束",t.statusStr=p,p},_getTimeString:function(t,i,a){var e=t/1e3,s=Math.floor(e/86400),n=Math.floor((e-24*s*3600)/3600),o=Math.floor((e-24*s*3600-3600*n)/60);if(0!=s)return"距"+i+"还有 "+s+" 天 ";if(0!=n)return"距"+i+"还有 "+n+" 小时 ";if(0==n&&0!=o)if("start"===a){if("报名开始"===i)return"报名即将开始";if("活动开始"===i)return"活动即将开始"}else{if("报名截止"===i)return"报名即将结束";if("活动结束"===i)return"活动即将结束"}},_getContentTypes:function(){var t=this;Object(n.d)({url:"/api/sc/activityContentType",type:"get",success:function(i){i.state?(t.pageStatus.pageOptions.activityType||t.$set(t.pageStatus.pageOptions,"activityType",[]),i.data&&i.data.forEach(function(i){i.childType&&i.childType.forEach(function(a){var e={key:a.id+"",value:a.typeName,parent:i.id+""};t.pageStatus.pageOptions.activityType.push(e)})})):t._toast(i.message)}})},_getActivityTypes:function(){var t=this;Object(n.d)({url:"/api/sc/activities/types",type:"get",success:function(i){i.state?(t.pageStatus.pageOptions.activityCategory||t.$set(t.pageStatus.pageOptions,"activityCategory",[]),i.data&&i.data.forEach(function(i){var a={key:i.id,value:i.name};t.pageStatus.pageOptions.activityCategory.push(a)})):t._toast(i.message)}})}},watch:{filterData:{deep:!0,handler:function(t){}}},mounted:function(){var i=this;this.$pullUpToLoad({container:".activityList-content",down:{height:200,callback:function(){i.pageIndex=0,i.activityListData=[],i._initActivityList({page:i.pageIndex,size:i.pageSize})}},up:{callback:function(){i.isLoadMoreData&&(i.pageIndex++,i._initActivityList({page:i.pageIndex,size:i.pageSize}))}}});var a=this;t(".activityList-content").on("scroll",function(){var i=t(this).scrollTop();a.isShowBoxShadow=i>=50})}}}).call(i,a("W14+"))},KICT:function(t,i){},crxq:function(t,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0});a("tcMF");var e=a("8CAr"),s={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{attrs:{id:"secondClassRoom"}},[a("view-box",[a("x-header",{staticClass:"activityList-header",style:{"box-shadow":t.isShowBoxShadow?"0 0 4px 0 rgba(0,0,0,0.12), 0 4px 4px 0 rgba(0,0,0,0.12)":"none"},attrs:{title:t.isShowBoxShadow}},[a("x-button",{staticClass:"publish-activity-btn",attrs:{slot:"overwrite-left"},nativeOn:{click:function(i){return t._publishActivity(i)}},slot:"overwrite-left"},[t._v("发起")]),t._v(" "),a("div",{staticClass:"activityList-search",attrs:{slot:"overwrite-title"},on:{click:t._searchActivity},slot:"overwrite-title"},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("search"))}},[t._v("search")])]),t._v(" "),a("span",{staticClass:"activityList-header-opt",attrs:{slot:"right"},slot:"right"},[a("i",{staticClass:"maticon filter-icon",domProps:{innerHTML:t._s(t.icons("filter_list"))},on:{click:t._filterActivity}},[t._v("filter_list")]),t._v(" "),a("i",{staticClass:"maticon organization-icon",domProps:{innerHTML:t._s(t.icons("people"))},on:{click:t._organizationManagePage}},[t._v("people")]),t._v(" "),t.isShowPoint?a("span",{staticClass:"tips-point"}):t._e()])],1),t._v(" "),a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[a("popup",{staticClass:"popup-filter",attrs:{height:"100%","is-transparent":""},model:{value:t.showFilter,callback:function(i){t.showFilter=i},expression:"showFilter"}},[a("group",{staticClass:"popup-filter-header"},[a("cell",[a("span",{attrs:{slot:"icon"},on:{click:function(i){t.showFilter=!1}},slot:"icon"},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("navigate_before"))}})]),t._v(" "),a("p",[a("span",{staticClass:"filter-opt",on:{click:function(i){return t._search("reset")}}},[t._v("还原")]),a("span",{staticClass:"filter-opt sure",on:{click:t._search}},[t._v("确定")])])])],1),t._v(" "),a("div",{staticClass:"popup-filter-body",nativeOn:{click:function(i){t.showFilter=!1}}},[a("group",{staticClass:"filter-group"},[a("radio",{attrs:{title:"title",options:t.pageStatus.pageOptions.sort},model:{value:t.filterData.sort,callback:function(i){t.$set(t.filterData,"sort",i)},expression:"filterData['sort']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("datetime",{attrs:{title:"活动时间开始时间"},model:{value:t.filterData.startTime,callback:function(i){t.$set(t.filterData,"startTime",i)},expression:"filterData['startTime']"}}),t._v(" "),a("datetime",{attrs:{title:"活动时间结束时间"},model:{value:t.filterData.endTime,callback:function(i){t.$set(t.filterData,"endTime",i)},expression:"filterData['endTime']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.activityStatusList||[]},model:{value:t.filterData.status,callback:function(i){t.$set(t.filterData,"status",i)},expression:"filterData['status']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.pageStatus.pageOptions.activityType||[]},model:{value:t.filterData.content_type_id,callback:function(i){t.$set(t.filterData,"content_type_id",i)},expression:"filterData['content_type_id']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.pageStatus.pageOptions.activityCategory||[]},model:{value:t.filterData.type_id,callback:function(i){t.$set(t.filterData,"type_id",i)},expression:"filterData['type_id']"}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"activityList-content",attrs:{id:"listOfActivity"}},[t.activityListData.length>0?a("div",[t._l(t.activityListData,function(i,e){return a("div",{key:e,on:{click:function(a){return t._checkDetail(i)}}},[a("div",{staticClass:"activity-positive-card"},[a("flexbox",[e%2!=0?a("flexbox-item",[a("div",{staticClass:"activity-introduction"},[t._v("\n                  "+t._s(i.introduction)+"\n                ")])]):t._e(),t._v(" "),t._l(i.images,function(i,e){return i.isCover?a("flexbox-item",{key:e,staticClass:"img-container-right",attrs:{span:7}},[a("x-img",{staticClass:"activity-cover",attrs:{src:t.imageUrlPrefix+i.image+"?thumb=true",container:"#listOfActivity"}})],1):t._e()}),t._v(" "),e%2==0?a("flexbox-item",[a("div",{staticClass:"activity-introduction"},[t._v("\n                  "+t._s(i.introduction)+"\n                ")])]):t._e()],2),t._v(" "),a("div",{staticClass:"activity-title",attrs:{title:""}},[t._v(t._s(i.name))]),t._v(" "),a("flexbox",[a("flexbox-item",{attrs:{span:7}},[a("div",{staticClass:"activity-time",attrs:{title:""}},[t._v(t._s(t._getActivityTimeStatus(i)))])]),t._v(" "),a("flexbox-item",[a("div",{staticClass:"activity-type set-text-right",attrs:{title:""}},[t._v(t._s(i.typeName))])])],1)],1)])}),t._v(" "),t.loadingText?a("div",{staticClass:"noMoreData"},[t._v("---加载中---")]):t._e(),t._v(" "),!t.isLoadMoreData&&t.isShowNoMoreDataTips?a("div",{staticClass:"noMoreData"},[t._v("---没有更多数据了---")]):t._e()],2):a("div",{staticClass:"nodataText"},[t._v(t._s(t.noDataTips))])])],1)],1)},staticRenderFns:[]};var n=function(t){a("KICT")},o=a("Mz/3")(e.a,s,!1,n,null,null);i.default=o.exports},tcMF:function(t,i,a){"use strict";(function(t){var i=a("3SZ7");a.n(i),a("C331")}).call(i,a("W14+"))}});