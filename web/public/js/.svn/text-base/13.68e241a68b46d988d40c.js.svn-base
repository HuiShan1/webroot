webpackJsonp([13],{"0kA0":function(t,e,i){i("e6l3"),i("f7or"),t.exports=i("smXx")},"4zso":function(t,e,i){t.exports={default:i("0kA0"),__esModule:!0}},"8gdy":function(t,e){},"9M7r":function(t,e){},FSXf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("wHeh"),o=i("u6qr"),n=i.n(o),s=i("W14+"),r=i.n(s),l=i("C331"),c=function(t){var e={},i={};if(Object(l.d)({async:!1,url:"/api/currentUser/roles/41/authorities",success:function(t){e=t},error:t}),Object(l.d)({async:!1,url:"/api/currentUser/roles/24/authorities",success:function(t){i=t},error:t}),e.state&&i.state){t(null,e.data||i.data?{data:!0,state:!0}:{data:!1,state:!0})}},d=function(t,e,i){Object(l.d)({url:"/api/iSignIn/projects/projectTypes/list/"+R.changeTabToInterface(t)+"?keyWord="+(e||""),success:function(t){t.state&&(t.data=t.data.map(function(t){return{id:t.id,name:t.typeName}})),i(null,t)},error:i})},u=function(t,e){Object(l.d)({url:"/api/iSignIn/projects?projectId="+t,success:function(t){t.state&&(t.data=R.getProject(t.data)),e(null,t)},error:e})},h=function(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,n=arguments[5];Object(l.d)({url:"/api/iSignIn/projects/"+t+"/"+e+"?page="+a+"&size="+o+"&keyWord="+(i||""),success:function(t){t.state&&(t.list=(t.data.content||[]).map(R.getProject),t.count=t.data.totalElements,t.totalPages=t.data.totalPages),n(null,t)},error:n})},g=function(t,e){Object(l.d)({url:"/api/iSignIn/projects/projectPeoplesCount/"+t,success:function(t){e(null,t)},error:e})},p=function(t,e){Object(l.d)({url:"/api/signIns/list/"+t,success:function(t){t.state&&(t.data=t.data.map(R.getSign)),e(null,t)},error:e})},m=function(t,e){Object(l.d)({url:"/api/signIns/"+t,success:function(t){t.state&&(t.data=R.getSign(t.data)),e(null,t)},error:e})},f=function(t,e){Object(l.d)({url:"/api/signIns/my/"+t,success:function(t){t.state&&(t.data=t.data.map(R.getSign)),e(null,t)},error:e})},v=function(t,e){Object(l.d)({url:"/api/iSignIn/projects/projectTypes",type:"post",data:{typeName:t},success:function(t){t.state&&(t.data={id:t.data.id,name:t.data.typeName}),e(null,t)},error:e})},y=function(t,e){Object(l.d)({url:"/api/iSignIn/projects",type:"post",data:t,success:function(t){t.state&&(t.data=R.getProject(t.data)),e(null,t)},error:e})},_=function(t,e){Object(l.d)({url:"/api/iSignIn/projects",type:"put",data:{projectId:t.id,projectName:t.name,projectTypeId:t.categoryId},success:function(t){return e(null,t)},error:e})},C=function(t,e){Object(l.d)({url:"/api/iSignIn/projects/projectTypes/"+t.id,type:"put",data:{typeName:t.name},success:function(t){return e(null,t)},error:e})},b=function(t,e,i){Object(l.d)({url:"/api/iSignIn/projects/projectAgents/"+t,type:"post",data:e,success:function(t){return i(null,t)},error:i})},w=function(t,e){var i={signInId:t.signId,projectId:t.projectId,signInName:t.name,timeStart:t.startTime,timeEnd:t.endTime,useDynamicCode:t.useDynamicCode,signInType:t.signWay===t.signWays.qrcode?"SCAN":"LOCATION",isLocation:t.scanQrcodeWithLocation,signInRange:(t.signWay===t.signWays.qrcode?t.qrcodeLocations:t.locations).map(function(t){return{address:t.address,distance:t.radius,longitude:t.lng,latitude:t.lat}})};Object(l.d)({url:"/api/signIns",type:"put",data:i,success:function(t){return e(null,t)},error:e})},I=function(t){Object(l.d)({url:"/api/iSignIn/projects/peopleLimit/conditions",success:function(e){return t(null,e)},error:t})},M=function(t,e,i,a){i=i||{},Object(l.d)({url:"/api/iSignIn/projects/peopleLimit/"+t+"/"+e,type:"put",data:{educationLevel:i.educationLevel,studentStatus:i.inSchoolStatus,grade:i.grade},success:function(t){return a(null,t)},error:a})},S=function(t,e){var i={projectId:t.projectId,signInName:t.name,timeStart:t.startTime,timeEnd:t.endTime,useDynamicCode:t.useDynamicCode,signInType:t.signWay===t.signWays.qrcode?"SCAN":"LOCATION",isLocation:t.scanQrcodeWithLocation,signInRange:(t.signWay===t.signWays.qrcode?t.qrcodeLocations:t.locations).map(function(t){return{address:t.address,distance:t.radius,longitude:t.lng,latitude:t.lat}})};Object(l.d)({url:"/api/signIns",type:"post",data:i,success:function(t){t.state&&(t.data=R.getSign(t.data)),e(null,t)},error:e})},x=function(t,e,i,a){Object(l.d)({url:"/api/signIns/peoples",type:"post",data:{signInId:e,projectId:t,userId:i},success:function(t){return a(null,t)},error:a})},P=function(t,e){Object(l.d)({url:"/api/users/"+t,type:"get",success:function(t){return e(null,t)},error:e})},L=function(t,e){Object(l.d)({url:"/api/signIns/"+t,type:"delete",success:function(t){return e(null,t)},error:e})},N=function(t,e,i,a){Object(l.d)({url:"/api/signIns/signInStatus",type:"put",data:{signInId:t,userId:e,remark:i},success:function(t){return a(null,t)},error:a})},T=function(t,e,i){Object(l.d)({url:"/api/signIns/peoples/"+t+"/"+e,type:"delete",success:function(t){return i(null,t)},error:i})},k=function(t,e){Object(l.d)({url:"/api/signIns/"+t+"/agents",type:"get",success:function(t){e(null,t)},error:e})},j=function(t){Object(l.d)({url:"/api/student/manage/getSelectOptions?type=school",type:"get",success:function(e){t(null,e)},error:t})},E=function(t,e){Object(l.d)({url:"/api/iSignIn/projects/list/agents/"+t,type:"get",success:function(t){e(null,t)},error:e})},A=function(t,e,i,a,o,n){Object(l.d)({url:"/api/signIns/"+t+"/signInUrl",type:"post",data:{distribution:e,collegeCode:i,classId:a,expireTime:o},success:function(t){n(null,t)},error:n})},O=function(t,e){Object(l.d)({url:"/api/signInStatistics/overviews/"+t,type:"get",success:function(t){return e(null,t)},error:e})},D=function(t,e,i){Object(l.d)({url:"/api/signInStatistics/statistics/"+t+"/"+e,type:"get",success:function(t){return i(null,t)},error:i})},B=function(t,e,i,a,o,n){window.location.href="/downloads/signIns/peoples/excel/MANAGE?signInId="+t+"&name="+(e||"")+"&userNo="+(i||"")+"&college="+(a||"")+"&signInStatus="+(o||"")+"&classId="+(n||"")},$=function(t,e,i,a,o,n,s,r){window.location.href="/downloads/signIns/"+t+"/people/excel?signInId="+t+"&agentId="+e+"&name="+(i||"")+"&userNo="+(a||"")+"&collegeCode="+(o||"")+"&classId="+(n||"")+"&status="+(s||"")+"&filename="+r},R={getProject:function(t){return{id:t.projectId,name:t.projectName,categoryId:t.projectTypeId,categoryName:t.projectTypeName,limitListOfPeople:t.limitListOfPeople,peopleCount:t.projectPeopleCount,educationLevel:t.educationLevel,educationLevelLabel:t.educationLevelName,grade:t.grade,level:t.level,inSchoolStatus:t.studentStatus,peopleLoading:!0,signs:{init:!1,loading:!1,list:[]}}},getSign:function(t){var e={id:t.signInId,name:t.signInName,projectId:t.projectId,startTime:t.timeStart,endTime:t.timeEnd,useDynamicCode:t.useDynamicCode,signInStatus:t.signInStatus,signWay:"SCAN"===t.signInType?"qrcode":"location",scanQrcodeWithLocation:t.isLocation,qrcodeLocations:[],locations:[]},i=t.signInRange.map(function(t){return{address:t.address,radius:t.distance,lng:t.longitude,lat:t.latitude,init:!0,showMap:!1}});return"SCAN"===t.signInType?e.qrcodeLocations=i:e.locations=i,e},changeTabToInterface:function(t){return{ALL:"ALL",MANAGE:"MANAGE",PROXY:"AGENT",MINE:"MY"}[t]}},H='<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n                  <path fill="rgba(0, 0, 0, 0.54)" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z" transform="rotate(30.0001 25 25)">\n                    <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform>\n                  </path>\n                </svg>',W={icon:H,small:'<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="18px" height="18px" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">\n                <path fill="rgba(0, 0, 0, 0.54)" d="M43.935,25.145c0-10.318-8.364-18.683-18.683-18.683c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615c8.072,0,14.615,6.543,14.615,14.615H43.935z" transform="rotate(30.0001 25 25)">\n                  <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform>\n                </path>\n              </svg>',iconWithText:H+"加载中"},q=(Number,String,String,{props:{projectId:Number,projectName:String,projectLevel:String},data:function(){return{loader:W,departmentId:1,positionLeft:null,players:[],distributaryData:[{id:"bySchool",name:"全校统一管理"},{id:"byClass",name:"以班级分配"},{id:"byTeacher",name:"以带生关系分配"},{id:"byCollege",name:"以学院关系分配"}],scrollAreaHeight:"",noRoleSetAfaterHeight:"",newAuthorityMaxHeight:"",roleSetContentHeight:"",hasError:!0,loading:!0,roleList:[],batchCheck:"",roleEditing:!1,curNode:{distributary:"",operators:[],dataAuthorities:[{authority:null}]},curLink:{},otherLink:{nextNodeId:""},curForm:{formSettingId:"",formSettingName:""},isApplyNode:!1,isChange:!1,isSelectBatchSet:!1,nameIsNull:!0,ownerContentHeight:0,lang:"zh-cn"}},computed:{translate:function(){return Object(l.f)(this.lang).joinRoleSetManage},setColStyle:function(){return this.players.length<=1?{"text-align":"center","padding-left":"105px"}:{"text-align":"left","padding-left":"0"}}},watch:{},created:function(){var t=this;if(!this.projectId)return this.$toast("sorry, something went wrong! [110]");"SCHOOL"==this.projectLevel?this.distributaryData=[{id:"bySchool",name:"全校统一管理"},{id:"byClass",name:"以班级分配"},{id:"byTeacher",name:"以带生关系分配"},{id:"byCollege",name:"以学院关系分配"}]:"COLLEGE"==this.projectLevel&&(this.distributaryData=[{id:"byClass",name:"以班级分配"},{id:"byTeacher",name:"以带生关系分配"}]);var e=localStorage.getItem("lang");Object(l.f)(e)&&(this.lang=e),this.distributaryData.forEach(function(e,i){e.name=t.translate.distributaryData[e.id]}),E(this.projectId,function(e,i){if(e)return t.$toast("网络错误");if(!i.state)return t.$toast(i.message);var a={SCHOOL:"bySchool",COLLEGE:"byCollege",RELATIONSHIP:"byTeacher",CLASS:"byClass"};t.players=i.data.map(function(e){var i=t.getNewPlayerTemplate();return i.id=e.projectAgentId,i.name=e.agentName,i.distributary=a[e.powerModeOfDistribution],i.roles=e.agentRoleId,i.roleCount=i.roles.length,i});var o=!0,s=!1,r=void 0;try{for(var l,c=n()(t.players);!(o=(l=c.next()).done);o=!0){var d=l.value;t._initRoleList(d)}}catch(e){s=!0,r=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw r}}t.players.length||t._addPlayer(),t.loading=!1})},mounted:function(){},methods:{getNewPlayerTemplate:function(){return{id:null,name:null,distributary:"bySchool",selectDistributary:"bySchool",roles:[],roleEditing:!1,newRoleName:null,roleAddErrorMsg:null,nameErrorMsg:null,roleCount:0,roleSetData:[],_id:"player_"+(new Date).getTime()}},_addPlayer:function(){if(4==this.players.length)return this.$toast("设置的代理已经包括所有的代理权分配方式，不可再新增");var t=this.getNewPlayerTemplate(),e={bySchool:!1,byCollege:!1,byTeacher:!1,byClass:!1},i=!0,a=!1,o=void 0;try{for(var s,r=n()(this.players);!(i=(s=r.next()).done);i=!0){e[s.value.distributary]=!0}}catch(t){a=!0,o=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw o}}var l=null;for(var c in e)if(!e[c]){l=c;break}t.distributary=l,t.selectDistributary=l,this.players.push(t),this._initRoleList(t,this.players.length-1)},_changePlayerName:function(t){var e=!1,i=!0,a=!1,o=void 0;try{for(var s,r=n()(this.players);!(i=(s=r.next()).done);i=!0){var l=s.value;l._id!==t._id&&(l.name===t.name&&(t.nameErrorMsg="该代理名称已存在",e=!0))}}catch(t){a=!0,o=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw o}}e||(t.nameErrorMsg=null)},_afterSelectedDistributary:function(t){var e=parseInt(t.target.$attrs["data-index"]),i=this.players[e];if(i.distributary!=t.val){var a=!1,o=null,s=!0,r=!1,l=void 0;try{for(var c,d=n()(this.players);!(s=(c=d.next()).done);s=!0){var u=c.value;u.distributary==t.val&&(a=!0,o=u)}}catch(t){r=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(r)throw l}}if(a)return this.$toast("该代理分配方式已被代理("+(o.name||"该代理未设置名称")+")占用"),void(i.selectDistributary=i.distributary);i.roleEditing=!1,t.val?(i.distributary=t.val,i.roles=[],i.roleCount=0,this._initRoleList(i,e)):i.distributary=""}},_initRoleList:function(t,e){var i=this;"bySchool"===t.distributary||"byCollege"===t.distributary?Object(l.d)({url:"/api/approveRoles",type:"get",data:{level:"bySchool"===t.distributary?"SCHOOL":"COLLEGE",departmentId:this.departmentId},success:function(e){if(e.state){t.roleSetData=e.data.reverse();var a=null;a&&clearTimeout(a),a=setTimeout(function(){var t=r()(".col").height().toFixed(1);i.roleSetContentHeight=t-268,i.scrollAreaHeight=t-218,i.noRoleSetAfaterHeight=t-170,i.newAuthorityMaxHeight=t-83},300)}else i.$toast(e.message)}}):"byClass"===t.distributary&&Object(l.d)({url:"/api/relClass/classCommittees",type:"get",success:function(e){if(e.state){e.data.forEach(function(t){t.name=t.text}),t.roleSetData=e.data.reverse();var a=null;a&&clearTimeout(a),a=setTimeout(function(){var t=r()(".col").height().toFixed(1);i.roleSetContentHeight=t-268,i.scrollAreaHeight=t-218,i.noRoleSetAfaterHeight=t-170,i.newAuthorityMaxHeight=t-83},300)}else alert(e.message)}})},_addOrDeleteRoleToPlayer:function(t,e){var i=e.roles.indexOf(parseInt(t.id));i>=0?e.roles.splice(i,1):e.roles.push(parseInt(t.id)),this.countSelectedRoles(e)},_batchChangeSelectedRoles:function(t){if(t.roleCount==t.roleSetData.length)return t.roleCount=0,void(t.roles=[]);t.roles=t.roleSetData.map(function(t){return parseInt(t.id)}),t.roleCount=t.roleSetData.length},countSelectedRoles:function(t){return t.roleCount=0,t.roleSetData.forEach(function(e){t.roles.indexOf(parseInt(e.id))>=0&&t.roleCount++}),t.roleCount},_creatNewRole:function(t,e){t.roleEditing=!0,t.newRoleName=this.projectName+("bySchool"===t.distributary?"校级":"院级")+"管理员",r()("#roleContent"+e).animate({scrollTop:"0px"},300)},_saveNewRole:function(t){var e=this,i=t.newRoleName;t.roleAddErrorMsg="",i&&""!==i.replace(/\s/g,"")?t.roleSetData.forEach(function(e){i===e.name&&(t.roleAddErrorMsg&&(t.roleAddErrorMsg+=","),t.roleAddErrorMsg+="该角色已存在")}):t.roleAddErrorMsg="角色名不能为空",t.roleAddErrorMsg?setTimeout(function(){t.roleAddErrorMsg=""},1500):Object(l.d)({url:"/api/approveRoles",type:"post",data:{name:i,level:"bySchool"===t.distributary?"SCHOOL":"COLLEGE",departmentId:this.departmentId},success:function(a){a.state?(t.roleSetData.unshift({id:a.data,name:i}),t.roles.push(parseInt(a.data)),t.roleEditing=!1):e.$toast(a.message)}})},_back:function(){if(!this.nameIsNull)return!1;this.$emit("back")},_saveJoinSet:function(){var t=this,e=[],i=!0,a="",o={bySchool:"SCHOOL",byCollege:"COLLEGE",byTeacher:"RELATIONSHIP",byClass:"CLASS"},s=!0,r=!1,l=void 0;try{for(var c,d=n()(this.players);!(s=(c=d.next()).done);s=!0){var u=c.value;u.name||(a+="您还有代理名称还未填写; ",i=!1),"bySchool"!=u.distributary&&"byCollege"!=u.distributary||u.roles.length||(a+=(u.name||"[未设置名称]")+"未选择角色; "),e.push({projectAgentId:u.id,projectId:this.projectId,powerModeOfDistribution:o[u.distributary],agentName:u.name,agentRoleId:u.roles})}}catch(t){r=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(r)throw l}}if(!i)return this.$toast(a);b(this.projectId,e,function(e,i){return e?t.$toast("网络错误"):i.state?(t.$toast("设置代理成功"),void t.$emit("back")):t.$toast(i.message)})},_deletePlayers:function(t){this.players.splice(t,1)},_newRowInputFocus:function(t){this.players[t].newRoleName=this.appName+this.players[t].palyerForm.name+"管理员"}},destroyed:function(){}}),G={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-fluid",attrs:{id:"proxy-settings"}},[i("div",{staticClass:"head text-center"},[i("div",{staticClass:"pull-left back-div"},[i("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("arrow_back"))},on:{click:t._back}},[t._v("arrow_back")])]),t._v(" "),i("div",{staticClass:"pull-right opt-div"},[i("a",{staticClass:"opt-btn",attrs:{href:"javascript:;"},on:{click:t._back}},[t._v("取消")]),t._v(" "),i("button",{staticClass:"btn save",on:{click:t._saveJoinSet}},[t._v("保存")])])]),t._v(" "),t.loading?i("div",{staticClass:"loading-players loader",domProps:{innerHTML:t._s(t.loader.icon+"正在加载代理设置...")}}):i("div",{staticClass:"joinSet-content"},[i("div",{staticClass:"info-container",style:t.setColStyle},[t._l(t.players,function(e,a){return i("div",{key:a,staticClass:"col other-col"},[i("div",{staticClass:"form-group"},[i("i",{staticClass:"maticon pull-left app-icon black-color",domProps:{innerHTML:t._s(t.icons("label"))}},[t._v("label")]),t._v(" "),i("div",{staticClass:"form-group-input pull-left "},[i("label",{staticClass:"name-label light-black-color"},[t._v("名称")]),t._v(" "),i("i",{staticClass:"maticon pull-right more-icon black-color dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))}},[t._v("more_vert")]),t._v(" "),i("ul",{staticClass:"dropdown-menu more-opt-menu"},[i("li",{on:{click:function(e){return t._deletePlayers(a)}}},[i("a",{attrs:{href:"#"}},[t._v("删除")])])]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"player.name"}],staticClass:"form-control name-input border-bottom-blue black-color",attrs:{type:"text",placeholder:"请输入代理者名称",maxlength:"15"},domProps:{value:e.name},on:{change:function(i){return t._changePlayerName(e)},input:function(i){i.target.composing||t.$set(e,"name",i.target.value)}}}),t._v(" "),e.nameErrorMsg?i("p",{staticClass:"name-error-tip text-center"},[t._v(t._s(e.nameErrorMsg))]):t._e()])]),t._v(" "),i("div",{staticClass:"form-group"},[i("i",{staticClass:"maticon pull-left app-icon black-color",domProps:{innerHTML:t._s(t.icons("call_split"))}},[t._v("call_split")]),t._v(" "),i("div",{staticClass:"form-group-input pull-left "},[i("label",{staticClass:"name-label light-black-color"},[t._v("代理权分配方式")]),t._v(" "),i("div",{staticClass:"distribution-select"},[i("v-select",{key:a,ref:"distributarySelect",refInFor:!0,attrs:{options:t.distributaryData,"options-value":"id","options-label":"name","data-index":a,required:!0},on:{afterSelected:t._afterSelectedDistributary},model:{value:e.selectDistributary,callback:function(i){t.$set(e,"selectDistributary",i)},expression:"player.selectDistributary"}})],1)])]),t._v(" "),"byTeacher"!==e.distributary&&""!=e.distributary?i("div",{staticClass:"form-group clear-padding-bottom clear-bord-bottom"},[i("div",{staticClass:"role-set-head"},[i("i",{staticClass:"maticon pull-left app-icon black-color",domProps:{innerHTML:t._s(t.icons("people"))}},[t._v("people")]),t._v(" "),i("div",{staticClass:"form-group-input pull-left ",staticStyle:{height:"35px"}},[i("label",{staticClass:"name-label light-black-color"},[t._v("角色设置")]),t._v(" "),"byClass"===e.distributary||e.roleEditing?t._e():i("span",{staticClass:"creat-new-role blue-color",on:{click:function(i){return t._creatNewRole(e,a)}}},[t._v("创建新的角色")])])])]):t._e(),t._v(" "),i("div",{staticClass:"scroll-area",style:{height:"byTeacher"!==e.distributary&&""!=e.distributary?t.scrollAreaHeight+"px":t.noRoleSetAfaterHeight+"px"},attrs:{id:"scrollArea"+a,"data-id":a}},["byTeacher"!==e.distributary&&""!=e.distributary?i("div",{staticClass:"form-group clear-padding-bottom"},[i("div",{staticClass:"role-set-content",style:"max-height:"+t.roleSetContentHeight+"px",attrs:{id:"roleContent"+a}},[e.roleEditing?i("div",{staticClass:"creat-role-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.newRoleName,expression:"player.newRoleName"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control name-input border-bottom-blue black-color padding-right-70px",attrs:{type:"text",maxlength:"20",placeholder:"请输入角色名称"},domProps:{value:e.newRoleName},on:{input:function(i){i.target.composing||t.$set(e,"newRoleName",i.target.value)}}}),t._v(" "),i("div",{staticClass:"pull-right creat-btn-group"},[i("button",{staticClass:"btn creat-cancle clearBtnBorder",on:{click:function(t){e.roleEditing=!1}}},[t._v("取消")]),t._v(" "),i("button",{staticClass:"btn creat-sure blue-color clearBtnBorder",on:{click:function(i){return t._saveNewRole(e)}}},[t._v("确定")])]),t._v(" "),e.roleEditing?i("p",{staticClass:"errorMsg",class:{show:e.roleAddErrorMsg}},[t._v(t._s(e.roleAddErrorMsg))]):t._e()]):t._e(),t._v(" "),i("div",{staticClass:"role-list",attrs:{id:"roleList"+a}},[i("div",{staticClass:"role-list-item margin-bottom-5px"},[i("div",{staticClass:"margin-left-70px"},[i("div",{staticClass:"input-group"},[i("span",{on:{click:function(i){return t._batchChangeSelectedRoles(e)}}},[0===e.roleCount?i("i",{staticClass:"maticon role-icon light-black-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")]):e.roleCount===e.roleSetData.length?i("i",{staticClass:"maticon role-icon light-black-color",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):i("i",{staticClass:"maticon role-icon light-black-color",domProps:{innerHTML:t._s(t.icons("indeterminate_check_box"))}},[t._v("indeterminate_check_box")])]),t._v(" "),i("span",{staticClass:"role-name light-black-color"},[t._v("全选")])])])]),t._v(" "),t._l(e.roleSetData,function(a,o){return i("div",{key:o,staticClass:"role-list-item"},[i("div",{staticClass:"margin-left-70px"},[i("div",{staticClass:"input-group"},[i("span",{on:{click:function(i){return t._addOrDeleteRoleToPlayer(a,e)}}},[e.roles.indexOf(parseInt(a.id))>=0?i("i",{staticClass:"maticon role-icon light-black-color",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):i("i",{staticClass:"maticon role-icon light-black-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),i("span",{staticClass:"role-name",class:e.roles.indexOf(parseInt(a.id))>=0?"black-color":"light-black-color",attrs:{title:a.name}},[t._v(t._s(a.name))])])])])})],2)])]):t._e()])])}),t._v(" "),i("div",{staticClass:"add-role"},[i("button",{staticClass:"add-btn clearBtnBorder",on:{click:t._addPlayer}},[t._v("添加代理者")])])],2)])])},staticRenderFns:[]};var F=i("Mz/3")(q,G,!1,function(t){i("h/I9")},null,null).exports,U=i("fjjs"),Q=i.n(U),z=i("Edqs"),X=i.n(z),Y=(String,{props:{name:String}}),V={render:function(){var t=this.$createElement;return(this._self._c||t)("i",{staticClass:"maticon"},[this._v(this._s(this.name))])},staticRenderFns:[]},J=i("Mz/3")(Y,V,!1,null,null,null).exports,K=(Boolean,Array,String,Number,{name:"ElCollapse",componentName:"ElCollapse",props:{accordion:Boolean,value:{type:[Array,String,Number],default:function(){return[]}}},data:function(){return{activeNames:[].concat(this.value)}},provide:function(){return{collapse:this}},watch:{value:function(t){this.activeNames=[].concat(t)}},methods:{setActiveNames:function(t){t=[].concat(t);var e=this.accordion?t[0]:t;this.activeNames=t,this.$emit("input",e),this.$emit("change",e)},handleItemClick:function(t){if(this.accordion)this.setActiveNames(!this.activeNames[0]&&0!==this.activeNames[0]||this.activeNames[0]!==t.name?t.name:"");else{var e=this.activeNames.slice(0),i=e.indexOf(t.name);i>-1?e.splice(i,1):e.push(t.name),this.setActiveNames(e)}}},created:function(){this.$on("item-click",this.handleItemClick)}}),Z={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"el-collapse",attrs:{role:"tablist","aria-multiselectable":"true"}},[this._t("default")],2)},staticRenderFns:[]},tt=i("Mz/3")(K,Z,!1,null,null,null).exports;var et={methods:{dispatch:function(t,e,i){for(var a=this.$parent||this.$root,o=a.$options.componentName;a&&(!o||o!==t);)(a=a.$parent)&&(o=a.$options.componentName);a&&a.$emit.apply(a,[e].concat(i))},broadcast:function(t,e,i){(function t(e,i,a){this.$children.forEach(function(o){o.$options.componentName===e?o.$emit.apply(o,[i].concat(a)):t.apply(o,[e,i].concat([a]))})}).call(this,t,e,i)}}},it=(i("GxZn"),a.default.prototype.$isServer),at=(it||Number(document.documentMode),function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")});!it&&document.addEventListener,!it&&document.removeEventListener;function ot(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function nt(t,e){if(t){for(var i=t.className,a=(e||"").split(" "),o=0,n=a.length;o<n;o++){var s=a[o];s&&(t.classList?t.classList.add(s):ot(t,s)||(i+=" "+s))}t.classList||(t.className=i)}}function st(t,e){if(t&&e){for(var i=e.split(" "),a=" "+t.className+" ",o=0,n=i.length;o<n;o++){var s=i[o];s&&(t.classList?t.classList.remove(s):ot(t,s)&&(a=a.replace(" "+s+" "," ")))}t.classList||(t.className=at(a))}}String,String,Number,Number;var rt={name:"ElCollapseItem",componentName:"ElCollapseItem",mixins:[et],data:function(){return{contentWrapStyle:{height:"auto",display:"block"},contentHeight:0,focusing:!1,isClick:!1}},inject:["collapse"],props:{title:String,name:{type:[String,Number],default:function(){return this._uid}},itemWrapCorrectionHeight:{type:Number,default:function(){return 0}}},computed:{isActive:function(){return this.collapse.activeNames.indexOf(this.name)>-1},id:function(){return+new Date}},methods:{handleFocus:function(){var t=this;setTimeout(function(){t.isClick?t.isClick=!1:t.focusing=!0},50)},handleHeaderClick:function(){this.dispatch("ElCollapse","item-click",this),this.focusing=!1,this.isClick=!0},handleEnterClick:function(){this.dispatch("ElCollapse","item-click",this)},beforeEnter:function(t){nt(t,"collapse-transition"),t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.style.height=0+this.itemWrapCorrectionHeight+"px",t.style.paddingTop=0,t.style.paddingBottom=0},enter:function(t){t.dataset.oldOverflow=t.style.overflow,0!==t.scrollHeight?(t.style.height=t.scrollHeight+"px",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom):(t.style.height="",t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom),t.style.overflow="hidden"},afterEnter:function(t){st(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow},beforeLeave:function(t){t.dataset||(t.dataset={}),t.dataset.oldPaddingTop=t.style.paddingTop,t.dataset.oldPaddingBottom=t.style.paddingBottom,t.dataset.oldOverflow=t.style.overflow,t.style.height=t.scrollHeight+"px",t.style.overflow="hidden"},leave:function(t){0!==t.scrollHeight&&(nt(t,"collapse-transition"),t.style.height=0+this.itemWrapCorrectionHeight+"px",t.style.paddingTop=0,t.style.paddingBottom=0)},afterLeave:function(t){st(t,"collapse-transition"),t.style.height="",t.style.overflow=t.dataset.oldOverflow,t.style.paddingTop=t.dataset.oldPaddingTop,t.style.paddingBottom=t.dataset.oldPaddingBottom}}},lt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"el-collapse-item",class:{"is-active":t.isActive}},[i("div",{attrs:{role:"tab","aria-expanded":t.isActive,"aria-controls":"el-collapse-content-"+t.id,"aria-describedby":"el-collapse-content-"+t.id}},[i("div",{staticClass:"el-collapse-item__header",class:{focusing:t.focusing,"is-active":t.isActive},attrs:{role:"button",id:"el-collapse-head-"+t.id,tabindex:"0"},on:{click:t.handleHeaderClick,focus:t.handleFocus,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),t.handleEnterClick(e))},blur:function(e){t.focusing=!1}}},[i("i",{staticClass:"el-collapse-item__arrow maticon",class:{"is-active":t.isActive}},[t._v("expand_more")]),t._v(" "),t._t("title",[t._v(t._s(t.title))])],2)]),t._v(" "),i("transition",{on:{beforeEnter:t.beforeEnter,enter:t.enter,"after-enter":t.afterEnter,"before-leave":t.beforeLeave,leave:t.leave,"after-leave":t.afterLeave}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],staticClass:"el-collapse-item__wrap",attrs:{role:"tabpanel","aria-hidden":!t.isActive,"aria-labelledby":"el-collapse-head-"+t.id,id:"el-collapse-content-"+t.id}},[i("div",{staticClass:"el-collapse-item__content"},[t._t("content")],2)])])],1)},staticRenderFns:[]};var ct=i("Mz/3")(rt,lt,!1,function(t){i("9M7r")},null,null).exports,dt=(Array,Object,String,Number,Number,Array,Array,Object,Boolean,Object,Boolean,{components:{"el-collapse":tt,"el-collapse-item":ct,VIcon:J},props:{proxyArr:{type:Array,default:function(){return[]}},tabs:Object,curTab:String,activeCategoryId:Number,activeProjectId:Number,categories:{type:Array,default:function(){return[]}},schoolStatusArr:{type:Array,default:function(){return[]}},projects:Object,loading:{type:Boolean,default:!1},limitOptions:Object,hasAuthority:Boolean},data:function(){return{lang:"zh-cn",loader:W,peopleConditionsModal:{show:!1,title:"选择条件",grade:"",educationLevel:"",educationLevelLabel:"",inSchoolStatus:"",inSchoolStatusLabel:"",grades:[{id:0,text:"不限制"}],gradesMax:10,inSchoolStatusOptions:[{id:0,text:"不限制"},{id:"IN_SCHOOL",text:"在校"},{id:"NOT_IN_SCHOOL",text:"不在校"}]},selectLimitOptions:{educationLevel:0,grade:0,inSchoolStatus:0}}},created:function(){var t=window.localStorage.getItem("lang");t&&Object(l.f)(t)&&(this.lang=t);for(var e=(new Date).getFullYear()+1,i=0;i<this.peopleConditionsModal.gradesMax;++i){var a=e--+"";this.peopleConditionsModal.grades.push({id:a,text:a})}},computed:{i18n:function(){return Object(l.f)(this.lang).iSign},isManager:function(){return this.curTab===this.tabs.MANAGE},isMine:function(){return this.curTab===this.tabs.MINE},isProxy:function(){return this.curTab===this.tabs.PROXY}},methods:{getProjectCollapseItemId:function(t,e){return t.id+"-"+e.id},toEditCategoryName:function(t){this.$emit("to-edit-category-name",t)},toEditProjectName:function(t){this.$emit("to-edit-project-name",t)},toAddSign:function(t){if(!t.limitListOfPeople)return this.$toast("请先设置人员限制");this.$emit("to-add-sign",t)},toProxySettings:function(t){console.log(t),this.$emit("to-proxy-settings",t)},toSignInfo:function(t,e){this.isMine||this.$emit("to-sign-info",{project:t,sign:e})},selectCategory:function(t){t&&this.$emit("select-category",t)},selectProject:function(t){t&&this.$emit("select-project",t)},setLimitType:function(t,e){this.$emit("set-limit-type",{project:t,type:e})},toSelectCondition:function(t){this.selectLimitOptions.educationLevel=0,this.selectLimitOptions.grade=0,this.selectLimitOptions.inSchoolStatus=0,this.peopleConditionsModal.educationLevel="",this.peopleConditionsModal.grade="",this.peopleConditionsModal.inSchoolStatus="",this.peopleConditionsModal.show=!0,this.peopleConditionsModal.project=t},setConditionLimit:function(){this.$emit("set-limit-type",{project:this.peopleConditionsModal.project,type:"BY_CONDITIONS",conditions:{educationLevel:this.peopleConditionsModal.educationLevel,grade:this.peopleConditionsModal.grade,inSchoolStatus:this.peopleConditionsModal.inSchoolStatus,educationLevelLabel:this.peopleConditionsModal.educationLevelLabel,inSchoolStatusLabel:this.peopleConditionsModal.inSchoolStatusLabel}}),this.peopleConditionsModal.show=!1},selectEducationLevel:function(t){this.peopleConditionsModal.educationLevel=t.val||"",this.$nextTick(function(){this.peopleConditionsModal.educationLevelLabel=t.target&&t.target.selected||"obj.target.selected is null"})},selectGrade:function(t){this.peopleConditionsModal.grade=t.val||""},selectInSchoolStatus:function(t){this.peopleConditionsModal.inSchoolStatus=t.val||"",this.$nextTick(function(){this.peopleConditionsModal.inSchoolStatusLabel=t.target&&t.target.selected||"obj.target.selected is null"})},deleteSign:function(t,e){window.confirm("确定要删除"+e.name+"吗?")&&this.$emit("delete-sign",{project:t,sign:e})},toImport:function(t){this.$emit("to-import",t)},toImportBai:function(t){this.$emit("to-importBai",t)},getLimitPeopleDesc:function(t){if(!t.limitListOfPeople)return this.i18n.peopleRestrition;switch(t.limitListOfPeople){case"NOT_LIMIT":return"无限制";case"BY_CONDITIONS":var e=[];t.educationLevel&&e.push(t.educationLevelLabel),t.grade&&e.push(t.grade+"级"),t.inSchoolStatus&&e.push("IN_SCHOOL"==t.inSchoolStatus?"在校":"不在校"),e.length||e.push("无条件限制");return(e.length>=2?e.join(","):e[0])+"("+t.peopleCount+"人)";case"ALL_SCHOOL":return"全校在校生("+t.peopleCount+"人)";default:return"自定义名单("+t.peopleCount+"人)"}},showMore:function(t){this.$emit("show-more-projects",t)}}}),ut={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t.loading?i("div",{staticClass:"empty-categories loader",domProps:{innerHTML:t._s(t.loader.iconWithText)}}):t.hasAuthority?t.categories.length?i("el-collapse",{attrs:{value:t.activeCategoryId,accordion:""},on:{change:t.selectCategory}},t._l(t.categories,function(e,a){return i("el-collapse-item",{key:a,staticClass:"i-sign-category-item",attrs:{name:e.id,itemWrapCorrectionHeight:48}},[i("template",{slot:"title"},[t.isManager?i("div",{staticClass:"category-item-title",on:{click:function(i){return i.stopPropagation(),t.toEditCategoryName(e)}}},[t._v(t._s(e.name)+"\n          "),i("span",{staticClass:"edit-mask"},[t._v(".")]),t._v(" "),i("v-icon",{attrs:{name:"edit",title:t.i18n.editName}})],1):i("div",{staticClass:"category-item-title"},[t._v(t._s(e.name))])]),t._v(" "),i("template",{slot:"content"},[t.projects[e.id]?t.projects[e.id].loading?i("div",{staticClass:"empty-projects loader",domProps:{innerHTML:t._s(t.loader.iconWithText)}}):t.projects[e.id].list.length?i("el-collapse",{attrs:{value:t.activeProjectId,accordion:""},on:{change:t.selectProject}},[t._l(t.projects[e.id].list,function(a,o){return i("el-collapse-item",{key:o,staticClass:"i-sign-project-item",attrs:{name:t.getProjectCollapseItemId(e,a)}},[i("template",{slot:"title"},[i("div",{staticClass:"project-name-container"},[i("div",{staticClass:"project-name"},[t._v(t._s(a.name))]),t._v(" "),t.isManager?i("div",{staticClass:"project-edit",on:{click:function(e){return e.stopPropagation(),t.toEditProjectName(a)}}},[i("v-icon",{attrs:{name:"edit",title:t.i18n.editName}})],1):t._e()]),t._v(" "),t.isManager?i("div",{staticClass:"project-actions"},[i("div",{staticClass:"people-restration"},[i("button",{staticClass:"btn btn-primary clearBtnBorder",attrs:{type:"button"},on:{click:function(t){t.stopPropagation()}}},[i("v-icon",{staticClass:"pull-left",attrs:{name:"people"}}),t._v(" "),i("span",{domProps:{innerHTML:t._s(a.peopleLoading?t.loader.small:t.getLimitPeopleDesc(a))}})],1),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("ul",{staticClass:"list-popper"},[i("li",{on:{click:function(e){return e.stopPropagation(),t.setLimitType(a,"NOT_LIMIT")}}},[t._v("无限制")]),t._v(" "),i("li",{on:{click:function(e){return e.stopPropagation(),t.toSelectCondition(a)}}},[t._v("按条件筛选")]),t._v(" "),t.proxyArr[o]&&t.proxyArr[o].level&&"SCHOOL"==t.proxyArr[o].level?i("li",{on:{click:function(e){return e.stopPropagation(),t.setLimitType(a,"ALL_SCHOOL")}}},[t._v("全校在校生")]):t._e(),t._v(" "),i("li",{on:{click:function(e){return e.stopPropagation(),t.toImport(a)}}},[t._v("自定义名单导入")]),t._v(" "),t.proxyArr[o]&&t.proxyArr[o].level&&"SCHOOL"==t.proxyArr[o].level?i("li",{on:{click:function(e){return e.stopPropagation(),t.toImportBai(a)}}},[t._v("排除人员名单")]):t._e()])])],1),t._v(" "),i("button",{staticClass:"btn btn-primary clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.toProxySettings(a)}}},[i("v-icon",{staticClass:"pull-left",attrs:{name:"settings"}}),t._v(t._s(t.i18n.proxySettings))],1),t._v(" "),i("button",{staticClass:"btn btn-primary clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.toAddSign(a)}}},[i("v-icon",{staticClass:"pull-left",attrs:{name:"add"}}),t._v(t._s(t.i18n.addSign)+"\n                ")],1)]):t._e()]),t._v(" "),i("template",{slot:"content"},[i("div",{staticClass:"signs"},[a.signs?a.signs.loading?i("div",{staticClass:"empty-signs loader",domProps:{innerHTML:t._s(t.loader.iconWithText)}}):a.signs.list.length?t._l(a.signs.list,function(e,o){return i("div",{key:o,staticClass:"sign",class:{"sign-hover":!t.isMine,"sign-success":"SIGN"==e.signInStatus||"MANUAL_ENTRY"==e.signInStatus,"sign-failed":"TIME_OUT_NOT_SIGN"==e.signInStatus,"sign-without-icon":t.isProxy},on:{click:function(i){return t.toSignInfo(a,e)}}},[t._v("\n                "+t._s(e.name)+"\n                "),t.isManager?i("v-icon",{staticClass:"sign-status-icon delete-sign",attrs:{name:"delete"},nativeOn:{click:function(i){return i.stopPropagation(),t.deleteSign(a,e)}}}):t._e(),t._v(" "),!t.isMine||"SIGN"!=e.signInStatus&&"MANUAL_ENTRY"!=e.signInStatus?t.isMine&&"TIME_OUT_NOT_SIGN"==e.signInStatus?i("v-icon",{staticClass:"sign-status-icon",attrs:{name:"clear"}}):t._e():i("v-icon",{staticClass:"sign-status-icon",attrs:{name:"done"}})],1)}):i("div",{staticClass:"empty-signs"},[t._v("\n                "+t._s(t.isManager?"该项目下没有签到":"暂无签到")+"\n              ")]):i("div",[t._v("\n                nothing here\n              ")])],2)])],2)}),t._v(" "),t.projects[e.id].hasMore&&!t.projects[e.id].pageLoading?i("div",{staticClass:"show-more",on:{click:function(i){return t.showMore(e)}}},[t._v("查看更多")]):t._e(),t._v(" "),t.projects[e.id].pageLoading?i("div",{staticClass:"page-loading loader",domProps:{innerHTML:t._s(t.loader.iconWithText)}}):t._e(),t._v(" "),t.projects[e.id].showNoMoreTip?i("div",{staticClass:"page-loading"},[t._v("已经到底了~")]):t._e()],2):i("div",{staticClass:"empty-projects"},[t._v("\n          暂无签到项目\n        ")]):i("div",{staticClass:"empty-projects"},[t._v("\n          nothing here\n        ")])],1)],2)}),1):i("div",{staticClass:"empty-categories"},[t._v("\n    "+t._s("暂无项目分类")+"\n  ")]):i("div",{staticClass:"empty-categories loader"},[t._v("\n    您无管理签到项目的权限\n  ")]),t._v(" "),i("v-modal",{attrs:{show:t.peopleConditionsModal.show,effect:"fade",width:"600"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.peopleConditionsModal.title)+"\n      ")])]),t._v(" "),i("div",{staticClass:"modal-body container-fluid",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"conditions"},[i("ul",[i("li",[i("label",[t._v("培养层次")]),t._v(" "),i("v-select",{ref:"educationLevel",staticClass:"selectbox",attrs:{options:t.limitOptions.educationLevel,"options-value":"id","options-label":"text",multiple:!0,required:!0},on:{afterSelected:t.selectEducationLevel},model:{value:t.selectLimitOptions.educationLevel,callback:function(e){t.$set(t.selectLimitOptions,"educationLevel",e)},expression:"selectLimitOptions.educationLevel"}})],1),t._v(" "),i("li",[i("label",[t._v("年级")]),t._v(" "),i("v-select",{ref:"grade",staticClass:"selectbox",attrs:{multiple:!0,options:t.peopleConditionsModal.grades,"options-value":"id","options-label":"text",required:!0},on:{afterSelected:t.selectGrade},model:{value:t.selectLimitOptions.grade,callback:function(e){t.$set(t.selectLimitOptions,"grade",e)},expression:"selectLimitOptions.grade"}})],1),t._v(" "),i("li",[i("label",[t._v("在校状态")]),t._v(" "),i("v-select",{ref:"inSchoolStatus",staticClass:"selectbox",attrs:{options:t.schoolStatusArr,"options-value":"value","options-label":"label",required:!0},on:{afterSelected:t.selectInSchoolStatus},model:{value:t.selectLimitOptions.inSchoolStatus,callback:function(e){t.$set(t.selectLimitOptions,"inSchoolStatus",e)},expression:"selectLimitOptions.inSchoolStatus"}})],1)])])]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.peopleConditionsModal.show=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.setConditionLimit(t.peopleConditionsModal.project)}}},[t._v(t._s(t.i18n.sure))])])])],1)},staticRenderFns:[]};var ht=i("Mz/3")(dt,ut,!1,function(t){i("8gdy")},null,null).exports,gt=(Array,{components:{VIcon:J},props:{locations:{type:Array,default:function(){return[]}}},data:function(){return{}},created:function(){},computed:{},methods:{addLocation:function(){this.locations.push({address:"请选择地图中的地点作为中心点",radius:500,lat:0,lng:0,init:!1,showMap:!0})},deleteLocation:function(t){this.locations.splice(t,1)},initQrCodeLocation:function(t){var e=this.locations[t.target.$attrs["data-index"]];e.lat=t.lat,e.lng=t.lng},radiusChange:function(t){console.log(t)},selectQrCodeLocation:function(t){var e=this.locations[t.target.$attrs["data-index"]];e.address=t.address,e.lat=t.location.lat,e.lng=t.location.lng,e.init=!0}}}),pt={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"locations"},[t._l(t.locations,function(e,a){return i("div",{key:a,staticClass:"location"},[i("div",{staticClass:"title"},[i("v-icon",{attrs:{name:e.showMap?"expand_more":"chevron_right"},nativeOn:{click:function(t){e.showMap=!e.showMap}}}),t._v(" "),i("span",[t._v("地点"+t._s(a+1)+"："+t._s(e.address))]),t._v(" "),i("span",{staticClass:"radius"},[t._v("范围：")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.radius,expression:"location.radius"}],staticClass:"form-control",staticStyle:{padding:"0 5px !important"},attrs:{type:"text"},domProps:{value:e.radius},on:{change:t.radiusChange,input:function(i){i.target.composing||t.$set(e,"radius",i.target.value)}}}),t._v(" "),i("span",[t._v("米")]),t._v(" "),i("v-icon",{staticClass:"delete",attrs:{name:"delete",title:"删除此地点"},nativeOn:{click:function(e){return t.deleteLocation(a)}}})],1),t._v(" "),i("v-map",{directives:[{name:"show",rawName:"v-show",value:e.showMap,expression:"location.showMap"}],staticClass:"map",attrs:{center:{lat:e.lat,lng:e.lng},search:!0,location:!0,searchText:"请输入地名设置中心点",radius:e.radius,"data-index":a},on:{markerClick:t.selectQrCodeLocation,getLocation:t.initQrCodeLocation}})],1)}),t._v(" "),i("div",{staticClass:"action-add-location",on:{click:t.addLocation}},[i("v-icon",{attrs:{name:"add"}}),t._v("\n    添加地点\n  ")],1)],2)},staticRenderFns:[]};var mt=i("Mz/3")(gt,pt,!1,function(t){i("aBzm")},null,null).exports,ft=i("3SZ7"),vt=i.n(ft),yt=(Object,Object,String,Array,{components:{VIcon:J,Locations:mt},props:{i18n:Object,signInfo:Object,title:String,locations:{type:Array,default:function(){return[]}}},data:function(){return{signInfoBak:null}},created:function(){this.signInfoBak=JSON.parse(vt()(this.signInfo))},computed:{},methods:{setSignWay:function(t){this.signInfo.signWay=t},cancel:function(){X()(this.signInfo,this.signInfoBak),this.signInfo.show=!1},confirm:function(){if(!this.signInfo.startTime)return this.$toast(this.i18n.error.pleaseChooseStartTime);if(!this.signInfo.endTime)return this.$toast(this.i18n.error.pleaseChooseEndTime);if(!this.signInfo.name)return this.$toast(this.i18n.error.pleaseFillInSignName);if(this.signInfo.signWay===this.signInfo.signWays.qrcode&&this.signInfo.scanQrcodeWithLocation){if(!this.signInfo.qrcodeLocations.length)return this.$toast("请添加地点");var t=!0,e=!1,i=void 0;try{for(var a,o=n()(this.signInfo.qrcodeLocations);!(t=(a=o.next()).done);t=!0){if(!a.value.init)return this.$toast("请选择地图中的地点作为中心点")}}catch(t){e=!0,i=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw i}}}if(this.signInfo.signWay===this.signInfo.signWays.location){if(!this.signInfo.locations.length)return this.$toast("请添加地点");var s=!0,r=!1,l=void 0;try{for(var c,d=n()(this.signInfo.locations);!(s=(c=d.next()).done);s=!0){if(!c.value.init)return this.$toast("请选择地图中的地点作为中心点")}}catch(t){r=!0,l=t}finally{try{!s&&d.return&&d.return()}finally{if(r)throw l}}}this.$emit("confirm",this.signInfo)},signStartSelected:function(t){if(this.signInfo.endTime&&new Date(t.value.replace(/-/g,"/"))-new Date(this.signInfo.endTime.replace(/-/g,"/"))>=0)return this.signInfo.startTime?this.$refs.startTime.value=this.signInfo.startTime:this.$refs.startTime.clearValue(),void this.$toast(this.i18n.endTimeMustBeAfterStartTime);this.signInfo.startTime=t.value},signEndSelected:function(t){var e=t.value.replace(/-/g,"/");return this.signInfo.startTime&&new Date(e)-new Date(this.signInfo.startTime.replace(/-/g,"/"))<=0?(this.signInfo.endTime?this.$refs.endTime.value=this.signInfo.endTime:this.$refs.endTime.clearValue(),void this.$toast(this.i18n.endTimeMustBeAfterStartTime)):new Date-new Date(e)>0?(this.$toast(this.i18n.endTimeMustBeAfterNow),void(this.signInfo.endTime?this.$refs.endTime.value=this.signInfo.endTime:this.$refs.endTime.clearValue())):void(this.signInfo.endTime=t.value)}}}),_t={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-modal",{attrs:{show:t.signInfo.show,effect:"fade",width:"500"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n      "+t._s(t.title)+"\n    ")])]),t._v(" "),i("div",{staticClass:"modal-body modal-full-width container-fluid new-sign-modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.signInfo.name,expression:"signInfo.name"}],staticClass:"form-control",attrs:{type:"text",maxlength:t.signInfo.maxLength,placeholder:t.i18n.addSignPlaceholder},domProps:{value:t.signInfo.name},on:{input:function(e){e.target.composing||t.$set(t.signInfo,"name",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group data-wrap"},[i("v-datepicker",{ref:"startTime",staticClass:"btn-block time-picker",attrs:{defaultValue:t.signInfo.startTime,format:t.signInfo.dateFormat,placeholder:t.i18n.signStartPlaceholder,clearButton:!1},on:{daySelected:t.signStartSelected}}),t._v(" "),i("v-datepicker",{ref:"endTime",staticClass:"btn-block time-picker",attrs:{defaultValue:t.signInfo.endTime,format:t.signInfo.dateFormat,placeholder:t.i18n.signEndPlaceholder,clearButton:!1},on:{daySelected:t.signEndSelected}})],1),t._v(" "),i("div",{staticClass:"form-group"},[i("div",{staticClass:"sign-ways"},[i("div",{staticClass:"sign-way",class:{active:t.signInfo.signWay===t.signInfo.signWays.qrcode},on:{click:function(e){return t.setSignWay(t.signInfo.signWays.qrcode)}}},[i("v-icon",{attrs:{name:t.signInfo.signWay===t.signInfo.signWays.qrcode?"radio_button_checked":"radio_button_unchecked"}}),t._v(" "),i("span",[t._v("扫码签到")])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.signInfo.signWay===t.signInfo.signWays.qrcode,expression:"signInfo.signWay === signInfo.signWays.qrcode"}]},[i("div",{staticClass:"switch",class:t.signInfo.useDynamicCode?"on":"off",on:{click:function(e){t.signInfo.useDynamicCode=!t.signInfo.useDynamicCode}}},[i("span",{staticClass:"label"},[t._v(t._s(t.i18n.useDynamicCode))]),t._v(" "),i("div",{staticClass:"slider"},[i("div",{staticClass:"pipe"}),t._v(" "),i("div",{staticClass:"head"})])]),t._v(" "),i("div",{staticClass:"switch",class:t.signInfo.scanQrcodeWithLocation?"on":"off",on:{click:function(e){t.signInfo.scanQrcodeWithLocation=!t.signInfo.scanQrcodeWithLocation}}},[i("span",{staticClass:"label"},[t._v("开启定位限制")]),t._v(" "),i("div",{staticClass:"slider"},[i("div",{staticClass:"pipe"}),t._v(" "),i("div",{staticClass:"head"})])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.signInfo.scanQrcodeWithLocation,expression:"signInfo.scanQrcodeWithLocation"}],staticClass:"qrcode-locations"},[i("locations",{attrs:{locations:t.signInfo.qrcodeLocations}})],1)]),t._v(" "),i("div",{staticClass:"sign-way",class:{active:t.signInfo.signWay===t.signInfo.signWays.location},on:{click:function(e){return t.setSignWay(t.signInfo.signWays.location)}}},[i("v-icon",{attrs:{name:t.signInfo.signWay===t.signInfo.signWays.location?"radio_button_checked":"radio_button_unchecked"}}),t._v(" "),i("span",[t._v("定位签到")])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.signInfo.signWay===t.signInfo.signWays.location,expression:"signInfo.signWay === signInfo.signWays.location"}]},[i("locations",{attrs:{locations:t.signInfo.locations}})],1)])])]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.cancel}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.confirm}},[t._v(t._s(t.i18n.sure))])])])},staticRenderFns:[]};var Ct=i("Mz/3")(yt,_t,!1,function(t){i("MKX+")},"data-v-144ebf42",null).exports,bt=i("6Koo"),wt=(Object(l.b)(function(){this.tabsData[this.curTab].init=!1,this.selectTab(this.curTab)},400),{components:{VIcon:J,CategoryProjectList:ht,Locations:mt,SignInfoModal:Ct},data:function(){return{proxyArr:[],schoolStatusArr:[{label:"在校",value:"IN_SCHOOL"},{label:"不在校",value:"NOT_IN_SCHOOL"}],lang:"zh-cn",tabs:{ALL:"ALL",MANAGE:"MANAGE",PROXY:"PROXY",MINE:"MINE"},roleList:[],seleced_role:"",collegeList:[],seleced_college:"",keyword:null,curTab:"MANAGE",tabsData:{ALL:{text:null,name:null,loading:!0,init:!1,activeCategoryId:null,activeProjectId:null,categories:[],projects:{},hasAuthority:!1},MANAGE:{text:null,name:null,loading:!0,init:!1,activeCategoryId:null,activeProjectId:null,categories:[],projects:{},hasAuthority:!1},PROXY:{text:null,name:null,loading:!0,init:!1,activeCategoryId:null,activeProjectId:null,categories:[],projects:{},hasAuthority:!1},MINE:{text:null,name:null,loading:!0,init:!1,activeCategoryId:null,activeProjectId:null,categories:[],projects:{},hasAuthority:!1}},userTypes:{ALL:"ALL",MANAGE:"MANAGE",PROXY:"AGENT",MINE:"MY"},newProjectModal:{show:!1,name:null,categoryId:null,projectNameMaxLength:30,categoryNameMaxLength:15,categories:[],showAddCategoryForm:!1,newCategoryName:null},editNameModal:{show:!1,title:null,placeholder:null,maxLength:null,i18n:null,id:null,type:null,name:null,focusInput:!0,category:null,project:null},newSignModal:{show:!1,name:null,startTime:"",endTime:"",signWays:{qrcode:"qrcode",location:"location"},signWay:"qrcode",useDynamicCode:!1,scanQrcodeWithLocation:!1,locations:[],qrcodeLocations:[],activeLocationIndex:0,project:null,projectId:null,maxLength:20,dateFormat:"yyyy-MM-dd hh:ii:ss"},importPeople:{show:!1,parentPageTitle:null,downloadTemplateUrl:"/iSignIn/projects/downloadTemplate",downloadErrorTemplateUrl:"/iSignIn/projects/excels/error",checkTemplateUrl:"",importBtnType:null,templateName:"自定义名单模板",project:null},importPeopleBai:{show:!1,parentPageTitle:null,downloadTemplateUrl:"/iSignIn/projects/excludeListTemplate",downloadErrorTemplateUrl:"/iSignIn/projects/excludeList/excels/error",checkTemplateUrl:"",importBtnType:null,templateName:"自定义白名单模板",project:null},limitOptions:{educationLevel:[{id:0,text:"不限制"}]}}},created:function(){var t=window.localStorage.getItem("lang");t&&Object(l.f)(t)&&(this.lang=t),this.editNameModal.i18n=this.i18n,this.tabsData.MANAGE.name=this.tabsData.MANAGE.text=this.i18n.listTypeManage,this.tabsData.ALL.name=this.tabsData.ALL.text=this.i18n.listAll,this.tabsData.PROXY.name=this.tabsData.PROXY.text=this.i18n.listTypeProxy,this.tabsData.MINE.name=this.tabsData.MINE.text=this.i18n.listTypeMine,this.selectTab(this.tabs.MANAGE),this.initLimitConditions()},computed:{i18n:function(){return Object(l.f)(this.lang).iSign}},methods:{isCurrentTab:function(t){return this.curTab===t},selectTab:function(t){var e=this;this.proxyArr=[];var i=this.tabsData[t];this.curTab===t&&(i.init=!1,i.loading=!0,i.projects={},i.activeCategoryId=null,i.activeProjectId=null),this.curTab=t,i.init?i.loading=!1:(i.loading=!0,c(function(a,o){return a?e.$toast(e.i18n.error.networkError):o.state?(i.hasAuthority=!0,t!=e.tabs.MANAGE||o.data?void d(e.curTab,e.keyword,function(a,o){if(a)return e.$toast(e.i18n.error.networkError);if(!o.state)return e.$toast(o.message);if(i.init=!0,i.categories=o.data,i.loading=!1,i.categories.length){var s=i.categories[0];i.activeCategoryId=s.id;var r=e.getProjectDefaultViewSettings();e.$set(i.projects,s.id,r),h(e.userTypes[t],s.id,e.keyword,r.page,r.size,function(t,a){if(t)return e.$toast(e.i18n.error.networkError);if(!a.state)return e.$toast(a.message);e.proxyArr=a.list,r.init=!0,r.list=a.list,r.loading=!1,r.hasMore=a.totalPages>r.page+1,r.list.length&&(i.activeProjectId=i.activeCategoryId+"-"+r.list[0].id,e.selectProject(i.activeProjectId));var o=!0,s=!1,l=void 0;try{for(var c,d=n()(a.list);!(o=(c=d.next()).done);o=!0){var u=c.value;e.setProjectPeopleCount(u)}}catch(t){s=!0,l=t}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}})}}):(i.hasAuthority=!1,i.init=!0,void(i.loading=!1))):e.$toast(o.message)}))},initLimitConditions:function(){var t=this;I(function(e,i){if(e)return t.$toast(t.i18n.error.networkError);if(!i.state)return t.$toast(i.message);if(i.data)for(var a in i.data)t.limitOptions.educationLevel.push({id:a,text:i.data[a]})})},showMoreProjects:function(t){var e=this,i=this.tabsData[this.curTab].projects[t.id];i.page+=1,i.pageLoading=!0,h(this.userTypes[this.curTab],t.id,this.keyword,i.page,i.size,function(t,a){if(t)return e.$toast(e.i18n.error.networkError);if(!a.state)return e.$toast(a.message);i.pageLoading=!1,i.list=i.list.concat(a.list),i.hasMore=a.totalPages>i.size+1,i.hasMore||(i.showNoMoreTip=!0,Object(bt.setTimeout)(function(){i.showNoMoreTip=!1},2e3));var o=!0,s=!1,r=void 0;try{for(var l,c=n()(a.list);!(o=(l=c.next()).done);o=!0){var d=l.value;e.setProjectPeopleCount(d)}}catch(t){s=!0,r=t}finally{try{!o&&c.return&&c.return()}finally{if(s)throw r}}})},mouseoverTab:function(t){t===this.curTab&&(this.tabsData[t].text=this.i18n.refresh)},mouseoutTab:function(t){this.tabsData[t].text=this.tabsData[t].name},toAddProjectModal:function(){var t=this;d(this.curTab,this.keyword,function(e,i){if(e)return t.$toast(t.i18n.error.networkError);i.state?(t.getRole(),!t.collegeList.length&&t.getCollege()&&(t.newProjectModal.categories=[]),i.data.map(function(e){t.newProjectModal.categories.push(e)}),t.newProjectModal.categoryId=null,t.newProjectModal.newCategoryName=null,t.newProjectModal.show=!0):t.$toast(i.message)})},getRole:function(){var t=this;Object(l.d)({type:"get",url:"/api/iSignIn/projects/userSignInManageRole",success:function(e){e.state&&e.data.length&&(1==e.data.length?(t.roleList=[{label:"SCHOOL"==e.data[0]?"校级":"院级",value:e.data[0]}],t.seleced_role=e.data[0]):(t.roleList=[{label:"校级",value:"SCHOOL"},{label:"院级",value:"COLLEGE"}],t.seleced_role="SCHOOL"))}})},getCollege:function(){var t=this;Object(l.d)({type:"get",url:"/api/iSignIn/projects/manageSignInColleges",success:function(e){e.state&&e.data.length&&(t.collegeList=e.data)}})},afterSelectedRole:function(t){},addCategory:function(){var t=this;if(!this.newProjectModal.newCategoryName)return this.$toast(this.i18n.error.pleaseFillInCategoryName);v(this.newProjectModal.newCategoryName,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.newProjectModal.categories.unshift(i.data),t.newProjectModal.categoryId=i.data.id,t.unshiftCategoryToTabs(i.data),t.$toast(t.i18n.tip.addCategorySuccess),void(t.newProjectModal.showAddCategoryForm=!1)):"50003"==i.code?t.$toast(t.i18n.error.categoryNameIsExisted):t.$toast(i.message)})},unshiftCategoryToTabs:function(t){for(var e in this.tabsData)this.tabsData[e].categories.unshift(t),this.$set(this.tabsData[e].projects,t.id,this.getProjectDefaultViewSettings())},addProject:function(){var t=this;if(!this.newProjectModal.name)return this.$toast(this.i18n.error.pleaseFillInProjectName);if(!this.seleced_role)return this.$toast("请选择所属级别");if("COLLEGE"==this.seleced_role&&!this.seleced_college)return this.$toast("请选择分管学院");var e=this.newProjectModal.categoryId;if(!e&&!this.newProjectModal.newCategoryName)return this.$toast(this.i18n.error.pleaseChooseCategoryOrAddCategory);y({projectName:this.newProjectModal.name,projectTypeId:e,projectTypeName:this.newProjectModal.newCategoryName,level:this.seleced_role,college:this.seleced_college},function(i,a){if(i)return t.$toast(t.i18n.error.networkError);if(!a.state)return t.$toast(a.message);var o=t.tabsData[t.curTab].projects;o[e]||t.$set(o,e,t.getProjectDefaultViewSettings()),a.data.peopleLoading=!1,a.data.peopleCount=0,o[e].init=!1,o[e].loading=!1,o[e].list.unshift(a.data),t.newProjectModal.show=!1,t.tabsData[t.curTab].activeCategoryId=e,t.selectProject(e+"-"+a.data.id),alert("项目创建成功，请继续设置人员限制、代理设置、签到");var n=t.tabsData[t.curTab].categories,s=-1;for(var r in n)if(n[r].id==e){s=parseInt(r);break}if(-1==s)return console.warn("unexpected data: category not found:",n,e);0!=s&&n.unshift(n.splice(s,1)[0])})},toEditCategoryName:function(t){this.editNameModal.show=!0,this.editNameModal.title=this.i18n.editCategoryName,this.editNameModal.placeholder=this.i18n.addCategoryPlaceholder,this.editNameModal.maxLength=this.newProjectModal.categoryNameMaxLength,this.editNameModal.focusInput=!0,this.editNameModal.id=t.id,this.editNameModal.name=t.name,this.editNameModal.type="category",this.editNameModal.category=t,this.editNameModal.project=null},toEditProjectName:function(t){this.editNameModal.show=!0,this.editNameModal.title=this.i18n.editProjectName,this.editNameModal.placeholder=this.i18n.addProjectPlaceholder,this.editNameModal.maxLength=this.newProjectModal.projectNameMaxLength,this.editNameModal.focusInput=!0,this.editNameModal.id=t.id,this.editNameModal.name=t.name,this.editNameModal.type="project",this.editNameModal.category=null,this.editNameModal.project=t},toAddSign:function(t){this.newSignModal.show=!0,this.newSignModal.projectId=t.id,this.newSignModal.project=t,this.newSignModal.name="",this.newSignModal.startTime=null,this.newSignModal.endTime=null,this.newSignModal.useDynamicCode=!1},toSignInfo:function(t){var e=this;m(t.sign.id,function(i,a){return i?e.$toast(e.i18n.error.networkError):a.state?(X()(t.sign,a.data),void e.$emit("to-sign-info",X()(t,{tab:e.curTab}))):e.$toast(a.message)})},toProxySettings:function(t){this.$emit("to-proxy-settings",t)},toImport:function(t){var e=this;this.importPeople.parentPageTitle=t.name+"/ 自定义名单导入",this.importPeople.checkTemplateUrl="/iSignIn/projects/peopleLimit/excels/"+t.id,this.importPeople.importBtnType=[{url:"/iSignIn/projects/peopleLimit/"+t.id+"/LIMIT_BY_LIST",method:"PUT",isShowBtn:!0,name:"覆盖导入",success:function(t){t.state&&e.importSuccess()}}],this.importPeople.show=!0,this.importPeople.project=t},toimportBai:function(t){var e=this;this.importPeopleBai.parentPageTitle=t.name+"/ 白名单导入",this.importPeopleBai.checkTemplateUrl="/iSignIn/projects/checkExcludeList/excels/"+t.id,this.importPeopleBai.importBtnType=[{url:"/iSignIn/projects/createExcludePeoples",method:"PUT",isShowBtn:!0,name:"覆盖导入",success:function(t){t.state&&e.importSuccess()}}],this.importPeopleBai.show=!0,this.importPeopleBai.project=t},setSignWay:function(t){this.newSignModal.signWay=t},addSign:function(){var t=this;S(this.newSignModal,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.newSignModal.project.signs.init=!1,t.$toast(t.i18n.tip.addSignSuccess),t.newSignModal.show=!1,t.newSignModal.project.signs.list.push(i.data),void t.selectProject(t.newSignModal.project.categoryId+"-"+t.newSignModal.projectId)):t.$toast(i.message)})},deleteSign:function(t){var e=this,i=t.project,a=t.sign;L(a.id,function(t,o){if(t)return e.$toast(e.i18n.error.networkError);if(!o.state)return"50001"===o.code?e.$toast("该签到已经被删除，请刷新页面查看最新数据"):e.$toast(o.message);e.$toast(e.i18n.tip.deleteSuccess);var n=-1;i.signs.list.forEach(function(t,e){a.id==t.id&&(n=e)}),-1!==n?i.signs.list.splice(n,1):console.warn("delete sign which not in project",a,-1)})},submitEditName:function(){var t=this;if(!this.editNameModal.name)return this.$toast(this.i18n.error.pleaseFillInName);var e={id:this.editNameModal.id,name:this.editNameModal.name};"category"==this.editNameModal.type?C(e,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.$toast(t.i18n.tip.modifySuccess),t.editNameModal.category.name=t.editNameModal.name,void(t.editNameModal.show=!1)):"50003"===i.code?t.$toast("该分类名称已经存在"):t.$toast(i.message)}):(e.categoryId=this.editNameModal.project.categoryId,_(e,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.$toast(t.i18n.tip.modifySuccess),t.editNameModal.project.name=t.editNameModal.name,void(t.editNameModal.show=!1)):"50003"===i.code?t.$toast("该项目名称已经存在"):t.$toast(i.message)}))},getProjectDefaultViewSettings:function(){return{init:!1,page:0,size:5,list:[],loading:!0,end:!1,hasMore:!1,pageLoading:!1,showNoMoreTip:!1}},selectCategory:function(t){var e=this;this.proxyArr=[];var i=this.tabsData[this.curTab],a=i.projects[t]||this.getProjectDefaultViewSettings();this.$set(i.projects,t,a),h(this.userTypes[this.curTab],t,this.keyword,a.page,a.size,function(o,s){if(o)return e.$toast(e.i18n.error.networkError);if(!s.state)return e.$toast(s.message);a.init=!0,a.list=s.list,e.proxyArr=s.list,a.loading=!1,a.hasMore=s.totalPages>a.page+1,a.list.length&&(i.activeProjectId=t+"-"+a.list[0].id,e.selectProject(i.activeProjectId));var r=!0,l=!1,c=void 0;try{for(var d,u=n()(s.list);!(r=(d=u.next()).done);r=!0){var h=d.value;e.setProjectPeopleCount(h)}}catch(o){l=!0,c=o}finally{try{!r&&u.return&&u.return()}finally{if(l)throw c}}})},selectProject:function(t){var e=this,i=this.tabsData[this.curTab];i.activeProjectId=t;var a=t.split("-"),o=Q()(a,2),s=o[0],r=o[1],l=i.projects[s].list,c=void 0,d=!0,u=!1,h=void 0;try{for(var g,m=n()(l);!(d=(g=m.next()).done);d=!0){var v=g.value;if(v.id==r){c=v;break}}}catch(t){u=!0,h=t}finally{try{!d&&m.return&&m.return()}finally{if(u)throw h}}if(!c)return this.$toast(this.i18n.error.dataError);if(!c.signs.init){var y=p;this.curTab==this.tabs.MINE&&(y=f),c.signs.loading=!0,y(c.id,function(t,i){return t?e.$toast(e.i18n.error.networkError):i.state?(c.signs.init=!0,c.signs.loading=!1,void(i.data.length&&(c.signs.list=i.data))):e.$toast(i.message)})}},setLimitType:function(t){var e=this,i=t.project,a=t.type,o=t.conditions;i.peopleLoading=!0,i.peopleCount="",o=o||{},M(i.id,a,o,function(t,n){return t?e.$toast(e.i18n.error.networkError):n.state?(e.$toast(e.i18n.tip.setSuccess),i.limitListOfPeople=a,i.educationLevel=o.educationLevel,i.educationLevelLabel=o.educationLevelLabel,i.grade=o.grade,i.inSchoolStatus=o.inSchoolStatus,void e.setProjectPeopleCount(i)):e.$toast(n.message)})},setProjectPeopleCount:function(t){var e=this;g(t.id,function(i,a){return i?e.$toast(e.i18n.error.networkError):a.state?(t.peopleLoading=!1,void(t.peopleCount=a.data)):e.$toast(a.message)})},importSuccess:function(){var t=this;this.$toast("设置成功"),this.importPeople.show=!1,this.importPeople.project.peopleLoading=!0,u(this.importPeople.project.id,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.importPeople.project.peopleLoading=!1,t.importPeople.project.limitListOfPeople=i.data.limitListOfPeople,void(t.importPeople.project.peopleCount=i.data.peopleCount)):t.$toast(i.message)})},closeImportPeople:function(){this.importPeople.show=!1},closeImportPeopleBai:function(){this.importPeopleBai.show=!1},searchCategoriesAndProjects:Object(l.b)(function(){this.tabsData[this.curTab].init=!1,this.selectTab(this.curTab)},400)}}),It={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.importPeople.show||t.importPeopleBai.show?t.importPeople.show&&!t.importPeopleBai.show?i("v-import",t._b({on:{backParentPage:t.closeImportPeople}},"v-import",t.importPeople,!1)):i("v-import",t._b({on:{backParentPage:t.closeImportPeopleBai}},"v-import",t.importPeopleBai,!1)):i("div",{attrs:{id:"i-sign"}},[i("div",{staticClass:"i-sign-header"},[i("ul",{staticClass:"tabs"},t._l(t.tabs,function(e){return i("li",{key:e,class:{active:t.isCurrentTab(e)},on:{click:function(i){return t.selectTab(e)},mouseover:function(i){return t.mouseoverTab(e)},mouseout:function(i){return t.mouseoutTab(e)}}},[t._v(t._s(t.tabsData[e].text))])}),0),t._v(" "),i("div",{staticClass:"search"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text"},domProps:{value:t.keyword},on:{input:[function(e){e.target.composing||(t.keyword=e.target.value)},t.searchCategoriesAndProjects]}}),t._v(" "),i("v-icon",{attrs:{name:"search"}})],1),t._v(" "),t.isCurrentTab(t.tabs.MANAGE)?i("div",{staticClass:"actions"},[i("button",{staticClass:"btn",attrs:{type:"button"},on:{click:t.toAddProjectModal}},[i("v-icon",{staticClass:"pull-left",attrs:{name:"add"}}),t._v(t._s(t.i18n.addProject)+"\n      ")],1)]):t._e()]),t._v(" "),i("div",{staticClass:"i-sign-projects"},t._l(t.tabs,function(e){return i("div",{key:e},[i("category-project-list",{directives:[{name:"show",rawName:"v-show",value:t.isCurrentTab(e),expression:"isCurrentTab(tab)"}],key:e,attrs:{tabs:t.tabs,"cur-tab":e,loading:t.tabsData[e].loading,categories:t.tabsData[e].categories,projects:t.tabsData[e].projects,activeCategoryId:t.tabsData[e].activeCategoryId,activeProjectId:t.tabsData[e].activeProjectId,hasAuthority:t.tabsData[e].hasAuthority,limitOptions:t.limitOptions,proxyArr:t.proxyArr,schoolStatusArr:t.schoolStatusArr},on:{"to-edit-category-name":t.toEditCategoryName,"to-edit-project-name":t.toEditProjectName,"to-add-sign":t.toAddSign,"to-proxy-settings":t.toProxySettings,"to-sign-info":t.toSignInfo,"to-import":t.toImport,"to-importBai":t.toimportBai,"select-category":t.selectCategory,"select-project":t.selectProject,"set-limit-type":t.setLimitType,"delete-sign":t.deleteSign,"show-more-projects":t.showMoreProjects}})],1)}),0),t._v(" "),i("v-modal",{attrs:{show:t.newProjectModal.show,effect:"fade",width:"400"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.i18n.addProject)+"\n      ")])]),t._v(" "),i("div",{staticClass:"modal-body container-fluid new-sign-modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newProjectModal.name,expression:"newProjectModal.name"}],staticClass:"form-control modal-input",attrs:{type:"text",maxlength:t.newProjectModal.projectNameMaxLength,placeholder:t.i18n.addProjectPlaceholder},domProps:{value:t.newProjectModal.name},on:{input:function(e){e.target.composing||t.$set(t.newProjectModal,"name",e.target.value)}}}),t._v(" "),i("v-select",{staticClass:"seleced_role",attrs:{options:t.roleList,optionsLabel:"label",optionsValue:"value"},on:{afterSelected:function(e){return t.afterSelectedRole(e)}},model:{value:t.seleced_role,callback:function(e){t.seleced_role=e},expression:"seleced_role"}}),t._v(" "),"COLLEGE"==t.seleced_role?i("v-select",{staticClass:"seleced_role",attrs:{options:t.collegeList,optionsLabel:"text",optionsValue:"id",placeholder:"请选择学院"},model:{value:t.seleced_college,callback:function(e){t.seleced_college=e},expression:"seleced_college"}}):t._e()],1),t._v(" "),i("div",{staticClass:"row type-div"},[i("div",{staticClass:"app-type-text"},[t._v("\n          "+t._s(t.i18n.selectCategory)+"\n          "),i("span",{staticClass:"add-category",on:{click:function(e){t.newProjectModal.showAddCategoryForm=!0}}},[t._v(t._s(t.i18n.new))])]),t._v(" "),i("div",{staticClass:"app-type-content"},[t.newProjectModal.showAddCategoryForm?i("div",{staticClass:"creat-category-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newProjectModal.newCategoryName,expression:"newProjectModal.newCategoryName"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control",attrs:{type:"text",maxlength:t.newProjectModal.categoryNameMaxLength,placeholder:t.i18n.addCategoryPlaceholder},domProps:{value:t.newProjectModal.newCategoryName},on:{input:function(e){e.target.composing||t.$set(t.newProjectModal,"newCategoryName",e.target.value)}}}),t._v(" "),i("div",{staticClass:"pull-right create-btn-group"},[i("button",{staticClass:"btn create-cancel clearBtnBorder",on:{click:function(e){t.newProjectModal.showAddCategoryForm=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn create-sure clearBtnBorder",on:{click:t.addCategory}},[t._v(t._s(t.i18n.sure))])]),t._v(" "),i("p",{staticClass:"error-msg"})]):t._e(),t._v(" "),t._l(t.newProjectModal.categories,function(e,a){return i("p",{key:a,staticClass:"type-p",class:{active:t.newProjectModal.categoryId===e.id},on:{click:function(i){t.newProjectModal.categoryId=e.id}}},[i("v-icon",{attrs:{name:"done"}}),t._v("\n          "+t._s(e.name)+"\n          ")],1)})],2)])]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.newProjectModal.show=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.addProject}},[t._v(t._s(t.i18n.sure))])])]),t._v(" "),i("v-modal",{attrs:{show:t.editNameModal.show,effect:"fade",width:"400"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.editNameModal.title)+"\n      ")])]),t._v(" "),i("div",{staticClass:"modal-body container-fluid",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.editNameModal.name,expression:"editNameModal.name"},{name:"focus",rawName:"v-focus",value:t.editNameModal.focusInput,expression:"editNameModal.focusInput"}],staticClass:"form-control modal-input",attrs:{type:"text",maxlength:t.editNameModal.maxLength,placeholder:t.editNameModal.placeholder},domProps:{value:t.editNameModal.name},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitEditName(e)},input:function(e){e.target.composing||t.$set(t.editNameModal,"name",e.target.value)}}})])]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.editNameModal.show=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.submitEditName}},[t._v(t._s(t.i18n.sure))])])]),t._v(" "),i("sign-info-modal",{attrs:{title:"新增签到",signInfo:t.newSignModal,i18n:t.i18n},on:{confirm:t.addSign}})],1)},staticRenderFns:[]};var Mt=i("Mz/3")(wt,It,!1,function(t){i("J9VP")},null,null).exports,St=i("L4f1"),xt=i.n(St),Pt=i("t4IU"),Lt=i.n(Pt),Nt=(Object,Object,String,{NOT_SIGN:"未签到",SIGN:"已签到",MANUAL_ENTRY:"手工签到",TIME_OUT_NOT_SIGN:"超时未签到"}),Tt="SCHOOL",kt="COLLEGE",jt="CLASS",Et="RELATIONSHIP",At={components:{VIcon:J,SignInfoModal:Ct},props:{project:Object,sign:Object,userType:String},data:function(){return{classArr:[],loader:W,lang:"zh-cn",datePickerStartTime:"",datePickerEndTime:"",tableParams:{pagesize:10,idField:"id",columns:[],multi:!1,order:!0,search:!1,ts:+new Date},searchOptions:{colleges:[],status:[{id:"NOT_SIGN",text:"未签到"},{id:"SIGN",text:"已签到"},{id:"MANUAL_ENTRY",text:"手工签到"}],managedColleges:[]},addPersonModal:{show:!1,userNo:null,userName:null,userId:null,tip:null},signManualModal:{show:!1,remark:null,signId:null,userId:null,userNo:null},editSignModal:{show:!1,name:null,startTime:"",endTime:"",signWays:{qrcode:"qrcode",location:"location"},signWay:"qrcode",useDynamicCode:!1,scanQrcodeWithLocation:!1,locations:[],qrcodeLocations:[],activeLocationIndex:0,project:null,projectId:null,maxLength:20,dateFormat:"yyyy-MM-dd hh:ii:ss"},qrcode:{fullscreen:!1,oldInstance:null,url:"",instance:null,timer:null},statModal:{show:!1,syncTime:"",totalWidth:550,minWidth:10,loading:!1,noStat:!1,generalChart:{init:!1,instance:null,options:{tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},color:["rgba(92, 107, 192, 1)","rgba(92, 107, 192, .75)","rgba(92, 107, 192, .5)"],series:[{name:"统计",type:"pie",radius:"60%",center:["49%","41%"],data:[],label:{normal:{show:!0}},labelLine:{normal:{show:!0}},itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},legend:{total:{color:"#aaa",text:"应签到",num:0},done:{color:"rgba(92, 107, 192, 1)",text:"已签到",num:0},manual:{color:"rgba(92, 107, 192, .75)",text:"手动签到",num:0},todo:{color:"rgba(92, 107, 192, 0.5)",text:"未签到",num:0}}},currentControl:"general",control:{general:{text:"总览",show:!0,checked:!0,loading:!1},college:{text:"各学院对比",show:!0,checked:!1,type:"COLLEGE",data:[],loading:!1},instructor:{text:"各辅导员对比",show:!0,checked:!1,type:"INSTRUCTOR",data:[],loading:!1},clazz:{text:"各班级对比",show:!0,checked:!1,type:"CLAZZ",data:[],loading:!1}}},proxy:{proxies:[],id:null,distributary:Tt,proxyId:null,name:"",classId:"",collegeCode:""},exporting:!1}},created:function(){var t=this,e=window.localStorage.getItem("lang");e&&Object(l.f)(e)&&(this.lang=e),this.datePickerStartTime=this.sign.startTime,this.datePickerEndTime=this.sign.endTime,Object(l.d)({url:"/api/relClass/classes/list",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.classArr=e.data)}}),this.isProxy&&this.initProxies(),this.initEditSignModal(),this.initManagedColleges(function(){t.initTable()}),this.stopQrcodeTimer()},mounted:function(){this.isProxy||"qrcode"===this.editSignModal.signWay&&this.initQrcode()},computed:{i18n:function(){return Object(l.f)(this.lang).iSign},tableUrl:function(){return this.isManager||this.isALL?"/table-data/signIns/peoples/MANAGE?signInId="+this.sign.id+"&ts="+this.tableParams.ts:this.isProxy?this.proxy.proxyId?"/table-data/signIns/"+this.sign.id+"/people/pages?ts="+this.tableParams.ts+"&agentId="+this.proxy.proxyId+"&classId="+(this.proxy.classId||"")+"&collegeCode="+(this.proxy.collegeCode||""):"":void 0},isManager:function(){return"MANAGE"===this.userType},isALL:function(){return"ALL"===this.userType},isProxy:function(){return"PROXY"===this.userType},qrCodeExpireTime:function(){return this.sign.useDynamicCode?15:0}},methods:{back:function(){this.$emit("back")},initEditSignModal:function(){this.editSignModal.signId=this.sign.id,this.editSignModal.projectId=this.sign.projectId,this.editSignModal.name=this.sign.name,this.editSignModal.startTime=this.sign.startTime,this.editSignModal.endTime=this.sign.endTime,this.editSignModal.useDynamicCode=this.sign.useDynamicCode,this.editSignModal.signWay=this.sign.signWay,this.editSignModal.scanQrcodeWithLocation=this.sign.scanQrcodeWithLocation,this.editSignModal.qrcodeLocations=this.sign.qrcodeLocations,this.editSignModal.locations=this.sign.locations},initTable:function(){var t=this;this.tableParams.columns=[{id:"name",title:this.i18n.signInfo.userName,className:"text-left",width:"55px",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"userNo",title:this.i18n.signInfo.userNo,className:"text-left",width:"120px",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"college",title:this.i18n.signInfo.college,className:"text-left",width:"120px",hidden:!1,search:{type:"select",data:{options:this.searchOptions.colleges,optionsLabel:"text",optionsValue:"id",placeholder:""}}},{id:"classId",title:"班级",className:"text-left",width:"120px",hidden:!1,search:{type:"select",data:{options:this.classArr,optionsLabel:"text",optionsValue:"id",placeholder:""}}},{id:"signInStatus",title:this.i18n.signInfo.signStatus,className:"text-left",width:"60px",hidden:!1,formatter:function(t){return Nt[t.signInStatus]},search:{type:"select",data:{options:this.searchOptions.status,optionsLabel:"text",optionsValue:"id",placeholder:""}}},{id:"signInTime",title:this.i18n.signInfo.signTime,className:"text-left",width:"150px",hidden:!1},{id:"remark",title:this.i18n.signInfo.remark,className:"text-left",width:"250px",hidden:!1},{id:"opt",title:"",className:"text-right",hidden:!1,formatter:function(e){var i=[];return"NOT_SIGN"==e.signInStatus&&i.push({tag:"a",text:t.i18n.signInfo.recordByHand,className:"opt-btn",callback:function(e,i){t.signManualModal.userId=e.userId,t.signManualModal.userNo=e.userNo,t.signManualModal.signId=e.signInId,t.signManualModal.show=!0}}),t.isManager&&i.push({tag:"a",text:t.i18n.signInfo.remove,className:"opt-btn",callback:function(e,i){window.confirm("确定把"+e.name+"从此次签到中移除?")&&T(e.signInId,e.userId,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.$toast(t.i18n.tip.removeSuccess),void(t.tableParams.ts=+new Date)):t.$toast(i.message)})}}),i}}]},toEditSign:function(){this.editSignModal.show=!0},normalizeDateString:function(t){return t&&19!==t.length?t+":00":t},changeProxy:function(t){if(t.val){var e=t.val,i=!0,a=!1,o=void 0;try{for(var s,r=n()(this.proxy.proxies);!(i=(s=r.next()).done);i=!0){var l=s.value;l.id===e&&(this.setCurrentProxy(l),this.refreshQrcode())}}catch(t){a=!0,o=t}finally{try{!i&&r.return&&r.return()}finally{if(a)throw o}}}},saveSign:function(){var t=this;w(this.editSignModal,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.syncSignInfo(),t.editSignModal.show=!1,"qrcode"===t.editSignModal.signWay?t.initQrcode():t.stopQrcodeTimer(),void t.$toast(t.i18n.tip.saveSuccess)):t.$toast(i.message)})},syncSignInfo:function(){this.sign.name=this.editSignModal.name,this.sign.startTime=this.editSignModal.startTime,this.sign.endTime=this.editSignModal.endTime,this.sign.useDynamicCode=this.editSignModal.useDynamicCode,this.sign.signWay=this.editSignModal.signWay,this.sign.scanQrcodeWithLocation=this.editSignModal.scanQrcodeWithLocation,this.sign.qrcodeLocations=this.editSignModal.qrcodeLocations,this.sign.locations=this.editSignModal.locations},showStat:function(){var t=this;this.statModal.loading=!0,this.statModal.show=!0,O(this.sign.id,function(e,i){if(e)return t.$toast(t.i18n.error.networkError);if(!i.state)return t.$toast(i.message);t.statModal.loading=!1;var a=i.data;if(!a)return t.statModal.noStat=!0;t.statModal.noStat=!1,t.statModal.generalChart.legend.total.num=a.count,t.statModal.generalChart.legend.done.num=a.countSign,t.statModal.generalChart.legend.todo.num=a.countNotSinIn,t.statModal.generalChart.legend.manual.num=a.countManualEntry,t.statModal.syncTime=a.timeTemp,t.$nextTick(function(){t.refreshGeneralChart()})})},getSignOptionWidth:function(t){var e=t.done/t.total,i=t.manual/t.total,a=t.todo/t.total;(0==t.total||a==e&&a==i)&&(a=e=i=.3333333);var o=this.statModal.totalWidth*e,n=this.statModal.totalWidth*i,s=this.statModal.totalWidth*a,r=0;return o<10&&(r+=10-o,o=10),n<10&&(r+=10-n,n=10),s<10&&(r+=10-s,s=10),o<n?n>s?n-=r:o>s?o-=r:s-=r:o>s?o-=r:n>s?n-=r:s-=r,{done:o,manual:n,todo:s}},initChartIfNotInit:function(){this.statModal.generalChart.instance=xt.a.init(document.getElementById("general-chart"))},initQrcode:function(){var t=this;this.createSignUrl(function(e){e&&(t.qrcode.url=e,t.qrcode.instance?(t.qrcode.instance.clear(),t.qrcode.instance.makeCode(e)):t.qrcode.instance=new Lt.a("sign-qrcode",{text:e,width:400,height:400}),t.sign.useDynamicCode?t.startQrcodeTimer():t.stopQrcodeTimer())})},refreshQrcode:function(){var t=this;console.log("hhhhh"),this.createSignUrl(function(e){e&&(t.qrcode.url=e,t.qrcode.instance?(t.qrcode.instance.clear(),t.qrcode.instance.makeCode(e)):t.qrcode.instance=new Lt.a("sign-qrcode",{text:e,width:400,height:400}))})},startQrcodeTimer:function(){var t=this;this.stopQrcodeTimer(),this.qrcode.timer=setInterval(function(){t.refreshQrcode()},1e4)},stopQrcodeTimer:function(){this.qrcode.timer&&(clearInterval(this.qrcode.timer),this.qrcode.timer=null)},refreshGeneralChart:function(){this.initChartIfNotInit(),this.statModal.generalChart.options.series[0].data=[{value:this.statModal.generalChart.legend.done.num,name:"已签到"},{name:"手动签到",value:this.statModal.generalChart.legend.manual.num},{name:"未签到",value:this.statModal.generalChart.legend.todo.num}],this.statModal.generalChart.instance.setOption(this.statModal.generalChart.options)},getRadioIcon:function(t){return t?"radio_button_checked":"radio_button_unchecked"},changeStatType:function(t){var e=this,i=this.statModal.control[t];for(var a in this.statModal.control)this.statModal.control[a].checked=!1;i.checked=!0,this.statModal.currentControl=t,"general"!=t&&D(this.sign.id,i.type,function(t,a){return t?e.$toast(e.i18n.error.networkError):a.state?void(i.data=a.data.map(function(t){var i={overview:{total:t.overview.count,done:t.overview.countSign,manual:t.overview.countManualEntry,todo:t.overview.countNotSinIn},title:t.title,sort:t.sort};return i.widthData=e.getSignOptionWidth(i.overview),i})):e.$toast(a.message)})},fullscreen:function(){var t=this;this.qrcode.oldInstance=this.qrcode.instance,this.qrcode.fullscreen=!0,this.$nextTick(function(){t.qrcode.instance=new Lt.a("sign-qrcode-fullscreen",{text:t.qrcode.url,width:400,height:400})})},existFullscreen:function(){this.clearQrcodeInstance(),this.qrcode.instance.clear(),this.qrcode.fullscreen=!1,this.qrcode.instance=this.qrcode.oldInstance},clearQrcodeInstance:function(){for(var t=this.qrcode.instance._el;t.hasChildNodes();)t.removeChild(t.lastChild)},initManagedColleges:function(t){var e=this;j(function(i,a){if(i)return e.$toast(e.i18n.error.networkError);if(!a.state)return e.$toast(a.message);var o=!0,s=!1,r=void 0;try{for(var l,c=n()(a.data.colleges);!(o=(l=c.next()).done);o=!0){var d=l.value;-1==d.id&&(d.id="")}}catch(i){s=!0,r=i}finally{try{!o&&c.return&&c.return()}finally{if(s)throw r}}e.searchOptions.managedColleges=a.data.colleges,e.searchOptions.colleges=e.searchOptions.managedColleges,t&&t()})},initProxies:function(){var t=this;k(this.sign.id,function(e,i){if(e)return t.$toast(t.i18n.error.networkError);if(!i.state)return t.$toast(i.message);if(!i.data)return t.$toast(t.i18n.error.dataError);var a=[],o=[],s=[],r=[],l=!1,c=!1,d=!1,u=!1,h=!0,g=!1,p=void 0;try{for(var m,f=n()(i.data);!(h=(m=f.next()).done);h=!0){var v=m.value;switch(v.distribution){case Tt:a.push(t.createMixProxy(Tt,v.agentId,v.agentName,v.agentName,null,null)),l=!0;break;case kt:for(var y in v.colleges)o.push(t.createMixProxy(kt,v.agentId,v.agentName,v.colleges[y],null,y));c=!0;break;case jt:for(var _ in v.clazz)s.push(t.createMixProxy(jt,v.agentId,v.agentName,v.clazz[_],_,null));d=!0;break;case Et:r.push(t.createMixProxy(Et,v.agentId,v.agentName,v.agentName,null,null)),u=!0;break;default:console.warn("unknown proxy:",v)}}}catch(e){g=!0,p=e}finally{try{!h&&f.return&&f.return()}finally{if(g)throw p}}t.proxy.proxies=a.concat(o.concat(s.concat(r))),t.setCurrentProxy(t.proxy.proxies[0]),t.$nextTick(function(){t.initQrcode()}),t.statModal.control.college.show=!1,t.statModal.control.instructor.show=!1,t.statModal.control.clazz.show=!1,l?(t.statModal.control.college.show=!0,t.statModal.control.instructor.show=!0,t.statModal.control.clazz.show=!0):c?(t.statModal.control.college.show=!0,t.statModal.control.clazz.show=!0):(u||d)&&(t.statModal.control.clazz.show=!0)})},setCurrentProxy:function(t){this.proxy.id=t.id,this.proxy.proxyId=t.proxyId,this.proxy.name=t.name,this.proxy.collegeCode=t.collegeCode,this.proxy.classId=t.classId,this.proxy.distributary=t.distributary,t.distributary===kt?this.searchOptions.colleges=[{id:t.collegeCode,text:t.name}]:this.searchOptions.colleges=this.searchOptions.managedColleges},createMixProxy:function(t,e,i,a,o,n){return{id:t+"-"+e+"-"+(o||"__")+"-"+(n||"__"),proxyId:e,distributary:t,proxyName:i,name:a,classId:o||"",collegeCode:n||""}},signManual:function(){var t=this;if(!this.signManualModal.remark)return this.$toast("您还未填写备注");N(this.sign.id,this.signManualModal.userId,this.signManualModal.remark,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.$toast(t.i18n.tip.setSuccess),t.tableParams.ts=+new Date,void(t.signManualModal.show=!1)):t.$toast(i.message)})},checkUser:function(){var t=this;if(!this.addPersonModal.userNo)return this.$toast("请输入学号");this.addPersonModal.userId=null,this.addPersonModal.tip="检测中...",P(this.addPersonModal.userNo,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.addPersonModal.userId=i.data.userId,void(t.addPersonModal.userName=t.addPersonModal.tip=i.data.name)):"50001"==i.code?t.addPersonModal.tip="不存在该学号":t.$toast(i.message)})},addSignPeople:function(){var t=this;if(!this.addPersonModal.userId)return this.$toast("请输入学号");x(this.project.id,this.sign.id,this.addPersonModal.userId,function(e,i){return e?t.$toast(t.i18n.error.networkError):i.state?(t.$toast("添加成功"),t.tableParams.ts=+new Date,void(t.addPersonModal.show=!1)):"50003"==i.code?t.$toast(t.addPersonModal.userName+"已经在签到名单中"):t.$toast(i.message)})},createSignUrl:function(t){var e=this;A(this.sign.id,this.proxy.distributary,this.proxy.collegeCode,this.proxy.classId,this.qrCodeExpireTime,function(i,a){if(i)return t(),e.$toast(e.i18n.error.networkError);if(!a.state)return t(),e.$toast(a.message);var o=window.location.origin+a.data+"?scope=yiban_scan_result";t(o)})},exportSigns:function(){var t=this.$refs["sign-table"].tableSearchFields||{};if(this.isManager)B(this.sign.id,t.name,t.userNo,t.college,t.signInStatus,t.classId);else{var e=this.project.name+this.sign.name+".xlsx";$(this.sign.id,this.proxy.proxyId,t.name,t.userNo,this.proxy.collegeCode||t.college,this.proxy.classId,t.signInStatus,e)}}},beforeDestroy:function(){this.stopQrcodeTimer()}},Ot={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.qrcode.fullscreen,expression:"qrcode.fullscreen"}],attrs:{id:"qrcode-fullscreen"}},[i("v-icon",{attrs:{name:"close"},nativeOn:{click:function(e){return t.existFullscreen(e)}}}),t._v(" "),i("div",{staticClass:"qrcode-container"},[i("div",{attrs:{id:"sign-qrcode-name"}},[t._v(t._s(t.sign.name))]),t._v(" "),t.sign.useDynamicCode?i("div",{attrs:{id:"sign-qrcode-type"}},[t._v("动态码(刷新间隔10s)")]):t._e(),t._v(" "),i("div",{attrs:{id:"sign-qrcode-fullscreen"}}),t._v(" "),i("div",{attrs:{id:"sign-qrcode-time"}},[t._v(t._s(t.sign.startTime+" ~ "+t.sign.endTime))])])],1),t._v(" "),i("div",{staticClass:"container-fluid",attrs:{id:"sign-info"}},[i("div",{staticClass:"row text-center"},[i("div",{staticClass:"col-md-12"},[i("div",{staticClass:"pull-left back-div",on:{click:t.back}},[i("v-icon",{attrs:{name:"arrow_back"}}),t._v("\n          "+t._s(t.isProxy?t.sign.name:"")+"\n        ")],1)])]),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"col-md-9"},[i("v-table",{ref:"sign-table",attrs:{title:t.isManager?t.sign.name:"",url:t.tableUrl,pagesize:t.tableParams.pagesize,idField:t.tableParams.idField,columns:t.tableParams.columns,multiple:t.tableParams.multi,order:t.tableParams.order,search:t.tableParams.search}},[i("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[t.isProxy?i("div",{staticClass:"btn-group college-select pull-left"},[i("v-select",{attrs:{options:this.proxy.proxies,value:this.proxy.id,"options-value":"id","options-label":"name",required:!0,"close-on-select":"",justify:""},on:{afterSelected:t.changeProxy}})],1):t._e(),t._v(" "),i("div",{staticClass:"pull-right "},[i("button",{staticClass:"btn btn-bgColor-style edit-btn",class:{disabled:t.exporting},attrs:{type:"button"},domProps:{innerHTML:t._s(t.exporting?t.loader.small+"导出中":t.i18n.export)},on:{click:t.exportSigns}}),t._v(" "),t.isManager?i("button",{staticClass:"btn btn-bgColor-style edit-btn",attrs:{type:"button"},on:{click:function(e){t.addPersonModal.show=!0}}},[t._v(t._s(t.i18n.signInfo.editPeople))]):t._e(),t._v(" "),i("button",{staticClass:"btn btn-bgColor-style stat-btn",attrs:{type:"button"},on:{click:t.showStat}},[i("v-icon",{staticClass:"pull-left",attrs:{name:"donut_large"}}),t._v("\n              "+t._s(t.i18n.signInfo.stat)+"\n            ")],1)])])])],1),t._v(" "),i("div",{staticClass:"col-md-3 sign-detail"},[i("div",{staticClass:"sign-detail-div"},[i("div",{staticClass:"info-row"},[i("span",{staticClass:"title"},[t._v(t._s(t.editSignModal.name))]),t._v(" "),i("v-icon",{staticClass:"edit",attrs:{name:"edit"},nativeOn:{click:function(e){return t.toEditSign(e)}}})],1),t._v(" "),i("div",{staticClass:"info-row"},[i("span",{staticClass:"title"},[t._v(t._s(t.i18n.signInfo.start))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t.editSignModal.startTime))])]),t._v(" "),i("div",{staticClass:"info-row"},[i("span",{staticClass:"title"},[t._v(t._s(t.i18n.signInfo.end))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t.editSignModal.endTime))])]),t._v(" "),i("div",{staticClass:"info-row"},[i("span",{staticClass:"title"},[t._v("签到方式")]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s("qrcode"===t.editSignModal.signWay?"扫码签到":"定位签到"))])]),t._v(" "),"qrcode"===t.editSignModal.signWay?i("div",{staticClass:"info-row"},[i("div",{staticClass:"switch",class:{on:t.editSignModal.useDynamicCode,readonly:!0}},[i("span",{staticClass:"label"},[t._v(t._s(t.i18n.useDynamicCode))]),t._v(" "),t._m(0)])]):t._e(),t._v(" "),"qrcode"===t.editSignModal.signWay?i("div",{staticClass:"info-row"},[i("div",{staticClass:"switch",class:{on:t.editSignModal.scanQrcodeWithLocation,readonly:!0}},[i("span",{staticClass:"label"},[t._v("扫码定位限制")]),t._v(" "),t._m(1)])]):t._e(),t._v(" "),"qrcode"===t.editSignModal.signWay&&t.editSignModal.scanQrcodeWithLocation?i("div",{staticClass:"info-row auto-height"},[i("span",{staticClass:"title"},[t._v("地点")]),t._v(" "),i("div",{staticClass:"list"},t._l(t.editSignModal.qrcodeLocations,function(e,a){return i("div",{key:a,staticClass:"item"},[t._v("\n                "+t._s(e.address+" 范围："+e.radius+"米")+"\n              ")])}),0)]):t._e(),t._v(" "),"location"===t.editSignModal.signWay?i("div",{staticClass:"info-row auto-height"},[i("span",{staticClass:"title"},[t._v("地点")]),t._v(" "),i("div",{staticClass:"list"},t._l(t.editSignModal.locations,function(e,a){return i("div",{key:a,staticClass:"item"},[t._v("\n                "+t._s(e.address+" 范围："+e.radius+"米")+"\n              ")])}),0)]):t._e()]),t._v(" "),"qrcode"===t.editSignModal.signWay?i("div",{staticClass:"qr-code-container sign-detail-div"},[i("div",{staticClass:"qr-code"},[i("v-icon",{attrs:{name:"zoom_out_map"},nativeOn:{click:function(e){return t.fullscreen(e)}}}),t._v(" "),i("div",{attrs:{id:"sign-qrcode"}})],1)]):t._e()])]),t._v(" "),i("v-modal",{attrs:{show:t.addPersonModal.show,effect:"fade",width:"400"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n          "+t._s(t.i18n.signInfo.editPeople)+"\n        ")])]),t._v(" "),i("div",{staticClass:"modal-body container-fluid",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.addPersonModal.userNo,expression:"addPersonModal.userNo"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control modal-input",attrs:{type:"text",placeholder:t.i18n.signInfo.addPersonPlaceholder},domProps:{value:t.addPersonModal.userNo},on:{change:t.checkUser,input:function(e){e.target.composing||t.$set(t.addPersonModal,"userNo",e.target.value)}}}),t._v(" "),i("a",{staticClass:"check"},[t._v(t._s(t.i18n.check))]),t._v(" "),i("p",{staticClass:"check-user-tip"},[t._v(t._s(t.addPersonModal.tip))])])]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.addPersonModal.show=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.addSignPeople}},[t._v(t._s(t.i18n.sure))])])]),t._v(" "),i("v-modal",{attrs:{show:t.signManualModal.show,effect:"fade",width:"400"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("\n          "+t._s(t.i18n.signInfo.recordByHand)+"\n        ")])]),t._v(" "),i("div",{staticClass:"modal-body container-fluid",attrs:{slot:"modal-body"},slot:"modal-body"},[i("div",{staticClass:"form-group"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.signManualModal.remark,expression:"signManualModal.remark"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control modal-input",attrs:{type:"text",maxlength:"100",placeholder:t.i18n.signInfo.recordByHandPlaceholder},domProps:{value:t.signManualModal.remark},on:{input:function(e){e.target.composing||t.$set(t.signManualModal,"remark",e.target.value)}}})]),t._v(" "),i("div",{staticClass:"form-group"})]),t._v(" "),i("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.signManualModal.show=!1}}},[t._v(t._s(t.i18n.cancel))]),t._v(" "),i("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.signManual}},[t._v(t._s(t.i18n.sure))])])]),t._v(" "),i("v-modal",{attrs:{id:"stat-modal",show:t.statModal.show,effect:"fade",width:"900"}},[i("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[i("h5",{staticClass:"modal-title"},[i("v-icon",{attrs:{name:"close"},nativeOn:{click:function(e){t.statModal.show=!1}}}),t._v(" "),i("span",[t._v(t._s(t.i18n.signInfo.stat))])],1)]),t._v(" "),i("div",{staticClass:"modal-body container-fluid",attrs:{slot:"modal-body"},slot:"modal-body"},[t.statModal.loading?i("div",{staticClass:"loader",domProps:{innerHTML:t._s(t.loader.iconWithText)}}):t.statModal.noStat?i("div",{staticClass:"loader"},[t._v("暂无统计数据")]):i("div",{staticStyle:{display:"inline-block"}},[i("div",{attrs:{id:"stat-control"}},[i("ul",t._l(t.statModal.control,function(e,a){return e.show?i("li",{key:a,on:{click:function(e){return t.changeStatType(a)}}},[i("v-icon",{attrs:{name:t.getRadioIcon(e.checked)}}),t._v(" "),i("span",[t._v(t._s(e.text))])],1):t._e()}),0)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"general"===t.statModal.currentControl,expression:"statModal.currentControl === 'general'"}]},[i("div",{attrs:{id:"general-chart-text"}},[i("ul",t._l(t.statModal.generalChart.legend,function(e,a){return i("li",{key:a},[i("span",{staticClass:"color",style:{background:e.color}}),t._v(" "),i("span",{staticClass:"text"},[t._v(t._s(e.text))]),t._v(" "),i("span",{staticClass:"num"},[t._v(t._s(e.num))])])}),0)]),t._v(" "),i("div",{attrs:{id:"general-chart"}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"general"!==t.statModal.currentControl,expression:"statModal.currentControl !== 'general'"}]},[i("div",{attrs:{id:"bar-chart"}},t._l(t.statModal.control,function(e,a){return"manage"!=a&&e.checked?i("ul",{key:a,staticClass:"items"},t._l(e.data,function(e){return i("li",{key:e.title,staticClass:"item"},[i("div",{staticClass:"title",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),i("div",{staticClass:"bar"},[i("ul",{staticClass:"bar-chart"},[i("li",{staticClass:"part bar-done",style:{width:e.widthData.done+"px"},attrs:{title:"已签到:"+e.overview.done}}),t._v(" "),i("li",{staticClass:"part bar-manual",style:{width:e.widthData.manual+"px"},attrs:{title:"手工签到:"+e.overview.manual}}),t._v(" "),i("li",{staticClass:"part bar-todo",style:{width:e.widthData.todo+"px"},attrs:{title:"未签到:"+e.overview.todo}})]),t._v(" "),i("ul",{staticClass:"bar-tip"},[i("li",{staticClass:"text",style:{width:e.widthData.done+"px"}},[t._v(t._s(e.widthData.done>36?"已签到 "+e.overview.done:""))]),t._v(" "),i("li",{staticClass:"text",style:{width:e.widthData.manual+"px"}},[t._v(t._s(e.widthData.manual>36?"手工签到 "+e.overview.manual:""))]),t._v(" "),i("li",{staticClass:"text",style:{width:e.widthData.todo+"px"}},[t._v(t._s(e.widthData.todo>36?"未签到 "+e.overview.todo:""))])])])])}),0):t._e()}),0)]),t._v(" "),i("div",{attrs:{id:"stat-sync-time"}},[t._v("以上数据统计截止至："+t._s(t.statModal.syncTime))])])])]),t._v(" "),i("sign-info-modal",{attrs:{title:"编辑签到",signInfo:t.editSignModal,i18n:t.i18n},on:{confirm:t.saveSign}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"slider"},[e("div",{staticClass:"pipe"}),this._v(" "),e("div",{staticClass:"head"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"slider"},[e("div",{staticClass:"pipe"}),this._v(" "),e("div",{staticClass:"head"})])}]};var Dt=i("Mz/3")(At,Ot,!1,function(t){i("sByh")},null,null).exports,Bt={components:{ProjectManage:Mt,ProxySettings:F,SignInfo:Dt},data:function(){return{pages:{PROJECT_MANAGE:"PROJECT_MANAGE",PROXY_SETTINGS:"PROXY_SETTINGS",SIGN_INFO:"SIGN_INFO"},curPage:"PROJECT_MANAGE",proxySettings:{projectId:null,projectName:null},signInfo:{project:null,sign:null,userType:null}}},created:function(){},computed:{},methods:{isCurrentPage:function(t){return this.curPage===t},toProxySettings:function(t){this.proxySettings.projectId=t.id,this.proxySettings.projectName=t.name,this.proxySettings.projectLevel=t.level,this.jumpTo(this.pages.PROXY_SETTINGS)},toSignInfo:function(t){var e=t.project,i=t.sign,a=t.tab;this.signInfo.project=e,this.signInfo.sign=i,this.signInfo.userType=a,this.jumpTo(this.pages.SIGN_INFO)},toProjectManage:function(){this.jumpTo(this.pages.PROJECT_MANAGE)},jumpTo:function(t){this.curPage=t}}},$t={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("project-manage",{directives:[{name:"show",rawName:"v-show",value:t.isCurrentPage(t.pages.PROJECT_MANAGE),expression:"isCurrentPage(pages.PROJECT_MANAGE)"}],on:{"to-proxy-settings":t.toProxySettings,"to-sign-info":t.toSignInfo}}),t._v(" "),t.isCurrentPage(t.pages.PROXY_SETTINGS)?i("proxy-settings",t._b({key:t.proxySettings.projectId,on:{back:t.toProjectManage}},"proxy-settings",t.proxySettings,!1)):t._e(),t._v(" "),t.isCurrentPage(t.pages.SIGN_INFO)?i("sign-info",t._b({key:t.signInfo.sign.id,on:{back:t.toProjectManage}},"sign-info",t.signInfo,!1)):t._e()],1)},staticRenderFns:[]};var Rt=i("Mz/3")(Bt,$t,!1,function(t){i("xLcV")},null,null);e.default=Rt.exports},J9VP:function(t,e){},"MKX+":function(t,e){},aBzm:function(t,e){},fjjs:function(t,e,i){"use strict";e.__esModule=!0;var a=n(i("4zso")),o=n(i("u6qr"));function n(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return function(t,e){var i=[],a=!0,n=!1,s=void 0;try{for(var r,l=(0,o.default)(t);!(a=(r=l.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){n=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},"h/I9":function(t,e){},sByh:function(t,e){},smXx:function(t,e,i){var a=i("nAXw"),o=i("90nM")("iterator"),n=i("003I");t.exports=i("CgoK").isIterable=function(t){var e=Object(t);return void 0!==e[o]||"@@iterator"in e||n.hasOwnProperty(a(e))}},t4IU:function(t,e,i){var a,o;o=function(){function t(t){this.mode=i.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,a=this.data.length;e<a;e++){var o=[],n=this.data.charCodeAt(e);n>65536?(o[0]=240|(1835008&n)>>>18,o[1]=128|(258048&n)>>>12,o[2]=128|(4032&n)>>>6,o[3]=128|63&n):n>2048?(o[0]=224|(61440&n)>>>12,o[1]=128|(4032&n)>>>6,o[2]=128|63&n):n>128?(o[0]=192|(1984&n)>>>6,o[1]=128|63&n):o[0]=n,this.parsedData.push(o)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function e(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}t.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,i=this.parsedData.length;e<i;e++)t.put(this.parsedData[e],8)}},e.prototype={addData:function(e){var i=new t(e);this.dataList.push(i),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[a][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},setupPositionProbePattern:function(t,e){for(var i=-1;i<=7;i++)if(!(t+i<=-1||this.moduleCount<=t+i))for(var a=-1;a<=7;a++)e+a<=-1||this.moduleCount<=e+a||(this.modules[t+i][e+a]=0<=i&&i<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==i||6==i)||2<=i&&i<=4&&2<=a&&a<=4)},getBestMaskPattern:function(){for(var t=0,e=0,i=0;i<8;i++){this.makeImpl(!0,i);var a=g.getLostPoint(this);(0==i||t>a)&&(t=a,e=i)}return e},createMovieClip:function(t,e,i){var a=t.createEmptyMovieClip(e,i);this.make();for(var o=0;o<this.modules.length;o++)for(var n=1*o,s=0;s<this.modules[o].length;s++){var r=1*s;this.modules[o][s]&&(a.beginFill(0,100),a.moveTo(r,n),a.lineTo(r+1,n),a.lineTo(r+1,n+1),a.lineTo(r,n+1),a.endFill())}return a},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=g.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var i=0;i<t.length;i++){var a=t[e],o=t[i];if(null==this.modules[a][o])for(var n=-2;n<=2;n++)for(var s=-2;s<=2;s++)this.modules[a+n][o+s]=-2==n||2==n||-2==s||2==s||0==n&&0==s}},setupTypeNumber:function(t){for(var e=g.getBCHTypeNumber(this.typeNumber),i=0;i<18;i++){var a=!t&&1==(e>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=a}for(i=0;i<18;i++){a=!t&&1==(e>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=a}},setupTypeInfo:function(t,e){for(var i=this.errorCorrectLevel<<3|e,a=g.getBCHTypeInfo(i),o=0;o<15;o++){var n=!t&&1==(a>>o&1);o<6?this.modules[o][8]=n:o<8?this.modules[o+1][8]=n:this.modules[this.moduleCount-15+o][8]=n}for(o=0;o<15;o++){n=!t&&1==(a>>o&1);o<8?this.modules[8][this.moduleCount-o-1]=n:o<9?this.modules[8][15-o-1+1]=n:this.modules[8][15-o-1]=n}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var i=-1,a=this.moduleCount-1,o=7,n=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var r=0;r<2;r++)if(null==this.modules[a][s-r]){var l=!1;n<t.length&&(l=1==(t[n]>>>o&1)),g.getMask(e,a,s-r)&&(l=!l),this.modules[a][s-r]=l,-1==--o&&(n++,o=7)}if((a+=i)<0||this.moduleCount<=a){a-=i,i=-i;break}}}},e.PAD0=236,e.PAD1=17,e.createData=function(t,i,a){for(var o=v.getRSBlocks(t,i),n=new y,s=0;s<a.length;s++){var r=a[s];n.put(r.mode,4),n.put(r.getLength(),g.getLengthInBits(r.mode,t)),r.write(n)}var l=0;for(s=0;s<o.length;s++)l+=o[s].dataCount;if(n.getLengthInBits()>8*l)throw new Error("code length overflow. ("+n.getLengthInBits()+">"+8*l+")");for(n.getLengthInBits()+4<=8*l&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*l||(n.put(e.PAD0,8),n.getLengthInBits()>=8*l));)n.put(e.PAD1,8);return e.createBytes(n,o)},e.createBytes=function(t,e){for(var i=0,a=0,o=0,n=new Array(e.length),s=new Array(e.length),r=0;r<e.length;r++){var l=e[r].dataCount,c=e[r].totalCount-l;a=Math.max(a,l),o=Math.max(o,c),n[r]=new Array(l);for(var d=0;d<n[r].length;d++)n[r][d]=255&t.buffer[d+i];i+=l;var u=g.getErrorCorrectPolynomial(c),h=new f(n[r],u.getLength()-1).mod(u);s[r]=new Array(u.getLength()-1);for(d=0;d<s[r].length;d++){var p=d+h.getLength()-s[r].length;s[r][d]=p>=0?h.get(p):0}}var m=0;for(d=0;d<e.length;d++)m+=e[d].totalCount;var v=new Array(m),y=0;for(d=0;d<a;d++)for(r=0;r<e.length;r++)d<n[r].length&&(v[y++]=n[r][d]);for(d=0;d<o;d++)for(r=0;r<e.length;r++)d<s[r].length&&(v[y++]=s[r][d]);return v};for(var i={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},o={L:1,M:0,Q:3,H:2},n=0,s=1,r=2,l=3,c=4,d=5,u=6,h=7,g={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;g.getBCHDigit(e)-g.getBCHDigit(g.G15)>=0;)e^=g.G15<<g.getBCHDigit(e)-g.getBCHDigit(g.G15);return(t<<10|e)^g.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;g.getBCHDigit(e)-g.getBCHDigit(g.G18)>=0;)e^=g.G18<<g.getBCHDigit(e)-g.getBCHDigit(g.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return g.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,i){switch(t){case n:return(e+i)%2==0;case s:return e%2==0;case r:return i%3==0;case l:return(e+i)%3==0;case c:return(Math.floor(e/2)+Math.floor(i/3))%2==0;case d:return e*i%2+e*i%3==0;case u:return(e*i%2+e*i%3)%2==0;case h:return(e*i%3+(e+i)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new f([1],0),i=0;i<t;i++)e=e.multiply(new f([1,p.gexp(i)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case i.MODE_NUMBER:return 10;case i.MODE_ALPHA_NUM:return 9;case i.MODE_8BIT_BYTE:case i.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case i.MODE_NUMBER:return 12;case i.MODE_ALPHA_NUM:return 11;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case i.MODE_NUMBER:return 14;case i.MODE_ALPHA_NUM:return 13;case i.MODE_8BIT_BYTE:return 16;case i.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),i=0,a=0;a<e;a++)for(var o=0;o<e;o++){for(var n=0,s=t.isDark(a,o),r=-1;r<=1;r++)if(!(a+r<0||e<=a+r))for(var l=-1;l<=1;l++)o+l<0||e<=o+l||0==r&&0==l||s==t.isDark(a+r,o+l)&&n++;n>5&&(i+=3+n-5)}for(a=0;a<e-1;a++)for(o=0;o<e-1;o++){var c=0;t.isDark(a,o)&&c++,t.isDark(a+1,o)&&c++,t.isDark(a,o+1)&&c++,t.isDark(a+1,o+1)&&c++,0!=c&&4!=c||(i+=3)}for(a=0;a<e;a++)for(o=0;o<e-6;o++)t.isDark(a,o)&&!t.isDark(a,o+1)&&t.isDark(a,o+2)&&t.isDark(a,o+3)&&t.isDark(a,o+4)&&!t.isDark(a,o+5)&&t.isDark(a,o+6)&&(i+=40);for(o=0;o<e;o++)for(a=0;a<e-6;a++)t.isDark(a,o)&&!t.isDark(a+1,o)&&t.isDark(a+2,o)&&t.isDark(a+3,o)&&t.isDark(a+4,o)&&!t.isDark(a+5,o)&&t.isDark(a+6,o)&&(i+=40);var d=0;for(o=0;o<e;o++)for(a=0;a<e;a++)t.isDark(a,o)&&d++;return i+=10*(Math.abs(100*d/e/e-50)/5)}},p={glog:function(t){if(t<1)throw new Error("glog("+t+")");return p.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return p.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},m=0;m<8;m++)p.EXP_TABLE[m]=1<<m;for(m=8;m<256;m++)p.EXP_TABLE[m]=p.EXP_TABLE[m-4]^p.EXP_TABLE[m-5]^p.EXP_TABLE[m-6]^p.EXP_TABLE[m-8];for(m=0;m<255;m++)p.LOG_TABLE[p.EXP_TABLE[m]]=m;function f(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var a=0;a<t.length-i;a++)this.num[a]=t[a+i]}function v(t,e){this.totalCount=t,this.dataCount=e}function y(){this.buffer=[],this.length=0}f.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),i=0;i<this.getLength();i++)for(var a=0;a<t.getLength();a++)e[i+a]^=p.gexp(p.glog(this.get(i))+p.glog(t.get(a)));return new f(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=p.glog(this.get(0))-p.glog(t.get(0)),i=new Array(this.getLength()),a=0;a<this.getLength();a++)i[a]=this.get(a);for(a=0;a<t.getLength();a++)i[a]^=p.gexp(p.glog(t.get(a))+e);return new f(i,0).mod(t)}},v.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],v.getRSBlocks=function(t,e){var i=v.getRsBlockTable(t,e);if(void 0==i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var a=i.length/3,o=[],n=0;n<a;n++)for(var s=i[3*n+0],r=i[3*n+1],l=i[3*n+2],c=0;c<s;c++)o.push(new v(r,l));return o},v.getRsBlockTable=function(t,e){switch(e){case o.L:return v.RS_BLOCK_TABLE[4*(t-1)+0];case o.M:return v.RS_BLOCK_TABLE[4*(t-1)+1];case o.Q:return v.RS_BLOCK_TABLE[4*(t-1)+2];case o.H:return v.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},y.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var _=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function C(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var i=e.toString().match(/android ([0-9]\.[0-9])/i);i&&i[1]&&(t=parseFloat(i[1]))}return t}var b=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){var e=this._htOption,i=this._el,a=t.getModuleCount();Math.floor(e.width/a),Math.floor(e.height/a);function o(t,e){var i=document.createElementNS("http://www.w3.org/2000/svg",t);for(var a in e)e.hasOwnProperty(a)&&i.setAttribute(a,e[a]);return i}this.clear();var n=o("svg",{viewBox:"0 0 "+String(a)+" "+String(a),width:"100%",height:"100%",fill:e.colorLight});n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),i.appendChild(n),n.appendChild(o("rect",{fill:e.colorLight,width:"100%",height:"100%"})),n.appendChild(o("rect",{fill:e.colorDark,width:"1",height:"1",id:"template"}));for(var s=0;s<a;s++)for(var r=0;r<a;r++)if(t.isDark(s,r)){var l=o("use",{x:String(r),y:String(s)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),n.appendChild(l)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),w="svg"===document.documentElement.tagName.toLowerCase()?b:"undefined"==typeof CanvasRenderingContext2D?function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,i=this._el,a=t.getModuleCount(),o=Math.floor(e.width/a),n=Math.floor(e.height/a),s=['<table style="border:0;border-collapse:collapse;">'],r=0;r<a;r++){s.push("<tr>");for(var l=0;l<a;l++)s.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+o+"px;height:"+n+"px;background-color:"+(t.isDark(r,l)?e.colorDark:e.colorLight)+';"></td>');s.push("</tr>")}s.push("</table>"),i.innerHTML=s.join("");var c=i.childNodes[0],d=(e.width-c.offsetWidth)/2,u=(e.height-c.offsetHeight)/2;d>0&&u>0&&(c.style.margin=u+"px "+d+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}():function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var e=1/window.devicePixelRatio,i=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,a,o,n,s,r,l,c,d){if("nodeName"in t&&/img/i.test(t.nodeName))for(var u=arguments.length-1;u>=1;u--)arguments[u]=arguments[u]*e;else void 0===c&&(arguments[1]*=e,arguments[2]*=e,arguments[3]*=e,arguments[4]*=e);i.apply(this,arguments)}}var a=function(t,e){this._bIsPainted=!1,this._android=C(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return a.prototype.draw=function(t){var e=this._elImage,i=this._oContext,a=this._htOption,o=t.getModuleCount(),n=a.width/o,s=a.height/o,r=Math.round(n),l=Math.round(s);e.style.display="none",this.clear();for(var c=0;c<o;c++)for(var d=0;d<o;d++){var u=t.isDark(c,d),h=d*n,g=c*s;i.strokeStyle=u?a.colorDark:a.colorLight,i.lineWidth=1,i.fillStyle=u?a.colorDark:a.colorLight,i.fillRect(h,g,n,s),i.strokeRect(Math.floor(h)+.5,Math.floor(g)+.5,r,l),i.strokeRect(Math.ceil(h)-.5,Math.ceil(g)-.5,r,l)}this._bIsPainted=!0},a.prototype.makeImage=function(){this._bIsPainted&&function(t,e){var i=this;if(i._fFail=e,i._fSuccess=t,null===i._bSupportDataURI){var a=document.createElement("img"),o=function(){i._bSupportDataURI=!1,i._fFail&&i._fFail.call(i)};return a.onabort=o,a.onerror=o,a.onload=function(){i._bSupportDataURI=!0,i._fSuccess&&i._fSuccess.call(i)},void(a.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===i._bSupportDataURI&&i._fSuccess?i._fSuccess.call(i):!1===i._bSupportDataURI&&i._fFail&&i._fFail.call(i)}.call(this,t)},a.prototype.isPainted=function(){return this._bIsPainted},a.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},a.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},a}();function I(t,e){for(var i=1,a=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}(t),n=0,s=_.length;n<=s;n++){var r=0;switch(e){case o.L:r=_[n][0];break;case o.M:r=_[n][1];break;case o.Q:r=_[n][2];break;case o.H:r=_[n][3]}if(a<=r)break;i++}if(i>_.length)throw new Error("Too long data");return i}return(a=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:o.H},"string"==typeof e&&(e={text:e}),e)for(var i in e)this._htOption[i]=e[i];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(w=b),this._android=C(),this._el=t,this._oQRCode=null,this._oDrawing=new w(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)}).prototype.makeCode=function(t){this._oQRCode=new e(I(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},a.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},a.prototype.clear=function(){this._oDrawing.clear()},a.CorrectLevel=o,a},t.exports=o()},xLcV:function(t,e){}});