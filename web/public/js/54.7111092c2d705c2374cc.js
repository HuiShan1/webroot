webpackJsonp([54],{GPF4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,l,o=a("WxFH"),i=a.n(o),r=a("C331"),n=a("4Lfr"),c=(s={props:{data:{default:null}},components:{memberDetails:n.default},data:function(){return{cur_page:"tablePage",from_page:"tablePage",columns:[],collegeId:"-1",timeStamp:"",selectList:[],selectModel:"",tableData:[{college:"学院",job:"书记",name:"xxxx",member:5},{college:"学院2",job:"书记2",name:"xxxx2",member:5},{college:"学院3",job:"书记3",name:"xxxx3",member:5}],showTypeModal:!1,consultantTypeData:[{value:"addSingle",label:"单个新增"},{value:"addGroup",label:"批量新增"}],consultantType:"",showSingleModal:!1,singleAdd_form:{partyName:""},userId:"",partyJob:[],partyJob_selected:"",partyLevel_selected:"",college_selected:"",partyCollege:[],partyLevel:[{text:"校级",id:"SCHOOL"},{text:"院级",id:"COLLEGE"}],importPage:!1,importParams:{},curRoute_name:"",tableSearch:{name:"",personInChargeName:"",position:""},organizationId:""}},methods:{getCollege:function(){var e=this;if("hospital"===this.curRoute_name)var t="/api/partyBuild/organizations/manage/college";else t="api/partyBuild/organizations/school/college/options";Object(r.d)({url:t,dataType:"json",type:"get",success:function(t){t.state&&t.data.length&&(e.selectList=t.data)}})},_refreshTable:function(){this.timeStamp=Object(r.a)()},schoolSelect:function(e){this.collegeId=this.selectModel,this._refreshTable()},_selectConsultantType:function(e){this.consultantType=e.value},selectType_cancle:function(){this.consultantType="",this.showTypeModal=!1},userSelected:function(e){this.userId=e.userId},sumbitTypeModal:function(e){var t=this;if(!this.consultantType)return this.$toast("请先选择新增组织类型");this.showTypeModal=!1,"addSingle"===e?(this.showSingleModal=!0,this.partyLevel_selected="",this.singleAdd_form.partyName="",this.partyJob_selected="",this.college_selected="","hospital"===this.curRoute_name&&this.getCollege_hospital(),Object(r.d)({url:"/api/system/dicts?dictType=党支部职务",type:"get",success:function(e){e.state?t.partyJob=e.data:t.$toast(e.message)}})):(this.cur_page="importPage",this.from_page="tablePage",this.importParams={parentPageTitle:"党组织管理",downloadTemplateUrl:"/partyBuild/organizations/excel/template",downloadErrorTemplateUrl:"/partyBuild/organizations/excels/errorExcels",checkTemplateUrl:"school"===this.curRoute_name?"/partyBuild/organizations/excel?rank=SCHOOL&college="+this.collegeId:"/partyBuild/organizations/excel?rank=COLLEGE&college="+this.collegeId,templateName:"批量新增党组织模板",importBtnType:[{name:"覆盖导入",url:"/partyBuild/organizations/import",method:"post",isShowBtn:!0,success:function(e){e.state&&t._refreshTable()}}]})},backToPage_emit:function(){this.cur_page="tablePage"},selectSingle_cancle:function(){this.showSingleModal=!1},getCollege_hospital:function(){var e=this;Object(r.d)({type:"get",url:"/api/partyBuild/organizations/manage/college",success:function(t){t.state&&(t.data.length&&t.data.map(function(e,a){"全部"==e.text&&t.data.splice(a,1)}),e.partyCollege=t.data)}})},afterSelectedLevel:function(e){this.partyLevel_selected=e.value,"COLLEGE"==e.value&&this.getCollege_hospital()},afterSelectedCollege:function(e){this.college_selected=e.value},submitSingle:function(){var e=this;if("hospital"==this.curRoute_name&&(this.partyLevel_selected="COLLEGE"),""==this.partyLevel_selected)return this.$toast("请选择所属级别");if("COLLEGE"===this.partyLevel_selected&&!this.college_selected)return this.$toast("请选择学院");if(!this.singleAdd_form.partyName)return this.$toast("党组织名称不能为空");if(!this.partyJob_selected)return this.$toast("请选择职务");var t={rank:this.partyLevel_selected,name:this.singleAdd_form.partyName,position:this.partyJob_selected,personInCharge:{userId:this.userId}};"COLLEGE"===this.partyLevel_selected&&(t.college=this.college_selected),Object(r.d)({url:"api/partyBuild/organizations",data:t,type:"post",success:function(t){return t.state?(e.showSingleModal=!1,"COLLEGE"==e.partyLevel_selected&&(e.tableData_url="/table-data/partyBuild/organizations/page/collges?college="+e.collegeId+"&timeStamp="+(new Date).getTime()),e._refreshTable(),e.$toast("新增成功！")):e.$toast(t.message)}})},afterSelected:function(e){this.partyJob_selected=e.value},importPageBack:function(){this.importPage=!1,this.cur_page=this.from_page},get_changeCurPage:function(e){this.cur_page=e.cur_page,this.from_page=e.from_page,this.importParams=e,this.importPage=!0},exportStat:function(){var e=this.$refs.liveStaffTable.tableSearchFields;if("school"===this.curRoute_name)var t="/downloads/partyBuild/organizations/school/export?college="+this.collegeId+"&personInChargeName="+e.personInChargeName+"&position="+e.position+"&name="+e.name;else t="/downloads/partyBuild/organizations/college/export";window.location.href=t}},watch:{},computed:{tableData_url:function(){return"school"===this.curRoute_name?"/table-data/partyBuild/organizations/page/school?college="+this.collegeId+"&timeStamp="+this.timeStamp:"/table-data/partyBuild/organizations/page/collges?college="+this.collegeId+"&timeStamp="+this.timeStamp}}},i()(s,"components",{memberDetails:n.default}),i()(s,"created",function(){var e=this;"校级党组织管理"===this.data.title?(this.curRoute_name="school",this.partyLevel=[{text:"校级",id:"SCHOOL"},{text:"院级",id:"COLLEGE"}]):(this.curRoute_name="hospital",this.partyLevel=[{text:"院级",id:"COLLEGE"}],Object(r.d)({type:"get",url:"/api/colleges",success:function(t){t.state&&(e.partyCollege=t.data)}})),this._refreshTable(),this.columns=[{id:"name",title:"组织名称",className:"text-left",width:130,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!1}}},{id:"position",title:"党支部职位",className:"text-left",width:150,hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=党支部职务",optionsLabel:"label",optionsValue:"value",autoFocus:!1}}},{id:"personInChargeName",title:"负责人姓名",width:150,className:"text-left",hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!1}},formatter:function(e){if(!e.personInCharge)return"";var t="";return(t+="<span title="+e.personInCharge.userNo+">"+e.personInCharge.name+"</span>").substring(0,t.length-1)}},{id:"userCount",title:"组织成员数",className:"text-left",hidden:!1,width:130,formatter:function(e){return e.member}},{id:"opt",className:"text-left",title:"操作",width:50,hidden:!1,formatter:function(){return[{tag:"a",text:"党组织成员",className:"opt-btn",callback:function(t,a){e.organizationId=t.id,e.cur_page="memberDetails"}},{tag:"a",text:"删除",className:"opt-btn",callback:function(t,a){if(window.confirm("确定删除吗？")){var s="api/partyBuild/organizations/"+t.id;Object(r.d)({type:"delete",url:s,success:function(t){t.state?(e._refreshTable(),e.$toast("删除成功")):e.$toast(t.message)}})}}}]}}]}),i()(s,"mounted",function(){this.getCollege()}),l={props:{data:{default:null}},components:{memberDetails:n.default},data:function(){return{cur_page:"tablePage",from_page:"tablePage",columns:[],collegeId:"-1",timeStamp:"",selectList:[],selectModel:"",tableData:[{college:"学院",job:"书记",name:"xxxx",member:5},{college:"学院2",job:"书记2",name:"xxxx2",member:5},{college:"学院3",job:"书记3",name:"xxxx3",member:5}],showTypeModal:!1,consultantTypeData:[{value:"addSingle",label:"单个新增"},{value:"addGroup",label:"批量新增"}],consultantType:"",showSingleModal:!1,singleAdd_form:{partyName:""},userId:"",partyJob:[],partyJob_selected:"",partyLevel_selected:"",college_selected:"",partyCollege:[],partyLevel:[{text:"校级",id:"SCHOOL"},{text:"院级",id:"COLLEGE"}],importPage:!1,importParams:{},curRoute_name:"",tableSearch:{name:"",personInChargeName:"",position:""},organizationId:""}},methods:{getCollege:function(){var e=this;if("hospital"===this.curRoute_name)var t="/api/partyBuild/organizations/manage/college";else t="api/partyBuild/organizations/school/college/options";Object(r.d)({url:t,dataType:"json",type:"get",success:function(t){t.state&&t.data.length&&(e.selectList=t.data)}})},_refreshTable:function(){this.timeStamp=Object(r.a)()},schoolSelect:function(e){this.collegeId=this.selectModel,this._refreshTable()},_selectConsultantType:function(e){this.consultantType=e.value},selectType_cancle:function(){this.consultantType="",this.showTypeModal=!1},userSelected:function(e){this.userId=e.userId},sumbitTypeModal:function(e){var t=this;if(!this.consultantType)return this.$toast("请先选择新增组织类型");this.showTypeModal=!1,"addSingle"===e?(this.showSingleModal=!0,this.partyLevel_selected="",this.singleAdd_form.partyName="",this.partyJob_selected="",this.college_selected="","hospital"===this.curRoute_name&&this.getCollege_hospital(),Object(r.d)({url:"/api/system/dicts?dictType=党支部职务",type:"get",success:function(e){e.state?t.partyJob=e.data:t.$toast(e.message)}})):(this.cur_page="importPage",this.from_page="tablePage",this.importParams={parentPageTitle:"党组织管理",downloadTemplateUrl:"/partyBuild/organizations/excel/template",downloadErrorTemplateUrl:"/partyBuild/organizations/excels/errorExcels",checkTemplateUrl:"school"===this.curRoute_name?"/partyBuild/organizations/excel?rank=SCHOOL&college="+this.collegeId:"/partyBuild/organizations/excel?rank=COLLEGE&college="+this.collegeId,templateName:"批量新增党组织模板",importBtnType:[{name:"覆盖导入",url:"/partyBuild/organizations/import",method:"post",isShowBtn:!0,success:function(e){e.state&&t._refreshTable()}}]})},backToPage_emit:function(){this.cur_page="tablePage"},selectSingle_cancle:function(){this.showSingleModal=!1},getCollege_hospital:function(){var e=this;Object(r.d)({type:"get",url:"/api/partyBuild/organizations/manage/college",success:function(t){t.state&&(t.data.length&&t.data.map(function(e,a){"全部"==e.text&&t.data.splice(a,1)}),e.partyCollege=t.data)}})},afterSelectedLevel:function(e){this.partyLevel_selected=e.value,"COLLEGE"==e.value&&this.getCollege_hospital()},afterSelectedCollege:function(e){this.college_selected=e.value},submitSingle:function(){var e=this;if("hospital"==this.curRoute_name&&(this.partyLevel_selected="COLLEGE"),""==this.partyLevel_selected)return this.$toast("请选择所属级别");if("COLLEGE"===this.partyLevel_selected&&!this.college_selected)return this.$toast("请选择学院");if(!this.singleAdd_form.partyName)return this.$toast("党组织名称不能为空");if(!this.partyJob_selected)return this.$toast("请选择职务");var t={rank:this.partyLevel_selected,name:this.singleAdd_form.partyName,position:this.partyJob_selected,personInCharge:{userId:this.userId}};"COLLEGE"===this.partyLevel_selected&&(t.college=this.college_selected),Object(r.d)({url:"api/partyBuild/organizations",data:t,type:"post",success:function(t){return t.state?(e.showSingleModal=!1,"COLLEGE"==e.partyLevel_selected&&(e.tableData_url="/table-data/partyBuild/organizations/page/collges?college="+e.collegeId+"&timeStamp="+(new Date).getTime()),e._refreshTable(),e.$toast("新增成功！")):e.$toast(t.message)}})},afterSelected:function(e){this.partyJob_selected=e.value},importPageBack:function(){this.importPage=!1,this.cur_page=this.from_page},get_changeCurPage:function(e){this.cur_page=e.cur_page,this.from_page=e.from_page,this.importParams=e,this.importPage=!0},exportStat:function(){var e=this.$refs.liveStaffTable.tableSearchFields;if("school"===this.curRoute_name)var t="/downloads/partyBuild/organizations/school/export?college="+this.collegeId+"&personInChargeName="+e.personInChargeName+"&position="+e.position+"&name="+e.name;else t="/downloads/partyBuild/organizations/college/export";window.location.href=t}},watch:{},computed:{tableData_url:function(){return"school"===this.curRoute_name?"/table-data/partyBuild/organizations/page/school?college="+this.collegeId+"&timeStamp="+this.timeStamp:"/table-data/partyBuild/organizations/page/collges?college="+this.collegeId+"&timeStamp="+this.timeStamp}}},i()(l,"components",{memberDetails:n.default}),i()(l,"created",function(){var e=this;"校级党组织管理"===this.data.title?(this.curRoute_name="school",this.partyLevel=[{text:"校级",id:"SCHOOL"},{text:"院级",id:"COLLEGE"}]):(this.curRoute_name="hospital",this.partyLevel=[{text:"院级",id:"COLLEGE"}],Object(r.d)({type:"get",url:"/api/colleges",success:function(t){t.state&&(e.partyCollege=t.data)}})),this._refreshTable(),this.columns=[{id:"name",title:"组织名称",className:"text-left",width:130,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!1}}},{id:"position",title:"党支部职位",className:"text-left",width:150,hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=党支部职务",optionsLabel:"label",optionsValue:"value",autoFocus:!1}}},{id:"personInChargeName",title:"负责人姓名",width:150,className:"text-left",hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!1}},formatter:function(e){if(!e.personInCharge)return"";var t="";return(t+="<span title="+e.personInCharge.userNo+">"+e.personInCharge.name+"</span>").substring(0,t.length-1)}},{id:"userCount",title:"组织成员数",className:"text-left",hidden:!1,width:130,formatter:function(e){return e.member}},{id:"opt",className:"text-left",title:"操作",width:50,hidden:!1,formatter:function(){return[{tag:"a",text:"党组织成员",className:"opt-btn",callback:function(t,a){e.organizationId=t.id,e.cur_page="memberDetails"}},{tag:"a",text:"删除",className:"opt-btn",callback:function(t,a){if(window.confirm("确定删除吗？")){var s="api/partyBuild/organizations/"+t.id;Object(r.d)({type:"delete",url:s,success:function(t){t.state?(e._refreshTable(),e.$toast("删除成功")):e.$toast(t.message)}})}}}]}}]}),i()(l,"mounted",function(){this.getCollege()}),l),d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid",attrs:{id:"party-building-manage"}},[a("v-table",{directives:[{name:"show",rawName:"v-show",value:"tablePage"===e.cur_page,expression:"cur_page === 'tablePage'"}],key:1,ref:"liveStaffTable",attrs:{columns:e.columns,url:""+e.tableData_url,search:!1,idField:"id",pagesize:"15",order:"true",searchParams:e.tableSearch}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("v-select",{attrs:{options:e.selectList,optionsLabel:"text",optionsValue:"id"},on:{afterSelected:function(t){return e.schoolSelect(t)}},model:{value:e.selectModel,callback:function(t){e.selectModel=t},expression:"selectModel"}})],1),e._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showTypeModal=!0}}},[e._v("新增组织")]),e._v(" "),a("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:e.exportStat}},[e._v("导出")])])])]),e._v(" "),"importPage"===e.cur_page?a("v-import",e._b({on:{backParentPage:e.importPageBack}},"v-import",e.importParams,!1)):e._e(),e._v(" "),"memberDetails"==e.cur_page?a("member-details",{attrs:{organizationId:e.organizationId,cur_page:e.cur_page},on:{backToPage:e.backToPage_emit,emit_changeCurPage:e.get_changeCurPage}}):e._e(),e._v(" "),a("v-modal",{attrs:{show:e.showTypeModal,effect:"fade",width:"400"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v("\n          选择新增方式\n      ")])]),e._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-options"},e._l(e.consultantTypeData,function(t,s){return a("span",{key:s,on:{click:function(a){return e._selectConsultantType(t)}}},[a("i",{staticClass:"maticon",domProps:{innerHTML:e._s(e.icons(e.consultantType===t.value?"radio_button_checked":"radio_button_unchecked"))}}),e._v(e._s(t.label)+"\n          ")])}),0)])]),e._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.selectType_cancle}},[e._v("取消")]),e._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.sumbitTypeModal(e.consultantType)}}},[e._v("确定")])])]),e._v(" "),a("v-modal",{attrs:{show:e.showSingleModal,effect:"fade",width:"400"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v("\n          单个新增\n      ")])]),e._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e.showSingleModal?a("div",{staticClass:"party_search"},[a("detect",{attrs:{url:"api/users/check/searchResults",placeholder:"请输入学号/姓名",id:"searchPartyName"},on:{afterSelected:e.userSelected}})],1):e._e(),e._v(" "),a("div",{staticClass:"modal-select"},[a("label",{staticClass:"partyName",staticStyle:{minWidth:"70px"},attrs:{for:"singleAdd_select"}},[e._v("所属级别")]),e._v(" "),a("v-select",{directives:[{name:"show",rawName:"v-show",value:"school"==e.curRoute_name,expression:"curRoute_name == 'school'"}],attrs:{value:e.partyLevel_selected,options:e.partyLevel,optionsLabel:"text",optionsValue:"id"},on:{afterSelected:function(t){return e.afterSelectedLevel(t)}}}),e._v(" "),a("input",{directives:[{name:"show",rawName:"v-show",value:"hospital"==e.curRoute_name,expression:"curRoute_name == 'hospital'"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:"",id:"partyName",value:"院级"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"hospital"==e.curRoute_name||"COLLEGE"===e.partyLevel_selected,expression:"curRoute_name == 'hospital'|| partyLevel_selected === 'COLLEGE'"}],staticClass:"modal-select"},[a("label",{staticClass:"partyName",staticStyle:{minWidth:"70px"},attrs:{for:"singleAdd_select"}},[e._v("学院")]),e._v(" "),a("v-select",{attrs:{value:e.college_selected,options:e.partyCollege,optionsLabel:"text",optionsValue:"id"},on:{afterSelected:function(t){return e.afterSelectedCollege(t)}}})],1),e._v(" "),a("div",{staticClass:"modal-search-user "},[a("label",{staticClass:"partyName",attrs:{for:"partyName"}},[e._v("党组织名称")]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.singleAdd_form.partyName,expression:"singleAdd_form.partyName"}],staticClass:"form-control form-input",attrs:{type:"text",placeholder:"党组织名称",id:"partyName"},domProps:{value:e.singleAdd_form.partyName},on:{input:function(t){t.target.composing||e.$set(e.singleAdd_form,"partyName",t.target.value)}}})]),e._v(" "),a("div",{staticClass:"modal-select"},[a("label",{staticClass:"partyName",attrs:{for:"singleAdd_select"}},[e._v("党支部书记")]),e._v(" "),a("v-select",{attrs:{value:e.partyJob_selected,options:e.partyJob,optionsLabel:"label",optionsValue:"value"},on:{afterSelected:function(t){return e.afterSelected(t)}}})],1)]),e._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.selectSingle_cancle}},[e._v("取消")]),e._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.submitSingle}},[e._v("确定")])])])],1)},staticRenderFns:[]};var p=a("Mz/3")(c,d,!1,function(e){a("SC8E"),a("klUg")},"data-v-14640dfe",null);t.default=p.exports},SC8E:function(e,t){},klUg:function(e,t){}});