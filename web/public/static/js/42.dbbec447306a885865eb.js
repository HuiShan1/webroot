webpackJsonp([42],{CXcY:function(e,t){},FnsV:function(e,t){},"T+hZ":function(e,t){},dpRq:function(e,t){},nLRR:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),c=a.n(i),l=a("C331"),s={props:["curPlaceId"],data:function(){return{isEdit:!1,errMsg:!1,curPlaceInfo:{},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},placeInfo:{name:"",peopleNum:"",description:"",time:"",timeRangeObj:[]},placeInfo_rule:{name:[{required:!0,message:"请输入场地名称"}]},startTime:"",endTime:""}},methods:{changEdit:function(){var e=this;this.isEdit=!this.isEdit,this.placeInfo={name:this.curPlaceInfo.name,peopleNum:this.curPlaceInfo.peopleNum,description:this.curPlaceInfo.description,timeRangeObj:[]},this.$nextTick(function(){e.$refs.placeInfo.clearValidate()})},getIntroduction:function(e){this.placeInfo.description=e},timeRangeChange:function(e){},dateChange:function(e){},addTimeRange:function(){this.placeInfo.timeRangeObj.push({year:"",timeRange:""})},deteleRange:function(e){this.placeInfo.timeRangeObj.splice(e,1)},deteleRange_data:function(e){var t=this,a="/api/employment/area/deleteUseTimeById?id="+e;Object(l.e)({url:a,type:"DELETE",success:function(e){e.state?(t.getPlaceInfo(),t.$message.success("删除成功")):t.message.error(e.message)}})},placeSubmit:function(){var e=this;this.$refs.placeInfo.validate(function(t){if(t){var a=e.placeInfo.timeRangeObj,i=[],s=!0,n="",r="",o="";if(""==e.curPlaceId){if(!a.length)return e.$message.error("请添加时段")}else if(!a.length&&!e.curPlaceInfo.freeTime.length)return e.$message.error("请添加时段");if(a.map(function(t){for(var a in t)if(!t[a])return s=!1,e.$message.error("请选择可用时间段")}),!s)return;if(a.length){var d=!0,u=!1,p=void 0;try{for(var f,m=c()(a);!(d=(f=m.next()).done);d=!0){var v=f.value;i.push({beginTime:v.year+" "+v.timeRange[0]+":00",endTime:v.year+" "+v.timeRange[1]+":00"})}}catch(e){u=!0,p=e}finally{try{!d&&m.return&&m.return()}finally{if(u)throw p}}}if(e.curPlaceId){n="/api/employment/area/updateArea",r="put",o="修改场地信息成功";var h=e.curPlaceInfo.freeTime;if(h.length){var _=!0,g=!1,y=void 0;try{for(var I,b=c()(h);!(_=(I=b.next()).done);_=!0){var P=I.value;i.push({id:P.id,beginTime:P.date+" "+P.startTime,endTime:P.date+" "+P.endTime,status:P.status})}}catch(e){g=!0,y=e}finally{try{!_&&b.return&&b.return()}finally{if(g)throw y}}}}else n="/api/employment/area/addArea",r="post",o="新增场地成功";var T={id:e.curPlaceId,name:e.placeInfo.name,peopleNum:e.placeInfo.peopleNum,description:e.placeInfo.description,areaUseVOList:i};Object(l.e)({url:n,type:r,data:T,success:function(t){t.state?(e.placeInfo.timeRangeObj=[],e.$message.success(o),e.curPlaceId?e.getPlaceInfo():e.$emit("getError")):e.$message.error(t.message)}})}})},getPlaceInfo:function(){var e=this;if(this.curPlaceId){var t="/api/employment/area/getArea?id="+this.curPlaceId;Object(l.e)({url:t,type:"get",success:function(t){if(t.state){if(e.curPlaceInfo=t.data,e.curPlaceInfo.freeTime=[],e.curPlaceInfo.areaUseVOList.length){var a=!0,i=!1,l=void 0;try{for(var s,n=c()(e.curPlaceInfo.areaUseVOList);!(a=(s=n.next()).done);a=!0){var r=s.value,o=r.beginTime.split(" ")[0],d=r.beginTime.split(" ")[1],u=r.endTime.split(" ")[1],p=r.id,f=r.status;e.curPlaceInfo.freeTime.push({date:o,startTime:d,endTime:u,id:p,status:f})}}catch(e){i=!0,l=e}finally{try{!a&&n.return&&n.return()}finally{if(i)throw l}}}}else e.$emit("getError","获取场地信息失败,请重试")}})}else this.isEdit=!0},cancleEdit:function(){var e=this;this.$nextTick(function(){e.$refs.placeInfo.clearValidate(),e.isEdit=!1}),this.curPlaceId||this.$emit("getError")}},mounted:function(){this.getPlaceInfo()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"placeDeatils"}},[a("div",{staticClass:"title clearfix"},[a("h1",[e._m(0),a("a",{directives:[{name:"show",rawName:"v-show",value:e.curPlaceId,expression:"curPlaceId"}],on:{click:e.changEdit}},[a("i"),a("em",[e._v("编辑")])])])]),e._v(" "),a("div",{staticClass:"placeInfo"},[a("el-form",{ref:"placeInfo",attrs:{model:e.placeInfo,rules:e.placeInfo_rule,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"场地名称：",prop:"name"}},[e.isEdit?a("el-input",{staticStyle:{width:"280px"},model:{value:e.placeInfo.name,callback:function(t){e.$set(e.placeInfo,"name",t)},expression:"placeInfo.name"}}):a("span",{staticClass:"input_disabled"},[e._v(e._s(e.curPlaceInfo.name))])],1),e._v(" "),a("el-form-item",{attrs:{label:"可容纳人数："}},[e.isEdit?e._t("default",[a("el-input",{staticStyle:{width:"280px"},attrs:{type:"number"},model:{value:e.placeInfo.peopleNum,callback:function(t){e.$set(e.placeInfo,"peopleNum",t)},expression:"placeInfo.peopleNum"}}),a("i",[e._v("人")])]):a("span",{staticClass:"input_disabled"},[e._v(e._s(e.curPlaceInfo.peopleNum||0)+"人")])],2),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"场地说明："}},[e.isEdit?a("u-editor",{ref:"description",staticStyle:{"padding-left":"40px"},on:{change:e.getIntroduction},model:{value:e.placeInfo.description,callback:function(t){e.$set(e.placeInfo,"description",t)},expression:"placeInfo.description"}}):a("span",{staticClass:"input_disabled",domProps:{innerHTML:e._s(e.curPlaceInfo.description)}})],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("em",{staticStyle:{color:"#d25050"}},[e._v("*")]),e._v("可用时间：")]),e._v(" "),e.isEdit?a("a",{staticClass:"addRange",on:{click:e.addTimeRange}},[e._v("添加时段")]):e._e(),e._v(" "),e._l(e.placeInfo.timeRangeObj,function(t,i){return e.isEdit?a("div",{staticClass:"dateBox"},[a("el-date-picker",{attrs:{"picker-options":e.pickerOptions,format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:t.year,callback:function(a){e.$set(t,"year",a)},expression:"item.year"}}),e._v(" "),a("el-time-picker",{attrs:{"is-range":"","value-format":"HH:mm",format:"HH:mm","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},on:{change:e.timeRangeChange},model:{value:t.timeRange,callback:function(a){e.$set(t,"timeRange",a)},expression:"item.timeRange"}}),e._v(" "),a("span",{staticClass:"delete",on:{click:function(t){return e.deteleRange(i)}}},[a("i")])],1):e._e()}),e._v(" "),a("div",{staticClass:"freeTime"},[a("ul",{class:{isEdit:e.isEdit}},e._l(e.curPlaceInfo.freeTime,function(t){return a("li",{class:{isEdit:e.isEdit},attrs:{id:t.id}},[a("span",[e._v(e._s(t.date))]),e._v(" "),a("i",[e._v(e._s(t.startTime+" ~ "+t.endTime))]),e._v(" "),"FREE"==t.status?a("em",{staticClass:"delete deteleRange_data",on:{click:function(a){return e.deteleRange_data(t.id)}}},[a("i")]):e._e()])}),0)])],2)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEdit,expression:"isEdit"}],staticClass:"formBtn"},[a("a",{staticClass:"cancle",on:{click:e.cancleEdit}},[e._v("取消")]),e._v(" "),a("a",{staticClass:"add",domProps:{innerHTML:e._s(e.curPlaceId?"保存":"添加")},on:{click:e.placeSubmit}})])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("em"),t("i",[this._v("场地基本信息")])])}]};var r=a("VU/8")(s,n,!1,function(e){a("dpRq"),a("T+hZ")},"data-v-1a003a85",null).exports,o={data:function(){return{tableDataUrl:"/table-data/employment/area/getAreaList",activeName:"first",choicePlaceType_meeting:"",choicePlaceType_face:"",concatBySelf_meeting:!1,concatBySelf_face:!1,showDetails:!1,curPlaceId:"",columns:[],placeRules:[]}},components:{placeDetails:r},methods:{addPlace:function(){this.showDetails=!0,this.curPlaceId=""},getError:function(e){this.showDetails=!1,e&&this.$message.error(e)},addRules:function(){var e=this,t={areaRuleVOList:[]};t.areaRuleVOList.push({allocationScheme:this.choicePlaceType_meeting,isAllow:this.concatBySelf_meeting?1:0,type:"PREACH_MEETING"},{allocationScheme:this.choicePlaceType_face,isAllow:this.concatBySelf_face?1:0,type:"EXAMINATION"});Object(l.e)({url:"/api/employment/area/addAreaRules",type:"POST",data:t,success:function(t){t.state&&(e.getPlaceRules(),e.$message.success("保存成功"))}})},getPlaceRules:function(){var e=this;Object(l.e)({url:"/api/employment/area/getAreaRuleList",type:"get",success:function(t){t.state?(e.placeRules=t.data,2==e.placeRules.length&&(e.choicePlaceType_meeting=t.data[0].allocationScheme,e.concatBySelf_meeting=1==t.data[0].isAllow,e.choicePlaceType_face=t.data[1].allocationScheme,e.concatBySelf_face=1==t.data[1].isAllow)):e.placeRules=[]}})}},created:function(){var e=this;this.getPlaceRules(),this.columns=[{id:"name",title:"场地名称",className:"text-left",width:200,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!1}}},{id:"opts",title:"操作",width:200,hidden:!1,options:[{tag:"a",text:"查看",callback:function(t,a){e.curPlaceId=t.id,e.showDetails=!0}}]}]}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"placeList"}},[e.showDetails?a("el-button",{staticStyle:{color:"#666"},attrs:{type:"text",icon:"el-icon-back"},on:{click:function(t){e.showDetails=!1}}},[e._v("返回")]):e._e(),e._v(" "),e.showDetails?a("place-details",{attrs:{curPlaceId:e.curPlaceId},on:{getError:e.getError}}):e._e(),e._v(" "),e.showDetails?e._e():a("div",{staticClass:"tabPane"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"场地列表",name:"first"}},[a("v-table",{attrs:{url:e.tableDataUrl,columns:e.columns,idField:"id",pagesize:"10",multiple:!1,order:!0}},[a("div",{staticClass:"pull-right",attrs:{slot:"btn-group"},slot:"btn-group"},[a("el-button",{staticClass:"custom-btn",attrs:{type:"primary"},on:{click:e.addPlace}},[e._v("新增场地")])],1)])],1),e._v(" "),a("el-tab-pane",{attrs:{label:"场地分配",name:"second"}},[a("div",{staticClass:"meetingList"},[a("div",{staticClass:"meetingOne"},[a("h1",{staticClass:"title"},[a("span",[a("em"),a("i",[e._v("宣讲会")])])]),e._v(" "),a("div",{staticClass:"type box"},[a("p",[e._v("分配方式：")]),e._v(" "),a("div",{staticClass:"radioGroup"},[a("el-radio-group",{model:{value:e.choicePlaceType_meeting,callback:function(t){e.choicePlaceType_meeting=t},expression:"choicePlaceType_meeting"}},[a("el-radio",{attrs:{label:"COMPANY_CHOOSE"}},[e._v("管理员提供场地信息，单位选择")]),e._v(" "),a("el-radio",{attrs:{label:"ADMIN_ASSIGNMENT"}},[e._v("管理员不提供场地信息，审核时直接分配")])],1),e._v(" "),a("h2",[a("el-checkbox",{model:{value:e.concatBySelf_meeting,callback:function(t){e.concatBySelf_meeting=t},expression:"concatBySelf_meeting"}},[e._v("允许单位自行联系场地")])],1)],1)])]),e._v(" "),a("div",{staticClass:"meetingTwo"},[a("h1",{staticClass:"title"},[a("span",[a("em"),a("i",[e._v("笔/面试")])])]),e._v(" "),a("div",{staticClass:"type box"},[a("p",[e._v("分配方式：")]),e._v(" "),a("div",{staticClass:"radioGroup"},[a("el-radio-group",{model:{value:e.choicePlaceType_face,callback:function(t){e.choicePlaceType_face=t},expression:"choicePlaceType_face"}},[a("el-radio",{attrs:{label:"COMPANY_CHOOSE"}},[e._v("管理员提供场地信息，单位选择")]),e._v(" "),a("el-radio",{attrs:{label:"ADMIN_ASSIGNMENT"}},[e._v("管理员不提供场地信息，审核时直接分配")])],1),e._v(" "),a("h2",[a("el-checkbox",{model:{value:e.concatBySelf_face,callback:function(t){e.concatBySelf_face=t},expression:"concatBySelf_face"}},[e._v("允许单位自行联系场地")])],1)],1)])])]),e._v(" "),a("div",{staticClass:"formBtn"},[a("a",{staticClass:"cancle",on:{click:function(t){return e.getPlaceRules()}}},[e._v("取消")]),e._v(" "),a("a",{staticClass:"add",on:{click:e.addRules}},[e._v("保存")])])])],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(o,d,!1,function(e){a("FnsV"),a("CXcY")},"data-v-1fc7b795",null);t.default=u.exports}});