webpackJsonp([47],{DmHF:function(t,e,a){"use strict";a("wHoj"),a("NGAA");var n=a("INlO"),i=a.n(n),s=a("lC5x"),r=a.n(s),o=a("J0Oq"),u=a.n(o),c=a("IwLe"),l=a("VDkK"),d=a("hn+R"),p=a("713C"),f=a("V/it"),m=a("B/WJ"),y=a("2IYH"),v=a("Se9A"),h=(Boolean,Boolean,Object,y.a,v.a,{props:{inline:Boolean,edit:Boolean,rules:{type:Object,default:{}}},mixins:[y.a],components:{ModuleContainer:v.a}}),w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("module-container",{attrs:{title:"备注",inline:t.inline}},[t.edit?a("el-input",{attrs:{type:"textarea",autosize:{minRows:3}},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}):a("p",[t._v(t._s(t.form))])],1)},staticRenderFns:[]},A=a("C7Lr")(h,w,!1,null,null,null).exports,I=a("N9Ox"),b=a("fSJ2"),g=(a("p+qa"),a("t7Ya")),_=a("mrGO"),T=(Number,Number,String,Number,Boolean,Boolean,v.a,I.a,c.a,l.a,d.a,p.a,f.a,m.a,{props:{unitApplyInfoId:Number,id:Number,dcwName:String,auditStatus:Number,isUnit:Boolean,isManager:Boolean},components:{ModuleContainer:v.a,ModuleLoader:I.a,BaseInfo:c.a,StandInfo:l.a,StandPicker:d.a,UnitInfo:p.a,PositionsInfo:f.a,RecruitmentInfo:m.a,RemarkInfo:A},data:function(){return{UnitApplyAuditStatus:_.a,loading:!0,dcw:null,unitApplyInfo:null,standsInitialized:!1,stands:[],rules:{name:{hidden:!0},applyTime:{hidden:!0}},dict:{positionType:{}}}},computed:{auditStatusLabel:function(){return _.b[this.auditStatus]},auditStatusLabelType:function(){var t="";switch(this.auditStatus){case _.a.AUDITING:t="warning";break;case _.a.PASSED:t="success";break;case _.a.FAILED:t="danger";break;case _.a.COUNTERMAND:case _.a.REJECT:t="warning"}return t},canEditApplyInfo:function(){return this.isManager?this.auditStatus===_.a.AUDITING:!!this.isUnit&&[_.a.COUNTERMAND,_.a.REJECT].includes(this.auditStatus)},canAuditing:function(){return this.isManager&&this.auditStatus===_.a.AUDITING}},created:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initDcw();case 2:return e.next=4,t.initUnitApplyInfo();case 4:return e.next=6,t.initStands();case 6:t.loading=!1;case 7:case"end":return e.stop()}},e,t)}))()},methods:{initDcw:function(){var t=this;return u()(r.a.mark(function e(){var a,n,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.get(t.id);case 2:a=e.sent,n=a.state,i=a.message,s=a.data,n?t.dcw=g.a.fromApi(s):t.$toast(i);case 7:case"end":return e.stop()}},e,t)}))()},initUnitApplyInfo:function(){var t=this;return u()(r.a.mark(function e(){var a,n,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.getUnitApplyInfo(t.unitApplyInfoId);case 2:a=e.sent,n=a.state,i=a.message,s=a.data,n?t.unitApplyInfo=g.d.fromApi(s,t.dict):t.$toast(i);case 7:case"end":return e.stop()}},e,t)}))()},initStands:function(){var t=this;return u()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.unitApplyInfo.stands.map(function(t){return t.id}),t.stands=t.dcw.standInfo.stands.map(function(t){var e=new g.b(t);return a.includes(t.id)&&(e.selected=!0,e.occupied=!1),e}),t.standsInitialized=!0;case 3:case"end":return e.stop()}},e,t)}))()},backToList:function(){this.$emit("back-to-list")},submitApply:function(){var t=this;return u()(r.a.mark(function e(){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.apply(t.dcw.id,t.unitApplyInfo);case 2:a=e.sent,n=a.state,i=a.message,a.data,n?t.$toast("提交成功"):t.$toast(i);case 7:case"end":return e.stop()}},e,t)}))()},resubmitApply:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},e,t)}))()},countermandApply:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.a.confirm("确认撤回申请?").then(u()(r.a.mark(function e(){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.countermand(t.unitApplyInfo.id);case 2:a=e.sent,n=a.state,i=a.message,a.data,n?(t.auditStatus=_.a.COUNTERMAND,t.$toast("撤回成功")):t.$toast(i);case 7:case"end":return e.stop()}},e,t)})));case 1:case"end":return e.stop()}},e,t)}))()},rejectApply:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.a.prompt("请填写驳回意见","驳回").then(function(){var e=u()(r.a.mark(function e(a){var n,i,s,o=a.value;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.reject(t.unitApplyInfo.id,o);case 2:n=e.sent,i=n.state,s=n.message,n.data,i?t.auditStatus=_.a.REJECT:t.$toast(s);case 7:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,t)}))()},disagreeApply:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.a.prompt("请填写不通过意见","不通过").then(function(){var e=u()(r.a.mark(function e(a){var n,i,s,o=a.value;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.disagree(t.unitApplyInfo.id,o);case 2:n=e.sent,i=n.state,s=n.message,n.data,i?t.auditStatus=_.a.FAILED:t.$toast(s);case 7:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}},e,t)}))()},agreeApply:function(){var t=this;return u()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i.a.confirm("确认同意该申请?").then(u()(r.a.mark(function e(){var a,n,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.dcw.agree(t.unitApplyInfo.id);case 2:a=e.sent,n=a.state,i=a.message,a.data,n?t.auditStatus=_.a.PASSED:t.$toast(i);case 7:case"end":return e.stop()}},e,t)})));case 1:case"end":return e.stop()}},e,t)}))()}}}),S={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"back",on:{click:t.backToList}},[a("i",{staticClass:"el-icon-back"}),t._v("返回\n  ")]),t._v(" "),a("div",{staticClass:"page-title-status"},[a("p",[a("span",{staticClass:"title"},[t._v("审核状态：")]),a("el-tag",{attrs:{type:t.auditStatusLabelType,effect:"dark"}},[t._v(t._s(t.auditStatusLabel))])],1),t._v(" "),a("p",[a("span",{staticClass:"title"},[t._v("双选会名称：")]),a("span",[t._v(t._s(t.dcwName))])]),t._v(" "),a("p",[a("span",{staticClass:"title"},[t._v("双选会时间：")]),a("span",[t._v(t._s(t.dcw?t.dcw.getApplyTimeHtml():""))])])]),t._v(" "),t.loading?a("module-loader",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]}):a("div",{staticClass:"module-container"},[a("unit-info",{attrs:{dcw:t.dcw,edit:t.canEditApplyInfo},model:{value:t.unitApplyInfo,callback:function(e){t.unitApplyInfo=e},expression:"unitApplyInfo"}}),t._v(" "),a("positions-info",{attrs:{dcw:t.dcw,edit:t.canEditApplyInfo},model:{value:t.unitApplyInfo.positions,callback:function(e){t.$set(t.unitApplyInfo,"positions",e)},expression:"unitApplyInfo.positions"}}),t._v(" "),a("recruitment-info",{attrs:{dcw:t.dcw,edit:t.canEditApplyInfo},model:{value:t.unitApplyInfo.recruitment,callback:function(e){t.$set(t.unitApplyInfo,"recruitment",e)},expression:"unitApplyInfo.recruitment"}}),t._v(" "),a("stand-info",{model:{value:t.dcw.standInfo,callback:function(e){t.$set(t.dcw,"standInfo",e)},expression:"dcw.standInfo"}},[a("template",{slot:"start"},[a("el-form",[a("el-form-item",{attrs:{label:"双选会场地"}},[a("p",[t._v(t._s(t.dcw.baseInfo.address))])])],1)],1)],2),t._v(" "),"UNIT"===t.dcw.standInfo.chooseType?a("module-container",{attrs:{inline:"",loader:!t.standsInitialized,loaderText:"正在加载展位信息"}},[t.standsInitialized&&t.canEditApplyInfo?a("stand-picker",{attrs:{dcw:t.dcw,published:"",selectable:""},model:{value:t.stands,callback:function(e){t.stands=e},expression:"stands"}}):t._e(),t._v(" "),t.canEditApplyInfo?t._e():a("el-form",[a("el-form-item",{attrs:{label:"展位号"}},[a("p",[t._v(t._s("TODO 展示展位号"))])])],1)],1):t._e(),t._v(" "),"MANAGER"===t.dcw.standInfo.chooseType?a("recruitment-info",{attrs:{dcw:t.dcw,edit:t.canEditApplyInfo},model:{value:t.unitApplyInfo.remark,callback:function(e){t.$set(t.unitApplyInfo,"remark",e)},expression:"unitApplyInfo.remark"}}):t._e(),t._v(" "),t.isUnit?a("module-container",{staticClass:"audit-actions",attrs:{actions:""}},[t.unitApplyInfo.id?t._e():a("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.submitApply}},[t._v("提交审核")]),t._v(" "),[t.UnitApplyAuditStatus.COUNTERMAND,t.UnitApplyAuditStatus.REJECT].includes(t.auditStatus)?a("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.resubmitApply}},[t._v("重新提交")]):t._e(),t._v(" "),t.auditStatus===t.UnitApplyAuditStatus.AUDITING?a("el-button",{attrs:{type:"danger",plain:"",size:"large"},on:{click:t.countermandApply}},[t._v("撤回")]):t._e()],1):t._e(),t._v(" "),t.isManager&&t.auditStatus===t.UnitApplyAuditStatus.AUDITING?a("module-container",{staticClass:"audit-actions",attrs:{actions:""}},[a("el-button",{attrs:{type:"danger",plain:"",size:"large"},on:{click:t.rejectApply}},[t._v("驳回")]),t._v(" "),a("el-button",{attrs:{size:"large"},on:{click:t.disagreeApply}},[t._v("不通过")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.agreeApply}},[t._v("通过")])],1):t._e()],1)],1)},staticRenderFns:[]};var k=a("C7Lr")(T,S,!1,function(t){a("ijN7")},"data-v-1de0583d",null);e.a=k.exports},QMmo:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("t7Ya"),i=a("/NeE"),s=a("mrGO"),r=a("DmHF"),o=(a("fSJ2"),r.a,{components:{UnitApplyDetail:r.a},data:function(){var t=this;return{page:"LIST",dcw:new n.a,unitApplyInfoId:null,auditStatus:null,table:{url:"/table-data/employment/audit/getDoubleChooseAuditBySearch?ts=",search:{ts:+new Date,beginTime:"",endTime:""},columns:[{id:"companyName",title:"单位名称",className:"text-left",width:100,hidden:!1,search:{type:"",data:{placeholer:"",autoFocus:!1}}},{id:"doubleChooseName",title:"双选会名称",className:"text-left",width:100,hidden:!1,search:{type:"",data:{placeholer:"",autoFocus:!1}}},{id:"time",title:"双选会时间",className:"text-left line-height-normal",width:165,hidden:!1,formatter:function(t){return i.a.mergeSameDayDateTime(new Date(t.beginTime).format("yyyy-MM-dd HH:mm"),new Date(t.endTime).format("yyyy-MM-dd HH:mm"))}},{id:"applyTime",title:"单位报名时间",className:"text-left line-height-normal",width:145,hidden:!1,formatter:function(t){return new Date(t.applyBeginTime).format("yyyy-MM-dd HH:mm")+" ~<br/> "+new Date(t.applyEndTime).format("yyyy-MM-dd HH:mm")}},{id:"createTime",title:"提交时间",className:"text-left",width:145,hidden:!1},{id:"auditStatus",title:"审核状态",className:"text-left",width:80,hidden:!1,formatter:function(t){return s.b[t.status]}},{id:"reason",title:"审核意见",className:"text-left",width:100,hidden:!1},{id:"opt",title:"操作",width:120,hidden:!1,formatter:function(e){return[{show:{tag:"a",text:e.status===s.a.AUDITING?"审核":"查看",callback:function(e,a){var i=new n.a;i.id=e.doubleChooseId,i.baseInfo.name=e.doubleChooseName,t.toApplyDetail({unitApplyInfoId:e.id,dcw:i,auditStatus:parseInt(e.status)})}}}.show]}}]}}},computed:{tableUrl:function(){return this.table.url+"&beginTime="+(this.table.search.beginTime||"")+"&endTime="+(this.table.search.endTime||"")+"&ts="+this.table.search.ts}},methods:{toApplyDetail:function(t){var e=t.unitApplyInfoId,a=t.dcw,n=t.auditStatus;this.dcw=a,this.unitApplyInfoId=e,this.auditStatus=n,this.page="DETAIL"},backToList:function(){this.page="LIST"},refreshTable:function(){this.table.search.ts=+new Date}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"LIST"===t.page,expression:"page === 'LIST'"}]},[a("v-table",{ref:"manageAuditTable",attrs:{url:t.tableUrl,columns:t.table.columns,pagesize:"20",idField:"id",multiple:!1,order:!0,search:!0}})],1),t._v(" "),"DETAIL"===t.page?a("unit-apply-detail",{attrs:{id:t.dcw.id,"dcw-name":t.dcw.baseInfo.name,"unit-apply-info-id":t.unitApplyInfoId,"audit-status":t.auditStatus,"is-manager":""},on:{"back-to-list":t.backToList}}):t._e()],1)},staticRenderFns:[]};var c=a("C7Lr")(o,u,!1,function(t){a("n1yM")},null,null);e.default=c.exports},ijN7:function(t,e){},mrGO:function(t,e,a){"use strict";a.d(e,"a",function(){return r}),a.d(e,"b",function(){return o});var n,i=a("a3Yh"),s=a.n(i),r={AUDITING:0,PASSED:1,FAILED:2,COUNTERMAND:3,REJECT:4},o=(n={},s()(n,r.AUDITING,"待审核"),s()(n,r.PASSED,"已通过"),s()(n,r.FAILED,"未通过"),s()(n,r.COUNTERMAND,"已撤回"),s()(n,r.REJECT,"驳回待提交"),n)},n1yM:function(t,e){}});