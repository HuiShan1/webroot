webpackJsonp([33],{"0uTc":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("C331"),i={data:function(){return{college:"",colleges:"",company:"",companys:[],barData:"",startTime:"",endTime:"",userId:"",Time:""}},created:function(){var t=this;Object(a.c)({url:"/api/colleges",dataType:"json",type:"get",success:function(e){e.state?t.colleges=e.data:t.toast("学院数据请求失败！")}}),Object(a.c)({url:"/api/pwps/units/all",dataType:"json",type:"get",success:function(e){e.state?t.companys=e.data:t.toast("用工单位数据请求失败！")}}),this.requstData()},methods:{daochu:function(){window.location.href="/downloads/pwps/statistics/downloadExcelToMountUse?fileName=岗位工资表&startTime="+this.startTime+"&endTime="+this.endTime+"&userId="+this.userId+"&collegeName="+this.college+"&unitName="+this.company},selectCollege:function(t){this.college=t.target.selected,this.requstData()},selectCompany:function(t){this.company=t.target.selected,this.requstData()},reset:function(){this.$refreshBread(this.data)},consultantSelected:function(t){this.userId=t.userId,this.requstData()},selectStartTime:function(t){this.startTime=t.value.substring(0,10).substring(0,4)+t.value.substring(0,10).substring(5,7),this.endTime&&this.requstData()},selectEndTime:function(t){this.endTime=t.value.substring(0,10).substring(0,4)+t.value.substring(0,10).substring(5,7),this.startTime&&this.requstData()},requstData:function(){var t=this;Object(a.c)({url:"/api/pwps/statistics/mountUse?userId="+this.userId+"&collegeName="+this.college+"&unitName="+this.company+"&startTime="+this.startTime+"&endTime="+this.endTime,dataType:"json",type:"get",success:function(e){e.state?(0==e.data.length&&t.toast("没有符合条件的数据!"),t.jiexishujuBingxuanran(e.data)):t.toast("请求数据失败！")}})},shuzuquchong:function(t){for(var e=[],s=0;s<t.length;s++)-1==e.indexOf(t[s])&&e.push(t[s]);return e},jiexishujuBingxuanran:function(t){var e,s=this,a=[],i=[],n=[];t.forEach(function(t){a.push(t.month),i.push(t.userName),s.Time=t.updateTime});for(var l=this.shuzuquchong(i),r=[],o=0;o<l.length;o++)for(var c=0;c<t.length;c++)l[o]==t[c].userName&&r.push(t[c].userName+t[c].positionName);e=this.shuzuquchong(r);for(var u=this.shuzuquchong(a).sort(),d=0;d<u.length;d++){n[d]=new Object,n[d].name=u[d],n[d].data=[],n[d].type="bar",n[d].stack="总量",n[d].data.length=e.length;for(var p=u[d],h=0;h<e.length;h++)for(var m=e[h],g=0;g<t.length;g++)t[g].month==p&&t[g].userName+t[g].positionName==m&&(n[d].data[h]=t[g].totalPayMount)}0==t.length?this.barData={title:"",legend:{data:[],top:"top"},xAxis:{type:"value"},yAxis:{type:"category",data:[]},seriesData:[]}:this.barData={title:"",legend:{data:u,top:"top"},xAxis:{type:"value"},yAxis:{type:"category",data:e},seriesData:n}}}},n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container-fluid",attrs:{id:"moneystatistics-page"}},[s("p",{staticClass:"title",staticStyle:{"text-align":"right",color:"rgb(158,158,158)"}},[t._v(" 以下数据统计截止至："+t._s(t.Time))]),t._v(" "),s("div",{staticClass:"row row-top ",staticStyle:{height:"80px !important"}},[s("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[s("div",{staticClass:"form-group pull-left ",staticStyle:{width:"275px"}},[s("label",[t._v("学号/姓名:")]),t._v(" "),s("detect",{staticStyle:{display:"inline-block","vertical-align":"middle"},attrs:{url:"/api/document/students/searchResults",placeholder:"请输入姓名或学工号"},on:{afterSelected:t.consultantSelected}})],1),t._v(" "),s("div",{staticClass:"form-group pull-left "},[s("label",[t._v("学院")]),t._v(" "),s("v-select",{staticStyle:{width:"150px"},attrs:{options:t.colleges,optionsLabel:"name",optionsValue:"id"},on:{afterSelected:t.selectCollege}},[t._v(">")])],1),t._v(" "),s("div",{staticClass:"form-group pull-left ",staticStyle:{"margin-left":"7px"}},[s("label",[t._v("用工单位")]),t._v(" "),s("v-select",{staticStyle:{width:"200px"},attrs:{options:t.companys,optionsLabel:"name",optionsValue:"id"},on:{afterSelected:t.selectCompany}},[t._v(">")])],1),t._v(" "),s("div",{staticClass:"form-group pull-left ",staticStyle:{"margin-left":"7px"}},[s("label",[t._v("时间")]),t._v(" "),s("v-datepicker-area",{ref:"datepicker",staticClass:"btn-block time-picker  time-item",staticStyle:{"margin-left":"-2px"},attrs:{format:"yyyy-MM-dd"},on:{startSelected:t.selectStartTime,endSelected:t.selectEndTime}})],1),t._v(" "),s("div",{staticClass:"btn-group pull-right",staticStyle:{"margin-left":"5px","margin-right":"15px"}},[s("button",{staticClass:"btn import-file-btn",attrs:{type:"button"},on:{click:t.daochu}},[t._v("导出")])]),t._v(" "),s("div",{staticClass:"btn-group pull-right",staticStyle:{"margin-left":"30px"}},[s("button",{staticClass:"btn import-file-btn",attrs:{type:"button"},on:{click:t.reset}},[t._v("重置")])])])]),t._v(" "),s("div",{staticClass:"row content"},[s("div",{staticClass:"table-item"},[s("v-EchartsBar",{attrs:{optionData:t.barData}})],1)])])},staticRenderFns:[]};var l=s("C7Lr")(i,n,!1,function(t){s("yu2O")},"data-v-f90df30c",null);e.default=l.exports},yu2O:function(t,e){}});