webpackJsonp([179],{"52HZ":function(t,e){},ZdO9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("C331"),o={data:function(){var t=this;return{curRouter:"unitSalaryManageList",curTable:"manageTable",manageTimeStamp:"",worktime:{timeStamp:"",modalShow:!1,editShow:!1,editTotal:0,editRecord:null,year:"2018",month:"01",import:!1,downloadTemplateUrl:"/pwps/users/template/manHour",importParams:{parentPageTitle:"",downloadErrorTemplateUrl:"/pwps/users/excel/error/manHour",checkTemplateUrl:"/pwps/users/manHour/excel",templateName:"工时录入模板",importBtnType:[{name:"覆盖导入",url:"/pwps/users/manHours",method:"post",isShowBtn:!0,success:function(e){e.state?(t._refreshTable(t.worktime),t.worktime.import=!1):t.$toast(e.message)}}]},tableUrl:"/table-data/pwps/users/page/manHours",columns:[{id:"userName",title:"姓名",className:"text-left",width:90,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.user?t.user.name:""}},{id:"userNo",title:"学号",className:"text-left",width:120,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.user?t.user.userNo:""}},{id:"collegeCode",title:"学院",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{url:"/api/colleges",optionsLabel:"name",optionsValue:"code"}},formatter:function(t){return t.userCollege}},{id:"grade",title:"年级",className:"text-center",width:50,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.userGrade}},{id:"contact",title:"联系方式",className:"text-left",width:90,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.userContact}},{id:"positionName",title:"岗位名称",className:"text-left",width:100,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.position?t.position.positionName:""}},{id:"positionType",title:"岗位类型",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=岗位类型",optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.position?t.position.positionTypeName:""}},{id:"salaryCapMonth",title:"薪酬上限",width:60,className:"text-right",hidden:!1,formatter:function(t){return parseFloat(t.position?t.position.salaryCapMonth:"0").toFixed(2)}},{id:"rewardStandard",title:"薪酬标准",width:60,className:"text-right",hidden:!1,formatter:function(t){return parseFloat(t.position?t.position.rewardStandard:"0").toFixed(2)}},{id:"manHour",title:"工时",width:40,className:"text-right",hidden:!1},{id:"totalPayMount",title:"应发金额",className:"text-right",width:90,hidden:!1,hover:!1,formatter:function(t){var e=parseFloat(t.position.salaryCapMonth),a=parseFloat(t.totalPayMount),i=a.toFixed(2);return a-e>1e-6?'<span style="color: orangered;" title="'+i+'">'+i+"</span>":'<span title="'+i+'">'+i+"</span>"}},{id:"remark",title:"备注",width:40,className:"text-right",hidden:!1},{id:"opt",title:"操作",className:"text-left",width:40,hidden:!1,formatter:function(e){var a=[];if(e.position&&e.position.salaryCapMonth&&e.totalPayMount){parseFloat(e.position.salaryCapMonth),parseFloat(e.totalPayMount);a.push({tag:"a",text:"编辑",callback:function(e,a){t.worktime.editShow=!0,t.worktime.editRecord=e,t.worktime.editTotal=e.totalPayMount}})}return a}}]},salarySubmit:{timeStamp:"",modalShow:!1,year:"2018",month:"01",tableUrl:"/table-data/pwps/salaries/page/forSubmit",total:0,columns:[{id:"name",title:"姓名",className:"text-left",width:60,hidden:!1,formatter:function(t){return t.user?t.user.name:""}},{id:"userNo",title:"学号",className:"text-left",width:120,hidden:!1,formatter:function(t){return t.user?t.user.userNo:""}},{id:"userType",title:"学生类别",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.user?t.user.type:""}},{id:"userCollege",title:"学院",className:"text-left",width:120,hidden:!1},{id:"unit",title:"用工单位",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.position&&t.position.unit?t.position.unit.name:""}},{id:"positionName",title:"岗位名称",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.position?t.position.positionName:""}},{id:"positionType",title:"岗位类型",className:"text-left",width:60,hidden:!1,formatter:function(t){return t.position?t.position.positionTypeName:""}},{id:"totalPayMount",title:"应发薪酬",className:"text-right",width:60,hidden:!1}]},checkRecord:{modalShow:!1,viewIndex:"job",tableUrl:{job:"/table-data/pwps/salaries/page/byPosition",member:"/table-data/pwps/salaries/page/byUser"},columns:{job:[{id:"positionName",title:"岗位名称",className:"text-left",width:100,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.position?t.position.positionName:""}},{id:"positionType",title:"岗位类型",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=岗位类型",optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.position?t.position.positionTypeName:""}},{id:"month",title:"月份",className:"text-left",width:100,hidden:!1},{id:"grantCount",title:"发放人数",className:"text-right",width:60,hidden:!1},{id:"totalPayMount",title:"应发薪酬",className:"text-right",width:60,hidden:!1},{id:"realPayMount",title:"实发薪酬",className:"text-right",width:60,hidden:!1}],member:[{id:"name",title:"姓名",className:"text-left",width:60,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.user?t.user.name:""}},{id:"userNo",title:"学号",className:"text-left",width:120,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.user?t.user.userNo:""}},{id:"positionName",title:"岗位名称",className:"text-left",width:80,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.position?t.position.positionName:""}},{id:"positionType",title:"岗位类型",className:"text-left",width:80,hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=岗位类型",optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.position?t.position.positionTypeName:""}},{id:"month",title:"月份",className:"text-left",width:60,hidden:!1,search:{type:"input"}},{id:"manHour",title:"工时",className:"text-right",width:50,hidden:!1},{id:"rewardStandard",title:"薪酬标准",className:"text-right",width:60,hidden:!1,formatter:function(t){return parseFloat(t.position?t.position.rewardStandard:"0").toFixed(2)}},{id:"salaryCapMonth",title:"薪酬上限",className:"text-right",width:60,hidden:!1,formatter:function(t){return t.position?t.position.salaryCapMonth:""}},{id:"totalPayMount",title:"应发薪酬",className:"text-right",width:60,hidden:!1},{id:"realPayMount",title:"实发薪酬",className:"text-right",width:60,hidden:!1}]}},batchYear:"",yearOptions:[],monthOptions:[{id:"01",name:"一月"},{id:"02",name:"二月"},{id:"03",name:"三月"},{id:"04",name:"四月"},{id:"05",name:"五月"},{id:"06",name:"六月"},{id:"07",name:"七月"},{id:"08",name:"八月"},{id:"09",name:"九月"},{id:"10",name:"十月"},{id:"11",name:"十一月"},{id:"12",name:"十二月"}],uniyOptions:[{id:"unitA",name:"单位A"},{id:"unitB",name:"单位B"},{id:"unitC",name:"单位C"},{id:"unitD",name:"单位D"}],unit:"",manageTableUrl:"/table-data/pwps/salaries/page/manage",manageTableColumns:[{id:"unitName",title:"单位",className:"text-left",width:100,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.unit?t.unit.name:""}},{id:"month",title:"月份",className:"text-left",width:50,hidden:!1,search:{type:"input"}},{id:"grantCount",title:"发放人数",width:60,className:"text-right",hidden:!1},{id:"totalPayMount",title:"应发薪酬",width:60,className:"text-right",hidden:!1},{id:"realPayMount",title:"实发薪酬",width:60,className:"text-right",hidden:!1},{id:"statusLabel",title:"审核状态",width:60,className:"text-left",hidden:!1},{id:"grantStatus",title:"是否发放",width:60,className:"text-center",hidden:!1,search:{type:"select",data:{options:[{value:"ALL",label:"全部发放"},{value:"PART",label:"部分发放"},{value:"NONE",label:"未发放"}],optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return"ALL"===t.grantStatus?"全部发放":"PART"===t.grantStatus?"部分发放":"未发放"}},{id:"opt",title:"操作",className:"text-left",width:50,hidden:!1,formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.checkRecord.modalShow=!0,t.viewRecord=e}}]}}],viewRecord:null,rows:[{id:1,name:"张三",userNo:"30920122202598",grade:"2012",unit:"单位A",month:"一月",number:20,contact:"18888888888",college:"软件学院",positionName:"兼职辅导员",positionType:"文职",manHour:30,rewardStandard:1e3,totalPayMount:300,realPayMount:300,totalSalary:3e3,realSalary:3e3,salaryCapMonth:5e3,isGrant:!0}]}},methods:{_onlyNumber:function(t){this.worktime.year=t.target.value.replace(/[^\d]/g,"")},_refreshTable:function(t){t.timeStamp=Object(i.a)()},_submitSalary:function(){var t=this;Object(i.e)({url:"/api/pwps/salaries/submit/auditing",type:"put",data:{unitId:this.unit,month:""+this.salarySubmit.year+this.salarySubmit.month},success:function(e){e.state?(t.$toast("提交审核成功"),t.salarySubmit.modalShow=!1,t.manageTimeStamp=Object(i.a)()):t.$toast(e.message)}})},_submitWorkTime:function(){var t=this;Object(i.e)({url:"/api/pwps/salaries/"+this.worktime.editRecord.id,type:"put",data:{totalPayMount:this.worktime.editTotal},success:function(e){e.state?(t.worktime.editShow=!1,t.worktime.editRecord.totalPayMount=t.worktime.editTotal):t.$toast(e.message)}})},_countSalaryTotal:function(){var t=this;Object(i.e)({url:"/api/pwps/salaries/count/forSubmit",type:"get",data:{unitId:this.unit,month:""+this.salarySubmit.year+this.salarySubmit.month},success:function(e){e.state?t.salarySubmit.total=e.data||0:t.$toast(e.message)}})},_export:function(){var t=this.$refs.worktimeTable.tableSearchFields;t.month=""+this.worktime.year+this.worktime.month,t.unitId=this.unit;var e="";for(var a in t)e+="&"+a+"="+t[a];window.location.href="/downloads/pwps/salaries/excel?fileName="+t.month+"工时录入表"+e}},created:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1;this.yearOptions=[];for(var i=e-2;i<e+8;i++)this.yearOptions.push({id:i+"-"+(i+1)+"学年",name:i+"-"+(i+1)+"学年"});this.worktime.year=e,this.worktime.month=a,this.salarySubmit.year=e,this.salarySubmit.month=a}},s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return"unitSalaryManageList"===t.curRouter?a("div",{staticClass:"unit-salary-manage"},["manageTable"===t.curTable?a("div",{},[a("v-table",{key:"0",attrs:{url:t.unit?t.manageTableUrl+"?unitId="+t.unit+"&timeStamp="+t.manageTimeStamp:"",columns:t.manageTableColumns,pagesize:"10",idField:"id",multiple:!1,order:!0,search:!1}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("v-select",{attrs:{placeholder:"暂无单位可选",url:"/api/pwps/units/my",required:!0,"options-value":"id","options-label":"name"},model:{value:t.unit,callback:function(e){t.unit=e},expression:"unit"}})],1),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[t.unit?a("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:function(e){t.curTable="worktimeTable"}}},[t._v("切换到工时录入")]):t._e(),t._v(" "),t.unit?a("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:function(e){t.salarySubmit.modalShow=!0,t._countSalaryTotal()}}},[t._v("提交薪酬审核")]):t._e()])])])],1):a("div",{staticClass:"container"},[a("v-table",{key:"1",ref:"worktimeTable",attrs:{url:t.unit?t.worktime.tableUrl+"?unitId="+t.unit+"&month="+t.worktime.year+t.worktime.month+"&timeStamp="+t.worktime.timeStamp:"",columns:t.worktime.columns,pagesize:"10",idField:"id",multiple:!1,order:!0,search:!0}},[a("div",{attrs:{slot:"btn-group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left worktime-month"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.worktime.year,expression:"worktime.year"}],staticClass:"pull-left year-input",attrs:{type:"text",maxlength:"4",placeholder:"公元年2018"},domProps:{value:t.worktime.year},on:{input:[function(e){e.target.composing||t.$set(t.worktime,"year",e.target.value)},t._onlyNumber]}}),t._v(" "),a("v-select",{staticClass:"month-select",attrs:{autoSelect:!1,required:!0,options:t.monthOptions,"options-value":"id","options-label":"name"},on:{afterSelected:function(e){return t._refreshTable(t.worktime)}},model:{value:t.worktime.month,callback:function(e){t.$set(t.worktime,"month",e)},expression:"worktime.month"}})],1),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:t._export}},[t._v("导出")]),t._v(" "),a("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:function(e){t.curRouter="importPage"}}},[t._v("批量录入")]),t._v(" "),a("button",{staticClass:"btn blue",attrs:{type:"button"},on:{click:function(e){t.curTable="manageTable"}}},[t._v("切换到单位薪酬管理")])])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.salarySubmit.modalShow,width:"1000"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("提交薪酬审核")])]),t._v(" "),t.salarySubmit.modalShow?a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("v-table",{key:"2",attrs:{url:t.unit?t.salarySubmit.tableUrl+"?unitId="+t.unit+"&month="+t.salarySubmit.year+t.salarySubmit.month+"&timeStamp="+t.salarySubmit.timeStamp:"",columns:t.salarySubmit.columns,pagesize:"10",idField:"id",multiple:!1,order:!0}},[a("div",{attrs:{slot:"btn-group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left worktime-month"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.salarySubmit.year,expression:"salarySubmit.year"}],staticClass:"pull-left year-input",attrs:{type:"text",maxlength:"4",placeholder:"公元年2018"},domProps:{value:t.salarySubmit.year},on:{input:[function(e){e.target.composing||t.$set(t.salarySubmit,"year",e.target.value)},t._onlyNumber]}}),t._v(" "),a("v-select",{staticClass:"month-select",attrs:{autoSelect:!1,required:!0,options:t.monthOptions,"options-value":"id","options-label":"name"},on:{afterSelected:function(e){return t._refreshTable(t.salarySubmit)}},model:{value:t.salarySubmit.month,callback:function(e){t.$set(t.salarySubmit,"month",e)},expression:"salarySubmit.month"}})],1),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("span",{staticStyle:{"line-height":"36px"}},[t._v("总计："+t._s(t.salarySubmit.total)+"元")])])])])],1):t._e(),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("a",{staticClass:"btn orangered",attrs:{type:"button"},on:{click:function(e){t.salarySubmit.modalShow=!1}}},[t._v("取消")]),t._v(" "),a("a",{staticClass:"btn orangered",attrs:{type:"button"},on:{click:t._submitSalary}},[t._v("提交")])])]),t._v(" "),a("v-modal",{attrs:{show:t.checkRecord.modalShow,width:"1000"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("查看")])]),t._v(" "),t.checkRecord.modalShow?a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("v-table",{key:"3",attrs:{title:"job"===t.checkRecord.viewIndex?"岗位视图":"人员视图",url:t.viewRecord?t.checkRecord.tableUrl[t.checkRecord.viewIndex]+"?unitId="+t.unit+"&month="+t.viewRecord.month:"",columns:t.checkRecord.columns[t.checkRecord.viewIndex],pagesize:"10",idField:"id",multiple:!1,order:!0,search:!1}},[a("div",{attrs:{slot:"btn-group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(e){t.checkRecord.viewIndex="job"===t.checkRecord.viewIndex?"member":"job"}}},[t._v("切换视图")])])])])],1):t._e(),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("a",{staticClass:"btn orangered",attrs:{type:"button"},on:{click:function(e){t.checkRecord.modalShow=!1}}},[t._v("关闭")])])]),t._v(" "),a("v-modal",{attrs:{show:t.worktime.editShow,width:"200"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("编辑应发薪酬")])]),t._v(" "),t.worktime.editRecord?a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",[t._v("应发薪酬")]),a("span",[t._v("应为 "+t._s(t.worktime.editRecord.position.salaryCapMonth)+" 内")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.worktime.editTotal,expression:"worktime.editTotal"}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.worktime.editTotal},on:{input:function(e){e.target.composing||t.$set(t.worktime,"editTotal",e.target.value)}}})])]):t._e(),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("a",{staticClass:"btn orangered",attrs:{type:"button"},on:{click:function(e){t.worktime.editShow=!1}}},[t._v("取消")]),t._v(" "),a("a",{staticClass:"btn orangered",attrs:{type:"button"},on:{click:t._submitWorkTime}},[t._v("提交")])])])],1):a("v-import",t._b({staticClass:"container-fluid",attrs:{downloadTemplateUrl:t.worktime.downloadTemplateUrl+"?unitId="+t.unit+"&month="+t.worktime.year+t.worktime.month},on:{backParentPage:function(e){t.curRouter="unitSalaryManageList"}}},"v-import",t.worktime.importParams,!1))},staticRenderFns:[]};var r=a("VU/8")(o,s,!1,function(t){a("52HZ")},null,null);e.default=r.exports}});