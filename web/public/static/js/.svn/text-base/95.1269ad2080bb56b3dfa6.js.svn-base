webpackJsonp([95],{Hi5W:function(t,e){},vwya:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("a3Yh"),o=a.n(s),n=(a("n+6Y"),a("C331")),i={data:function(){return{url:"/table-data/mentality/teachers/pages",timeStamp:"",columns:[],importPage:!1,showTypeModal:!1,showAddFullTimeModal:!1,showAddModal:!1,fullTimeConsultantId:"",importParams:{parentPageTitle:"咨询师管理",downloadTemplateUrl:"",downloadErrorTemplateUrl:"",checkTemplateUrl:"",templateName:"批量新增咨询师",importBtnType:null},sexData:[],modalType:"",consultantData:{teacherBaseInfo:{userId:"",name:"",sex:"",teacherContactPO:{mobilePhone:""}},synopsis:"",portrait:"",type:"",userCertificationVO:{userNo:"",password:""}},dutyTime:"",addType:"",consultantType:"",consultantTypeData:[{value:"FULL_TIME",label:"专职"},{value:"EXTERNAL",label:"外聘"}],isCheck:!1,isEditExternal:!1,isShowSearch:!0,userIdAndUserName:"",showErrorColor:!1,lang:"zh-cn"}},computed:{translate:function(){return Object(n.e)(this.lang).employmentUnitManage}},created:function(){var t=this,e=localStorage.getItem("lang");Object(n.e)(e)&&(this.lang=e),Object(n.c)({url:"/api/system/dicts",dataType:"json",type:"get",data:{dictType:"性别"},success:function(e){e.state?t.sexData=e.data:t.toast(e.message)}}),this.importParams.importBtnType=[{url:"/mentality/teachers/batch/",method:"put",isShowBtn:!0,name:"覆盖导入",success:function(e){e.state&&(t._refreshTable(),t.importPage=!1)}}],this.columns=[{id:"name",title:"姓名",className:"text-left",width:100,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.teacherBaseInfo?t.teacherBaseInfo.name:""}},{id:"phone",title:"联系方式",width:120,className:"text-left",hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.teacherBaseInfo&&t.teacherBaseInfo.teacherContactPO?t.teacherBaseInfo.teacherContactPO.mobilePhone:""}},o()({id:"synopsis",title:"简介",width:100,className:"text-left",hidden:!1},"width",150),{id:"portrait",title:"照片",width:100,className:"text-left",hidden:!1,formatter:function(e){if(e.portrait)return[{tag:"img",text:"",src:t.imageUrlPrefix+e.portrait,className:"img-style"}]}},{id:"userNo",title:"账号",className:"text-left",width:120,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.userCertificationVO?t.userCertificationVO.userNo:""}},{id:"password",title:"密码",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.userCertificationVO?t.userCertificationVO.password:""}},{id:"opt",title:"操作",className:"text-left",width:130,hidden:!1,formatter:function(e){return[{tag:"a",text:"查看",callback:function(e,a){t.isCheck=!0,t.showAddModal=!0,t.modalType="查看",t.isEditExternal="FULL_TIME"!==e.type,t.consultantType=e.type;var s={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},o=[];e.timeTeacherSettings&&e.timeTeacherSettings.forEach(function(t,e){o.push(s[t.dayOfWeek]+" "+t.timeSetting.timeQuantumStart+"~"+t.timeSetting.timeQuantumEnd)}),t.consultantData={teacherBaseInfo:{userId:e.teacherBaseInfo?e.teacherBaseInfo.userId:"",name:e.teacherBaseInfo?e.teacherBaseInfo.name:"",sex:e.teacherBaseInfo?e.teacherBaseInfo.sex:"",teacherContactPO:{mobilePhone:e.teacherBaseInfo&&e.teacherBaseInfo.teacherContactPO?e.teacherBaseInfo.teacherContactPO.mobilePhone:""}},synopsis:e.synopsis,portrait:e.portrait,type:e.type,userCertificationVO:{userNo:e.userCertificationVO?e.userCertificationVO.userNo:"",password:e.userCertificationVO?e.userCertificationVO.password:""}},t.dutyTime=o}},{tag:"a",text:"编辑",className:"opt-btn",callback:function(e,a){t.modalType="编辑",t.isEditExternal="FULL_TIME"!==e.type,t.consultantType=e.type,t.isCheck=!1,t.showAddModal=!0,t.fullTimeConsultantId=e.teacherBaseInfo.userId,t.consultantData={userCertificationVO:e.userCertificationVO,teacherBaseInfo:{userId:e.teacherBaseInfo?e.teacherBaseInfo.userId:"",name:e.teacherBaseInfo?e.teacherBaseInfo.name:"",sex:e.teacherBaseInfo?e.teacherBaseInfo.sex:"",teacherContactPO:{mobilePhone:e.teacherBaseInfo&&e.teacherBaseInfo.teacherContactPO?e.teacherBaseInfo.teacherContactPO.mobilePhone:""}},synopsis:e.synopsis,portrait:e.portrait,type:e.type}}},{tag:"a",text:e.disable?"启用":"禁用",className:"opt-btn",callback:function(a,s){e.disable?Object(n.c)({url:"/api/mentality/teachers/using/"+a.teacherBaseInfo.userId,type:"put",success:function(e){e.state?(t._refreshTable(),t.$toast("启动成功！")):t.toast(e.message)}}):window.confirm("确定禁用吗？")&&Object(n.c)({url:"/api/mentality/teachers/disable/"+a.teacherBaseInfo.userId,type:"put",success:function(e){e.state?(t._refreshTable(),t.$toast("禁用成功！")):t.toast(e.message)}})}}]}}]},methods:{_selectConsultantType:function(t){this.consultantType=t.value},_selectSex:function(t){this.isCheck||(this.consultantData.teacherBaseInfo.sex=t.value)},changeUserSearch:function(){this.isShowSearch=!0,this.userIdAndUserName="",this.fullTimeConsultantId=""},showConsultantTypeModal:function(t){this.addType=t,this.showTypeModal=!0,this.consultantType=""},sumbitTypeModal:function(){if(!this.consultantType)return this.toast("请先选择咨询师类型");this.showTypeModal=!1,"batch"===this.addType?(this.showTypeModal=!1,this.importPage=!0,this.importParams.downloadTemplateUrl="/mentality/teachers/batchCreate/templates/"+this.consultantType,this.importParams.downloadErrorTemplateUrl="/mentality/teachers/excel/error",this.importParams.checkTemplateUrl="/mentality/teachers/excel/"+this.consultantType):"FULL_TIME"===this.consultantType?(this.showAddFullTimeModal=!0,this.userIdAndUserName="",this.isShowSearch=!0,this.fullTimeConsultantId=""):(this.showAddModal=!0,this.isCheck=!1,this.modalType="新增",this.consultantData={teacherBaseInfo:{userId:"",name:"",sex:"",teacherContactPO:{mobilePhone:""}},synopsis:"",portrait:"",type:"",userCertificationVO:{userNo:"",password:""}})},submitConsultantInfo:function(){"新增"===this.modalType?this._addConsultant():"编辑"===this.modalType&&this._editConsultant()},_checkDataIsExist:function(){var t=!0;if("EXTERNAL"===this.consultantType){if(!this.consultantData.userCertificationVO.userNo)return this.toast("请填写账号"),!1;if(!this.consultantData.userCertificationVO.password)return this.toast("请填写密码"),!1}return this.consultantData.teacherBaseInfo.name?this.consultantData.teacherBaseInfo.sex?this.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone?this.consultantData.synopsis?this.consultantData.portrait?t:(this.toast("请上传一张照片"),!1):(this.toast("请填写简介"),!1):(this.toast("请填写联系方式"),!1):(this.toast("请选择性别"),!1):(this.toast("请填写姓名"),!1)},_addConsultant:function(){var t=this;this._checkDataIsExist()&&(this.consultantData.type="EXTERNAL",Object(n.c)({url:"/api/mentality/teachers",type:"post",data:[this.consultantData],success:function(e){e.state?(t.showAddModal=!1,t._refreshTable(),t.$toast("添加成功！")):t.toast(e.message)}}))},_editConsultant:function(){var t=this;this._checkDataIsExist()&&Object(n.c)({url:"/api/mentality/teachers",type:"put",data:this.consultantData,success:function(e){e.state?(t.showAddModal=!1,t._refreshTable(),t.$toast("保存成功！")):t.toast(e.message)}})},isPhoneNo:function(){if(!/^1[3456789]\d{9}$/.test(this.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone))return this.toast("联系方式格式不正确"),void(this.showErrorColor=!0);this.showErrorColor=!1},sumbitFullTimeModal:function(){var t=this;if(!this.fullTimeConsultantId)return this.$toast("请先检索咨询师");var e=[];e.push({teacherBaseInfo:{userId:this.fullTimeConsultantId},type:"FULL_TIME"}),Object(n.c)({url:"/api/mentality/teachers",type:"post",data:e,success:function(e){e.state?(t.showAddFullTimeModal=!1,t._refreshTable(),t.$toast("新增成功！")):t.toast(e.message)}})},consultantSelected:function(t){this.fullTimeConsultantId=t.userId,this.userIdAndUserName=t.name+" ("+t.userNo+")",this.isShowSearch=!1},_refreshTable:function(){this.url="/table-data/mentality/teachers/pages?timeStamp="+Object(n.a)()},_fileUpload:function(t){var e=this;this.$waiting.show({text:"照片上传中..."});var a=new FormData;a.append("file",t.target.files[0]),a.append("fieldName",t.target.files[0].name),Object(n.c)({url:this.uploadFile,type:"post",data:a,contentType:!1,processData:!1,success:function(t){"88888"===t.code?(e.consultantData.portrait=t.data.hash,e.$toast("照片上传成功")):e.$toast(t.message)}}).always(function(){e.$waiting.close()})},removeImg:function(){confirm("确定删除该照片吗？")&&(this.consultantData.portrait="")},_showAttachmentPreview:function(){var t=this.fileUrlPrefix+this.consultantData.portrait;this.$preview({name:"照片",url:t,type:"png"})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.importPage?a("v-import",t._b({on:{backParentPage:function(e){t.importPage=!1}}},"v-import",t.importParams,!1)):a("div",{staticClass:"container-fluid",attrs:{id:"consultant-manage"}},[a("div",{staticClass:"row text-center"},[a("v-table",{attrs:{title:"咨询师管理",url:t.url,pagesize:"10",idField:"id",columns:t.columns,multiple:!1,order:!0,search:!1}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showConsultantTypeModal("batch")}}},[t._v("批量新增咨询师")]),t._v(" "),a("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showConsultantTypeModal("single")}}},[t._v("单个新增咨询师")])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.showTypeModal,effect:"fade",width:"400"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n          选择咨询师类型\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"info-item"},[a("div",{staticClass:"info-options"},t._l(t.consultantTypeData,function(e,s){return a("span",{key:s,on:{click:function(a){t._selectConsultantType(e)}}},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons(t.consultantType===e.value?"radio_button_checked":"radio_button_unchecked"))}}),t._v(t._s(e.label)+"\n          ")])}))])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showTypeModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sumbitTypeModal}},[t._v("确定")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showAddFullTimeModal,effect:"fade",width:"400"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n          新增咨询师\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"modal-search-user"},[t.isShowSearch?a("detect",{attrs:{url:"/api/document/teachers/searchResults",placeholder:"咨询师姓名或学工号"},on:{afterSelected:t.consultantSelected}}):a("div",[a("div",{staticClass:"user-info pull-left"},[t._v(t._s(t.userIdAndUserName))]),t._v(" "),a("i",{staticClass:"maticon pull-left",domProps:{innerHTML:t._s(t.icons("edit"))},on:{click:t.changeUserSearch}},[t._v("edit")])])],1)]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddFullTimeModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sumbitFullTimeModal}},[t._v("确定")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"670"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n          "+t._s(t.modalType)+"咨询师\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"row",staticStyle:{"margin-bottom":"25px"}},[a("div",{staticClass:"col-md-6"},["EXTERNAL"===t.consultantType?a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label two-words-difference-margin"},[t._v("账号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.userCertificationVO.userNo,expression:"consultantData.userCertificationVO.userNo"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck||t.isEditExternal,placeholder:"请输入账号"},domProps:{value:t.consultantData.userCertificationVO.userNo},on:{input:function(e){e.target.composing||t.$set(t.consultantData.userCertificationVO,"userNo",e.target.value)}}})]):t._e(),t._v(" "),"EXTERNAL"===t.consultantType?a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label two-words-difference-margin"},[t._v("密码")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.userCertificationVO.password,expression:"consultantData.userCertificationVO.password"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck,placeholder:"请输入密码"},domProps:{value:t.consultantData.userCertificationVO.password},on:{input:function(e){e.target.composing||t.$set(t.consultantData.userCertificationVO,"password",e.target.value)}}})]):t._e(),t._v(" "),a("div",{staticClass:"form-group "},[a("label",{staticClass:"form-label two-words-difference-margin"},[t._v("姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.teacherBaseInfo.name,expression:"consultantData.teacherBaseInfo.name"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck,placeholder:"请输入姓名"},domProps:{value:t.consultantData.teacherBaseInfo.name},on:{input:function(e){e.target.composing||t.$set(t.consultantData.teacherBaseInfo,"name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"info-item"},[a("span",{staticClass:"item-title"},[t._v("性别")]),t._v(" "),a("div",{staticClass:"info-options",class:t.isCheck?"disabled-click":""},t._l(t.sexData,function(e,s){return a("span",{key:s,on:{click:function(a){t._selectSex(e)}}},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons(t.consultantData.teacherBaseInfo.sex===e.value?"radio_button_checked":"radio_button_unchecked"))}}),t._v(t._s(e.label)+"\n              ")])}))]),t._v(" "),a("div",{staticClass:"form-group "},[a("label",{staticClass:"form-label"},[t._v("联系方式")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone,expression:"consultantData.teacherBaseInfo.teacherContactPO.mobilePhone"}],staticClass:"form-control form-input",class:t.showErrorColor?"error":"",attrs:{type:"text",placeholder:"请输入联系方式",disabled:t.isCheck},domProps:{value:t.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone},on:{change:t.isPhoneNo,input:function(e){e.target.composing||t.$set(t.consultantData.teacherBaseInfo.teacherContactPO,"mobilePhone",e.target.value)}}})]),t._v(" "),t.isCheck?a("div",{staticClass:"form-group"},[a("label",{staticClass:"form-label"},[t._v("值班时间")]),t._v(" "),a("div",{staticClass:"duty-time"},t._l(t.dutyTime,function(e,s){return a("div",{key:s},[t._v(t._s(e)+" ")])}))]):t._e()]),t._v(" "),a("div",{staticClass:"col-md-6"},[t.isCheck?a("div",{staticClass:"form-group"},[a("label",{staticClass:"textarea-label two-words-difference-margin"},[t._v("照片")]),t._v(" "),a("div",{staticClass:"photo-show",style:{backgroundImage:"url("+(t.imageUrlPrefix+t.consultantData.portrait)+"?thumb=true)",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}})]):a("div",{staticClass:"form-group"},[a("label",{staticClass:"textarea-label two-words-difference-margin"},[t._v("照片")]),t._v(" "),t.consultantData.portrait?a("div",{staticClass:"photo-show",style:{backgroundImage:"url("+(t.imageUrlPrefix+t.consultantData.portrait)+"?thumb=true)",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}},[t.isCheck?t._e():a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("cancel"))},on:{click:function(e){return e.stopPropagation(),t.removeImg(e)}}},[t._v("cancel")])]):a("div",{staticClass:"file-select"},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("file_upload"))}},[t._v("file_upload")]),t._v(" "),a("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(e){t._fileUpload(e)}}})])])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label two-words-difference-margin textarea-label"},[t._v("简介")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.synopsis,expression:"consultantData.synopsis"}],staticClass:"modal-textarea",attrs:{cols:"24",rows:"5",maxlength:"300",placeholder:"请输入300字以内的简介",disabled:t.isCheck},domProps:{value:t.consultantData.synopsis},on:{input:function(e){e.target.composing||t.$set(t.consultantData,"synopsis",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")]),t._v(" "),t.isCheck?t._e():a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.submitConsultantInfo}},[t._v("确定")])])])],1)},staticRenderFns:[]};var l=a("C7Lr")(i,r,!1,function(t){a("Hi5W")},null,null);e.default=l.exports}});