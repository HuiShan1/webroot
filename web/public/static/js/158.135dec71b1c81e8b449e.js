webpackJsonp([158],{cJZF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3cXf"),i=a.n(s),o=a("qqHy"),n=a.n(o),c=a("C331"),r=a("tjnL"),l=(a("ZpE2"),r.a,{mixins:[r.a],inject:{windowObj:{default:null}},props:{tableName:"",appData:{default:null},data:{default:null},account:null},data:function(){return{curPlayerType:"",length:0,clickIndex:0,jisuanArray:[{titleName:"",cal:[{name:"计算1",caculate:1e3},{name:"计算2",caculate:500}]},{titleName:"辅导员B",cal:[{name:"计算3",caculate:1e3},{name:"计算4",caculate:500}]}],tabArray:[{name:"报表1"},{name:"报表2"},{name:"报表3"}],opt:1,showBaobiaomodel:!1,countCollegeCode:"",countData:[],historyCountData:[],historyCountOptions:[],barCircleWidth:8,countPartShow:!1,countModal:!1,countTabActive:"",isAddCombinationCount:!1,dictTypes:[],countRadios:[],defaultOptions:{college:"0",grade:"0",studentType:"0"},gradeOptions:[],collegeSelectOptions:[],countItemData:[],countItemSelectArr:[],countOptionData:[],countOptionArr:{selectArr:[],oldData:[]},countOptionSelectArr:[],countOptionIndex:0,countOptionMark:"",isShowOptionsModal:{countOption:!1,combinationCount:!1},combinationCountItemData:[],combCountItemSelectData:{nameArr:[],titleArr:[]},combCountOptionData:[],curSelectCombOptions:[],selectCombOptions:[],combstatisticsItems:{combination:!0,title:"",name:"",options:[]},combCountOptionIndex:0,countSearchCollegeCode:"",countSearchStudentType:"",countSearchGrade:"",countCollegeName:"",countStudentTypeName:"",countGradeName:"",isCollegeOrPlayer:!1,curCountItems:[],curCheckType:1,isCombination:!1,saveCollegeOrPlyaerCountData:[],curSelectCountData:{},isClickFilterTab:!1,saveCountData:{countTabActive:"",select:{college:"0",grade:"0",studentType:"0"},countType:{id:0,value:{}},countItemData:{id:0,value:{}},countData:[],combCountItemData:[],oldCountItemData:[],countItemSelectArr:[],newAddcountItem:[],countOptionArray:[]},curStatisticsItems:[],overviewHistoryData:{countData:[],countItemData:[],countItemSelectArr:[],countOptionSelectArr:[]},collegeHistoryData:{countData:[],countItemData:[],countOptionSelectArr:[]},instructorHistoryData:{countData:[],countItemData:[],countOptionSelectArr:[]},newCollegeOrPlayerData:[],multipleSelectComparison:[],previousIndexArr:[],newAddcountItem:[],isRecordCurOptionsArr:!1,countItemHeight:125,setHeight:628,countContentHeight:635,combContentHeight:510,collegeComparison:!1,instructorComparison:!1,curCountOptions:{},isDisabled:!1,baseFields:["姓名","学号","年级","新生账号","学院","培养层次","状态","操作"],playersTime:[],myFormPreview:!1,saveBtnContrl:!0,submitBtnControl:!0,collegeOptions:[],backControl:"",playerId:"",formData_components_check:"",formData_name_check:"",formData_property_script_check:"",log:null,showPlayerForm:!1,instanceId:"",method:"get",url:"",sortParams:"",student:{name:"",categories:[]},showDetail:!1,ts:new Date,lang:"zh-cn",tableShowControl:!0,importPartners:!1,headerShow:!0,columns:[],columnSearchType:{input:"input",number:"input",address:"input",select:"select",radio:"select"},partnerContent:!1,collapsed:!1,curApp:null,curUserType:null,curBusinessId:null,curTab:"guide",formData:null,formData_components:"",formData_name:"",formData_property_script:"",preview:!1,businessList:[],errorMessage:"",recordData:[],outputList:[],formFields:[],outputModalShow:!1,notAllowOutput:["label","splitLine"],notAllowShow:["label","splitLine","image","attachment","table"],importParams:{parentPageTitle:"",downloadTemplateUrl:"",downloadErrorTemplateUrl:"",checkTemplateUrl:"",templateName:"",importBtnType:null},statistic:{dataIndex:"",barIndex:""},curPlayer:null,exportFiledArr:[],showAttachmentPreview:!1,acttachmentObj:{},acttachmentUrl:"",curBusinessTime:"",multiForm:!1,myFormsColumn:[],myFormTableUrl:"",isMergeTable:!1}},computed:{curBusiness:function(){var t=this,e=null;return this.businessList.forEach(function(a){a.id===t.curBusinessId&&(e=a)}),e},statisticTableUrl:function(){var t="/statistics/business/"+this.curBusinessId+"/statistics/details/pages?";return this.playerId&&(t+="&playerId="+this.playerId),this.countCollegeCode&&(t+="&playerId="+this.countCollegeCode),t+="&itemIndex="+this.statistic.dataIndex,t+="&detailIndex="+this.statistic.barIndex},translate:function(){return Object(c.g)(this.lang).infoManage},curCountData:function(){var t=this;return this.countOptionArr.oldData=[],this.countData.forEach(function(e,a){var s=0,i=e.details.length;e.details.forEach(function(t){t.count=null===t.count?0:t.count,s+=t.count}),e.details.forEach(function(e){e.count=null===e.count?0:e.count;var a=0;a=0===s?1/i:e.count/s;var o=Number(100*a).toFixed(2)+"%";t.$set(e,"percent",o)})}),this.countItemData.forEach(function(e){t.countOptionArr.oldData.push(JSON.parse(i()(e.details)))}),this.countData},newCurCountData:function(){var t=this;return this.isRecordCurOptionsArr||this.isCollegeOrPlayer&&(this.countOptionArr.selectArr=[]),this.newCollegeOrPlayerData.forEach(function(e){e.details.forEach(function(e){var a=0,s=e.statisticsResult.length;e.statisticsResult.forEach(function(t,e){t.count=null===t.count?0:t.count,a+=t.count}),e.statisticsResult.forEach(function(e){e.count=null===e.count?0:e.count;var i=0;i=0===a?1/s:e.count/a;var o=Number(100*i).toFixed(2)+"%";t.$set(e,"percent",o)})})}),this.countItemData.forEach(function(e,a){var s=[];JSON.parse(i()(e.details)).forEach(function(t){s.push(t.name)}),t.countOptionArr.selectArr.push({id:a,value:s})}),this.newCollegeOrPlayerData},curCountUrl:function(){return 2===this.curCheckType?"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics/collegeComparison?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType:4===this.curCheckType?"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics/classComparison?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode:"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics/playerComparison?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode},exportCountUrt:function(){var t="/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode;return 1===this.curCheckType?t="/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode:2===this.curCheckType?t="/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/collegeComparison/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType:3===this.curCheckType?t="/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/playerComparison/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode:4===this.curCheckType&&(t="/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/classComparison/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode),t},exportCurCountUrl:function(){return 2===this.curCheckType?"/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/details/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType:"/downloads/statistics/formEngine/business/"+this.curBusinessId+"/statistics/details/excel?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode},barLength:function(){return this.countTabActive?558:800},newBarLength:function(){return this.countTabActive?500:742}},created:function(){var t=this,e=localStorage.getItem("lang");Object(c.g)(e)&&(this.lang=e),this.importParams.needAdvance=!0,this.importParams.templateName=this.translate.baseModelParticipator,this.importParams.parentPageTitle=this.translate.tableNameParticipator,this.importParams.importBtnType=[{url:"/formEngine/batchOperations",method:"put",name:this.translate.incrementImport,isShowBtn:!0,success:function(e){e.state&&(t.importPartners=!1,t.tableShowControl=!0)}}],this.data&&this.data.appData?(this.data.appData.app?(this.curApp=JSON.parse(i()(this.data.appData.app)),this.curUserType=this.curApp.appType.userType):(this.curApp=JSON.parse(i()(this.data.appData)),this.curUserType=this.curApp.appType.userType),this._initBusinessList()):(this.$waiting.show(),setTimeout(function(){t.$waiting.close()},5e3),Object(c.e)({url:"/api/app/"+this.data.data.id,type:"get",success:function(e){e.state?(t.curApp=e.data,t._initBusinessList()):t.$toast(e.message)}}).always(function(){t.$waiting.close()}))},watch:{appData:function(){this.appData?(this.appData.app?this.curApp=JSON.parse(i()(this.appData.app)):this.curApp=JSON.parse(i()(this.appData)),this._initBusinessList()):this.curApp=null},windowObj:{deep:!0,handler:function(t){var e=125;if(this.collegeComparison&&(e+=48),this.instructorComparison&&(e+=48),2===this.previousIndexArr[0]||3===this.previousIndexArr[0]?1===this.curCheckType&&(e+=53):2!==this.curCheckType&&3!==this.curCheckType&&4!==this.curCheckType||(e-=53),n()(document).height()<877&&n()(document).height()>600){var a=n()(document).height()-200;n()(".count-modal .modal-content").css("height",a+"px"),this.setHeight=a-88,this.countItemHeight=a-88-e,this.countContentHeight=a-80,this.combContentHeight=a-205}else n()(".count-modal .modal-content").css("height","720px"),this.setHeight=628,this.countContentHeight=635,this.combContentHeight=510,this.countItemHeight=628-e}}},mounted:function(){var t=this;n()(".app-detail-page-form").off("click"),n()(".app-detail-page-form").on("click",".guide-content img",function(e){var a=n()(t).attr("src");a.indexOf(t.imageUrlPrefix)>=0&&t.$preview({type:"png",url:a})}),n()(".app-detail-page-form").on("click",".guide-content a",function(e){var a=n()(t).attr("href");if(a.indexOf(t.fileUrlPrefix)>=0){if(e.preventDefault(),/(iP)/g.test(navigator.userAgent))return t.$toast("您的ios设备不支持附件下载，请用其它设备打开！造成不便尽请谅解~"),!1;var s=document.createElement("iframe");s.src=a,s.style.display="none",document.body.appendChild(s)}})},methods:{_srotClick:function(t,e){e&&(this.sortParams="&sort="+t+"-"+e)},_baobiaoExport:function(){var t="";if(1==this.opt)for(var e=0;e<this.length;e++)e==this.length-1?t+="school":t+="school,";else if(2==this.opt)for(e=0;e<this.length;e++)e==this.length-1?t+="college":t+="college,";else if(3==this.opt)for(e=0;e<this.length;e++)e==this.length-1?t+="instructor":t+="instructor,";else if(4==this.opt)for(e=0;e<this.length;e++)e==this.length-1?t+="class":t+="class,";var a=this.advancedSearchParams;a=a||"",window.location.href="/downloads/report/"+this.curBusinessId+"/Excel/formInstances?range="+t+"&playerId="+this.playerId+"&tableName="+this.tableName+"&excelName="+this.curApp.name+"报表"+a},_checkBiao:function(t){this.clickIndex=t},_setValue:function(t){var e=this;this.opt=t;var a="";1==t?a="school":2==t?a="college":3==t?a="instructor":4==t&&(a="class");var s=this.$refs[this.curTab+"_table"].tableSearchFields,i=s.userNo?s.userNo:"",o=s.account?s.account:"",n=s.name?s.name:"",r=s.educationLevel?s.educationLevel:"",l=s.collegeCode?s.collegeCode:"",u=s.grade?s.grade:"",d=this.advancedSearchParams;d=d||"",Object(c.e)({url:"/api/report/"+this.curBusinessId+"/report/formInstances?range="+a+"&playerId="+this.playerId+"&userNo="+i+"&account="+o+"&name="+n+"&educationLevel="+r+"&collegeCode="+l+"&grade="+u+d,dataType:"json",type:"get",success:function(t){t.state&&null!==t.data?e.jisuanArray=t.data:e.$toast("未获取到报表信息")}})},_showBaobiao:function(){var t=this,e=this.$refs[this.curTab+"_table"].tableSearchFields,a=e.userNo?e.userNo:"",s=e.account?e.account:"",i=e.name?e.name:"",o=e.collegeCode?e.collegeCode:"",n=e.grade?e.grade:"",r=e.educationLevel?e.educationLevel:"",l=this.advancedSearchParams;l=l||"",this.tableName="",this.opt=1;Object(c.e)({url:"/api/report/"+this.curBusinessId+"/report/formInstances?range=school&playerId="+this.playerId+"&userNo="+a+"&account="+s+"&name="+i+"&collegeCode="+o+"&educationLevel="+r+"&grade="+n+l,dataType:"json",type:"get",success:function(e){if(e.state&&null!==e.data){t.showBaobiaomodel=!0,t.jisuanArray=e.data;for(var a=0;a<e.data.length;a++)t.length=e.data.length,a==e.data.length-1?t.tableName+=e.data[a].reportName:t.tableName+=e.data[a].reportName+","}else t.$toast("未获取到报表信息")}})},_mergeTable:function(){this.isMergeTable=!this.isMergeTable},_addForm:function(){var t=this;this.log="",this.collapsed=!0,this.instanceId="",this.$waiting.show(),this._getFormLayoutCheck(this.curBusinessId,function(e){t.playerId="owner",t.formData_check=e,t.formData_components_check=e.components,t.formData_name_check=e.name,t.formData_property_script_check=e.property.script,t.formData_components_check.forEach(function(e){t.$set(e,"x",e.location.left),t.$set(e,"y",e.location.top),t.$set(e,"w",e.size.width),t.$set(e,"h",e.size.height)}),t.showPlayerForm=!0,t.$waiting.close(),t.recordData=null,t.log=null})},_initHistoryColumn:function(t){var e=this._getStorage();t?this.myFormsColumn.forEach(function(t){e.forEach(function(e){t.id&&t.id===e.id&&(t.hidden=e.hidden)})}):this.columns.forEach(function(t){e.forEach(function(e){t.id&&t.id===e.id&&(t.hidden=e.hidden)})})},_getStorage:function(){if(!this.curTab)return[];var t=this.curTab+"+"+(this.$account&&this.$account.id+this.$account.schoolId||"default_form"),e=localStorage.getItem(t);return e?JSON.parse(e):[]},_setStorage:function(t){var e=this.curTab+"+"+(this.$account&&this.$account.id+this.$account.schoolId||"default_form"),a=i()(t||this.columns);localStorage.setItem(e,a)},_setStorageOfTab:function(t){var e="nodeKey_"+(this.$account&&this.$account.id+this.$account.schoolId||"default_form")+this.curBusinessId,a={name:this.curTab};t&&(a.data=t);var s=i()(a);localStorage.setItem(e,s)},_getStorageOfTab:function(){var t="nodeKey_"+(this.$account&&this.$account.id+this.$account.schoolId||"default_form")+this.curBusinessId,e=localStorage.getItem(t);return e?JSON.parse(e):{}},_columnExchanged:function(){this._setStorage()},_columnExchanged2:function(){this._setStorage(this.myFormsColumn)},_afterSelectBusiness:function(t){this._getBusinessTime()},_getBusinessTime:function(){var t=this;this.curBusinessId&&Object(c.e)({url:"/api/app/business/"+this.curBusinessId+"/players/time",type:"get",success:function(e){e.state?t.playersTime=e.data:t.$toast(e.message)}})},_initBusinessList:function(){var t=this;Object(c.e)({url:"/api/app/"+this.curApp.id+"/business/now",type:"get",success:function(e){if(e.state)if(e.data&&e.data.length>0){t.businessList=e.data,t.businessList.forEach(function(t){t.id=t.business.id,t.name=t.business.name}),t.curBusinessId=t.businessList[0].id,t.multiForm=t.businessList[0].multiForm,t._initTableColumns(),t._initMyFormTableColumns(),t._getBusinessTime();var a=t._getStorageOfTab();t.curTab=a&&a.name||"guide",setTimeout(function(){"guide"===t.curTab?t.guide():"preview"===t.curTab?t.curBusiness.canApplyOnAuthority?t.myForm():t.guide():t.showPlayerTable(a.data)},100)}else t.errorMessage="暂无业务期";else t.$toast(e.message)}})},_getCountData:function(){var t=this;this.playerId&&(this.countItemHeight=125,this.countItemSelectArr=[],this.previousIndexArr=[],this.combinationCountItemData=[],this.saveCountData.combCountItemData=[],Object(c.e)({url:"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics/settings?playerId="+this.playerId,type:"get",success:function(e){e.state?(t.curCountItems=e.data.items,t.curCountItems.forEach(function(e){t.countItemSelectArr.push(e.name)}),t.collegeComparison=e.data.collegeComparison,t.instructorComparison=e.data.instructorComparison,e.data.collegeComparison&&(t.countItemHeight=t.countItemHeight+48),e.data.instructorComparison&&(t.countItemHeight=t.countItemHeight+48),t.countRadios=[{label:"总览",value:1,isChecked:!0,isShow:!0},{label:"各学院对比",value:2,isChecked:!1,isShow:e.data.collegeComparison},{label:"各辅导员对比",value:3,isChecked:!1,isShow:e.data.instructorComparison},{label:"各班级对比",value:4,isChecked:!1,isShow:e.data.classComparison}],Object(c.e)({url:"/api/statistics/business/"+t.curBusinessId+"/settings/cache?playerId="+t.playerId,type:"get",success:function(e){if(e.state){if(e.data){var a=JSON.parse(e.data.data);if(a.oldCountItemData.length>0)if(t.countTabActive=a.countTabActive,t.defaultOptions.studentType=a.select.studentType,t.defaultOptions.college=a.select.college,t.defaultOptions.grade=a.select.grade,t.countItemData=a.oldCountItemData,t.newAddcountItem=a.newAddcountItem,0===a.countType.id){if(t.isRecordCurOptionsArr=!1,t.isCollegeOrPlayer=!1,t.historyCountData=a.countData,t.combinationCountItemData=a.combCountItemData,t.historyCountOptions=a.countOptionArray,t.newAddcountItem.length>0)JSON.parse(i()(t.newAddcountItem)).reverse().forEach(function(e){var a=[];e.details.forEach(function(t){a.push(t.name)}),t.curCountItems.unshift({title:e.title,name:e.name,combination:e.combination,options:a})});t.getAllCountData("record"),t.countItemSelectArr=a.countItemSelectArr}else t._changeRadio(a.countType.id,a.countType.value);else t.getAllCountData("getData")}else t.getAllCountData("getData");0===t.previousIndexArr.length&&t.countRadios.forEach(function(e){e.isChecked&&t.previousIndexArr.push(e.value)})}else t.$toast(e.message);if(n()(document).height()<877&&n()(document).height()>600){var s=n()(document).height()-200;n()(".count-modal .modal-content").css("height",s+"px"),t.setHeight=s-88,t.countItemHeight=t.setHeight-t.countItemHeight,t.countContentHeight=s-80,t.combContentHeight=s-205}else n()(".count-modal .modal-content").css("height","720px"),t.setHeight=628,t.countContentHeight=635,t.combContentHeight=510,t.countItemHeight=628-t.countItemHeight}})):t.$toast(e.message)}}))},getAllCountData:function(t){var e=this;this.isRecordCurOptionsArr=!1,this.$waiting.show(),Object(c.e)({url:"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics?playerId="+this.playerId+"&grade="+this.countSearchGrade+"&studentType="+this.countSearchStudentType+"&collegeCode="+this.countSearchCollegeCode,type:"post",data:{statisticsItems:this.curCountItems},success:function(a){if(a.state){if(e.countData=a.data,"getData"===t&&(e.combinationCountItemData=[],e.saveCountData.combCountItemData=[],e.countItemData=JSON.parse(i()(a.data)),a.data.forEach(function(t){t.combination||(e.combinationCountItemData.push(JSON.parse(i()(t))),e.saveCountData.combCountItemData.push(JSON.parse(i()(t))))})),e.historyCountOptions.length>0?e.countOptionArr.selectArr=e.historyCountOptions:(e.countOptionArr.selectArr=[],e.countItemData.forEach(function(t,a){var s=[];JSON.parse(i()(t.details)).forEach(function(t){s.push(t.name)}),e.countOptionArr.selectArr.push({id:a,value:s})})),"record"===t){for(var s in e.countData){var o=e.countData[s].name,n=e.countData[s].details,c=0;for(var r in e.historyCountData){var l=e.historyCountData[r].name,u=e.historyCountData[r].details;if(o===l)for(var d in c++,n){for(var h in u)n[d].name===u[h].name&&(0,delete u[h].percent,u[h].count=n[d].count)}}if(0===c){var p=e.countData.length-e.historyCountData.length;e.countData.splice(s,p)}}e.countData=[],e.countData=JSON.parse(i()(e.historyCountData))}}else e.$toast(a.message)}}).always(function(){e.$waiting.close()})},backParentPage:function(){this.importPartners=!1,this.tableShowControl=!0},exportOperation:function(){this._output(),this.searchControl=!1},bulkOperation:function(){this.curPlayer.batch&&(this.importPartners=!0,this.tableShowControl=!1,this.searchControl=!1)},unfoldAndfold:function(){this.collapsed=!this.collapsed},showPlayerTable:function(t){var e=this;this.curPlayerType=t.distributary,this.curPlayer=t,this.showPlayerForm=!1,this.myFormPreview=!1,this.curTab=this.curPlayer.name,this.playerId=this.curPlayer.id,this.partnerContent=!0,this.collapsed=!0,this.url="",this._initTableColumns(function(){e.url="/table-data/formEngine/business/"+e.curBusinessId+"/formInstances?playerId="+e.playerId+"&timeStamp="+Object(c.a)()}),this.playersTime.forEach(function(a){if(a.playerId===t.id){var s=a.startDate?a.startDate:"未设置",i=a.endDate?a.endDate:"未设置";e.curBusinessTime="开始时间: "+s+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;结束时间: "+i}}),this.importParams.downloadTemplateUrl="/formEngine/business/"+this.curBusinessId+"/batchOperationsTemplate/excel?playerId="+this.playerId,this.importParams.checkTemplateUrl="/formEngine/business/"+this.curBusinessId+"/player/"+this.playerId+"/batchOperations/check",this.importParams.downloadErrorTemplateUrl="/formEngine/errExcel",this._setStorageOfTab(t),this._focus()},_focus:function(){var t=this;"preview"!==this.curTab&&setTimeout(function(){t.$refs[t.curTab+"_table"].getFocus("userNo")},100)},guide:function(){"preview"!==this.curTab&&"guide"!==this.curTab&&this._setStorage(),this.showPlayerForm=!1,this.curTab="guide",this.partnerContent=!1,this.myFormPreview=!1,this._setStorageOfTab()},myForm:function(){var t=this;this.multiForm?this._setStorage(this.myFormsColumn):"preview"!==this.curTab&&"guide"!==this.curTab&&this._setStorage(this.myFormsColumn),this.multiForm?(this.myFormTableUrl="",this._initMyFormTableColumns(function(){t.myFormTableUrl="/table-data/formEngine/business/"+t.curBusinessId+"/multi/myFormInstances?timeStamp="+Object(c.a)()}),this.backControl=!1,this.showPlayerForm=!1,this.partnerContent=!1,this.myFormPreview=!0,this.curTab="preview",this._setStorageOfTab()):(this.log="",this.collapsed=!0,this.$waiting.show(),this.curBusiness.canApplyOnAuthority&&(this._getFormLayout(this.curBusinessId,function(e){t.playerId="owner",t.formData=e,t.formData_components=e.components,t.formData_name=e.name,t.formData_property_script=e.property.script,t.formData_components.forEach(function(e){t.$set(e,"x",e.location.left),t.$set(e,"y",e.location.top),t.$set(e,"w",e.size.width),t.$set(e,"h",e.size.height)}),t._getInitData(t.curBusinessId,function(e){t.recordData=e,t.myFormPreview=!0,t.$waiting.close(),t.recordData&&(t.instanceId=t.recordData.id,t._getLog(t.recordData.id,t.playerId,t.curBusinessId,function(e){t.log=e||null}))})}),this.backControl=!1,this.showPlayerForm=!1,this.partnerContent=!1,this.curTab="preview",this._setStorageOfTab()))},_getLog:function(t,e,a,s){var i=this;Object(c.e)({url:"/api/formEngine/formInstances/"+t+"/changeLogs?playerId="+e+"&businessId="+a,type:"get",success:function(t){t.state?s(t.data):i.$toast(t.message)}})},_sureToOutput:function(){var t=this,e=this.$refs[this.curTab+"_table"].tableSearchFields,a="",s=[],o=[],n=[],r=!1,l=!1,u="",d=[];for(var h in e)e[h]?a+="&"+h+"="+e[h]:a+="&"+h+"=";(s=JSON.parse(i()(this.outputList))).forEach(function(t,e){(t.indexOf("image")>=0||t.indexOf("signature")>=0||t.indexOf("attachment")>=0)&&s.splice(e,1)}),this.exportFiledArr.forEach(function(t){(t.name.indexOf("image")>=0||t.name.indexOf("signature")>=0||t.name.indexOf("attachment")>=0)&&(o.push(t.name),n.push(t.title))});var p=this.advancedSearchParams;p=p||"",s.length>0&&(this.$waiting.show(),Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/formInstances/filename?playerId="+this.playerId+"&fileName="+this.curApp.name+"&mergeTables="+this.isMergeTable+"&exportFields="+s+a+p,type:"get",success:function(e){e.state?(r=!0,u=e.data.key,t._downloadsZip(r,l,d,u)):t.$toast(e.message)}}).always(function(){t.$waiting.close()})),Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/formInstances/images?playerId="+this.playerId+"&componentName="+o+"&fileName="+n+p,type:"get",success:function(e){e.state?(l=!0,d=e.data,t._downloadsZip(r,l,d,u)):t.$toast(e.message)}}).always(function(){t.$waiting.close()}),this.outputModalShow=!1},_downloadsZip:function(t,e,a,s){var i=this.advancedSearchParams;i=i||"",t&&e&&(window.location.href="/downloads/formEngine/formInstances/allZip?zipName="+this.curApp.name+"&allZipPath="+a+"&filePath="+s+i)},_changeOutputList:function(t){var e=this,a=this.outputList.indexOf(t.name);a>=0?(this.outputList.splice(a,1),"signature"!==t.componentType&&"image"!==t.componentType&&"attachment"!==t.componentType||this.exportFiledArr.forEach(function(a,s){a.name===t.name&&e.exportFiledArr.splice(s,1)})):(this.outputList.push(t.name),"signature"!==t.componentType&&"image"!==t.componentType&&"attachment"!==t.componentType||this.exportFiledArr.push({name:t.name,title:t.title}))},_output:function(){var t=this,e=this.advancedSearchParams;e=e||"",Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/exportFields?playerId="+this.playerId+e,type:"get",success:function(e){e.state?e.data.length>0?(t.exportFiledArr.splice(0,t.exportFiledArr.length),t.formFields=e.data,t.outputList=[],t.outputList=[],t.formFields.forEach(function(e){t.outputList.push(e.name),"signature"!==e.componentType&&"image"!==e.componentType&&"attachment"!==e.componentType||t.exportFiledArr.push({name:e.name,title:e.title})}),t.outputModalShow=!0):t.$toast("此表单不允许导出"):t.$toast(e.message)}})},_getInitData:function(t,e){var a=this;Object(c.e)({url:"/api/formEngine/business/"+t+"/myFormInstance",type:"get",success:function(t){t.state?(t.data&&t.data.editable||(a.saveBtnContrl=!1),e(t.data)):(a.$waiting.close(),a.$toast(t.message))}})},_getInitDataCheck:function(t,e){var a=this,s="";s="preview"===this.curTab?"owner":this.playerId,Object(c.e)({url:"/api/formEngine/formInstance/"+t,type:"get",data:{playerId:s},success:function(t){t.data.editable||(a.saveBtnContrl=!1),t.state?e(t.data):a.$toast(t.message)}})},_initMyFormTableColumns:function(t){var e=this;this.myFormsColumn=[{id:"createTime",title:"发起时间",search:{type:"datetime",data:{dateFormat:"yyyy-MM-dd hh:ii:ss"}},className:"text-left",hidden:!1},{id:"opt",title:"操作",className:"text-center",width:70,hidden:!1,formatter:function(){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(t,a){e.$waiting.show(),e.instanceId=t.id,e._getFormLayoutCheck(e.curBusinessId,function(a){e.formData_check=a,e.formData_components_check=a.components,e.formData_name_check=a.name,e.formData_property_script_check=a.property.script,e.formData_components_check.forEach(function(t){e.$set(t,"x",t.location.left),e.$set(t,"y",t.location.top),e.$set(t,"w",t.size.width),e.$set(t,"h",t.size.height)}),e._getInitDataCheck(t.id,function(a){e.recordData=a,e.showPlayerForm=!0,e.$waiting.close(),e._getLog(t.id,"owner",e.curBusinessId,function(t){e.log=t||null})})})}}]}}],Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/table/fields?playerId=owner",type:"get",success:function(a){a.state?(a.data.forEach(function(a){if(e.notAllowShow.indexOf(a.componentType)<0){var s={id:"f_"+a.name,title:(e.baseFields.indexOf(a.title)>=0?"":"表单")+a.title,className:"text-left",width:150,formatter:function(t,e){return"signature"===a.componentType?t.formData[a.name]?"已签名":"未签名":t.formData[a.name]}};if(e.$set(s,"hidden",!a.visibleInTableColumn),a.name.indexOf("number")>-1&&(e.$set(s,"sort",!0),e.$set(s,"ComName",a.name)),e.columnSearchType[a.componentType]){var i=[];a.options.forEach(function(t){i.push({id:t,name:t})}),s.search={type:e.columnSearchType[a.componentType],data:{options:i,dateFormat:a.dateFormat}}}e.myFormsColumn.splice(e.myFormsColumn.length-1,0,s),t&&t()}}),e._initHistoryColumn(e.myFormsColumn)):e.$toast(a.message)}})},_initTableColumns:function(t){var e=this;if(this.playerId){var a=[{id:"userNo",title:"2"===this.curUserType?this.translate.infoFields.teacherId:"4"===this.curUserType?"学工号":this.translate.infoFields.studentId,className:"text-left",width:115,hidden:!1,search:{type:"input",data:{autoFocus:!0}},formatter:function(t){return t.owner.userNo}},{id:"account",title:this.translate.infoFields.freshmanId,className:"text-left",width:115,hidden:!1,search:{type:"input"},formatter:function(t){return t.owner.account}},{id:"name",title:"姓名",className:"text-left",width:100,hidden:!1,search:{type:"input"},formatter:function(t){return t.owner.name}},{id:"collegeCode",title:this.translate.infoFields.collegeName,className:"text-left",width:150,hidden:!1,search:{type:"select",data:{url:"/api/formEngine/business/"+this.curBusinessId+"/managedColleges?playerId="+this.playerId,optionsLabel:"name",optionsValue:"code",placeholder:this.translate.infoFields.collegeName}},formatter:function(t){return t.owner.collegeName}}];"4"===this.curUserType||"2"===this.curUserType?a.push({id:"updateTime",title:"发起时间",width:200,search:{type:"datetime",data:{dateFormat:"yyyy-MM-dd hh:ii:ss"}},className:"text-left",hidden:!1}):a.push({id:"educationLevel",title:"培养层次",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{url:"/api/system/dictTypes/1000/dicts",optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.owner.educationLevel}}),a.push({title:"操作",className:"text-center",width:70,hidden:!1,formatter:function(){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(t,a){e.instanceId=t.id,e.$waiting.show(),e._getFormLayoutCheck(e.curBusinessId,function(a){e.formData_check=a,e.formData_components_check=a.components,e.formData_name_check=a.name,e.formData_property_script_check=a.property.script,e.formData_components_check.forEach(function(t){e.$set(t,"x",t.location.left),e.$set(t,"y",t.location.top),e.$set(t,"w",t.size.width),e.$set(t,"h",t.size.height)}),e._getInitDataCheck(t.id,function(a){e.recordData=a,e.showPlayerForm=!0,e.$waiting.close(),e._getLog(t.id,e.playerId,e.curBusinessId,function(t){e.log=t||null})})})}}]}}),this.columns=a,"3"!==this.curUserType&&this.columns.splice(1,1),Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/table/fields?playerId="+this.playerId,type:"get",success:function(a){a.state?a.data.forEach(function(a){if(e.notAllowShow.indexOf(a.componentType)<0){var s={id:"f_"+a.name,title:(e.baseFields.indexOf(a.title)>=0?"表单":"")+a.title,className:"text-left",width:150,formatter:function(t,e){return"signature"===a.componentType?t.formData[a.name]?"已签名":"未签名":t.formData[a.name]}};if(e.$set(s,"hidden",!a.visibleInTableColumn),a.name.indexOf("number")>-1&&(e.$set(s,"sortType",null),e.$set(s,"sorting",!0),e.$set(s,"ComName",a.name)),e.columnSearchType[a.componentType]){var i=[];a.options.forEach(function(t){i.push({id:t,name:t})}),s.search={type:e.columnSearchType[a.componentType],data:{options:i,dateFormat:a.dateFormat}}}e.columns.splice(e.columns.length-1,0,s),t&&t()}}):e.$toast(a.message)}})}},_getFormLayout:function(t,e){var a=this;Object(c.e)({url:"/api/formEngine/business/"+t+"/formRenderData",type:"get",data:{playerId:"owner"},success:function(t){t.state?e(t.data):a.$toast(t.message)}})},_getFormLayoutCheck:function(t,e){var a=this,s="";s="preview"===this.curTab?"owner":this.playerId,Object(c.e)({url:"/api/formEngine/business/"+t+"/formRenderData",type:"get",data:{playerId:s,withData:this.multiForm},success:function(t){t.state?e(t.data):a.$toast(t.message)}})},_submit:function(t){var e=this;if(this.saveBtnContrl)if("childerPage"===t.previewformType){var a=void 0,s={},i="";"submit"===t.type&&("preview"===this.curTab?(a="/api/formEngine/formInstances",s={formData:t.formData,id:this.instanceId,variable:{appId:this.data.appData.id,businessId:this.curBusinessId}},i="post"):(a="/api/formEngine/formInstance/"+this.recordData.id,s={formData:t.formData,playerId:this.playerId},i="put")),Object(c.e)({url:a,type:i,data:s,success:function(a){a.state?(e.instanceId=a.data.id,confirm("保存成功！是否返回列表页")&&(e.preview=!1,"submit"===t.type&&(e.showPlayerForm=!1,"preview"===e.curTab&&(e.myFormTableUrl="/table-data/formEngine/business/"+e.curBusinessId+"/multi/myFormInstances?timeStamp="+Object(c.a)())))):e.$toast(a.message)}})}else if(confirm("确认保存?")){var o=void 0;"submit"===t.type&&(o="/api/formEngine/formInstance/"+this.recordData.id);var n=t.formData.map(function(t){return"定位"===t.title&&delete t.value.locationValue.target,t});Object(c.e)({url:o,type:"put",data:{formData:n,playerId:this.playerId},success:function(a){a.state?(e.preview=!1,"submit"===t.type&&e.$toast("保存成功")):e.$toast(a.message)}}).always(function(){e.$waiting.close()})}},exportModel:function(){var t=this.advancedSearchParams;t=t||"",""!=this.playerId&&null!=this.playerId||(this.playerId="owner"),window.location.href="/downloads/manageWord/"+this.data.appData.id+"/formFiles?instanceId="+this.instanceId+"&playerId="+this.playerId+t},_back:function(){this.$emit("back")},formatDateTime:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1;a=a<10?"0"+a:a;var s=t.getDate();return e+"-"+a+"-"+(s=s<10?"0"+s:s)},_showCountModal:function(){var t=this;this.countModal=!0,this.collegeSelectOptions.splice(0,this.collegeSelectOptions.length),this._getCountData(),Object(c.e)({url:"/api/formEngine/business/"+this.curBusinessId+"/managedColleges?playerId="+this.playerId,type:"get",success:function(e){if(e.state)for(var a in t.collegeSelectOptions.push({code:"0",name:"所有"}),e.data)t.collegeSelectOptions.push(e.data[a]);else t.$toast(e.message)}}),this.dictTypes.splice(0,this.dictTypes.length),Object(c.e)({url:"/api/system/dicts",type:"get",data:{dictType:"学生类别"},success:function(e){if(e.state)for(var a in t.dictTypes.push({label:"所有",value:"0"}),e.data)t.dictTypes.push(e.data[a]);else t.$toast(e.message)}}),this.gradeOptions.splice(0,this.gradeOptions.length);var e=(new Date).getFullYear();this.gradeOptions.push({id:"0",label:"所有"});for(var a=e;a>e-8;a--)this.gradeOptions.push({id:a+"",label:a+"级"})},_changeRadio:function(t,e){var a=this;if(this.saveCountData.countType.id=t,this.saveCountData.countType.value=e,this.countRadios.forEach(function(t){t.isChecked=!1}),this.countOptionSelectArr=[],this.countRadios[t].isChecked=!0,this.curCheckType=e.value,2===this.previousIndexArr.length&&this.previousIndexArr.splice(0,1),this.previousIndexArr.push(e.value),this.saveHistoryData(this.previousIndexArr[0]),this.countOptionArr.selectArr=[],2===this.previousIndexArr[0]||3===this.previousIndexArr[0]?1===this.curCheckType&&(this.countItemHeight=this.countItemHeight-53):2!==this.curCheckType&&3!==this.curCheckType&&4!==this.curCheckType||(this.countItemHeight=this.countItemHeight+53),1===this.curCheckType)if(this.isCollegeOrPlayer=!1,this.overviewHistoryData.countData.length>0)this.countData=JSON.parse(i()(this.overviewHistoryData.countData)),this.countItemData=JSON.parse(i()(this.overviewHistoryData.countItemData)),this.countItemSelectArr=JSON.parse(i()(this.overviewHistoryData.countItemSelectArr)),this.countOptionArr.selectArr=JSON.parse(i()(this.overviewHistoryData.countOptionSelectArr));else{if(this.newAddcountItem.length>0)JSON.parse(i()(this.newAddcountItem)).reverse().forEach(function(t){var e=[];t.details.forEach(function(t){e.push(t.name)}),a.curCountItems.unshift({title:t.title,name:t.name,combination:t.combination,options:e})});this.getAllCountData("getData")}else{this.isCollegeOrPlayer=!0;var s=[];this.countItemData.forEach(function(t,e){t.combination||s.push(JSON.parse(i()(t)))}),this.countItemData=[],this.countItemData=s,this.curStatisticsItems=[],this.multipleSelectComparison=[],this.countItemData.forEach(function(t,e){a.$set(t,"isChecked",!0),a.curSelectCountData=t,a.saveCountData.countItemData.value=t;var s=[];t.details.forEach(function(t){s.push(t.name)}),a.curStatisticsItems.push({title:t.title,name:t.name,combination:!1,options:s}),a.multipleSelectComparison.push(t.name)}),this.getCollegeOrPlayerData()}},saveHistoryData:function(t){1===t?(this.overviewHistoryData.countData=JSON.parse(i()(this.countData)),this.overviewHistoryData.countItemData=JSON.parse(i()(this.countItemData)),this.overviewHistoryData.countItemSelectArr=JSON.parse(i()(this.countItemSelectArr)),this.overviewHistoryData.countOptionSelectArr=JSON.parse(i()(this.countOptionArr.selectArr))):2===t?(this.collegeHistoryData.countData=JSON.parse(i()(this.countData)),this.collegeHistoryData.countItemData=JSON.parse(i()(this.countItemData)),this.collegeHistoryData.countOptionSelectArr=JSON.parse(i()(this.countOptionArr.selectArr))):(this.instructorHistoryData.countData=JSON.parse(i()(this.countData)),this.instructorHistoryData.countItemData=JSON.parse(i()(this.countItemData)),this.instructorHistoryData.countOptionSelectArr=JSON.parse(i()(this.countOptionArr.selectArr)))},_changeCountRadio:function(t,e){var a=this,s=this.multipleSelectComparison.indexOf(e.name);if(s>=0)this.multipleSelectComparison.splice(s,1),this.curStatisticsItems.forEach(function(t,s){e.name===t.name&&a.curStatisticsItems.splice(s,1)}),this.countItemData.forEach(function(t){e.name===t.name&&(t.isChecked=!1)}),this.newCollegeOrPlayerData.forEach(function(t,a){t.details.forEach(function(t,a){e.name===t.name&&(t.isShow=!1)})});else{this.multipleSelectComparison.push(e.name);var i=[];e.details.forEach(function(t){i.push(t.name)}),this.curStatisticsItems.push({title:e.title,name:e.name,combination:!1,options:i}),this.countItemData.forEach(function(t){e.name===t.name&&(t.isChecked=!0)}),this.newCollegeOrPlayerData.forEach(function(t,a){t.details.forEach(function(t,a){e.name===t.name&&(t.statisticsResult=[],t.statisticsResult=e.details,t.isShow=!0)})})}this.saveCountData.countItemData.id=t,this.saveCountData.countItemData.value=e,this.curSelectCountData=e},getCollegeOrPlayerData:function(){var t=this;this.$waiting.show(),this.newCollegeOrPlayerData=[],Object(c.e)({url:this.curCountUrl,type:"post",data:{statisticsItems:this.curStatisticsItems},success:function(e){e.state?(2===t.curCheckType?e.data.forEach(function(e){e.statisticsResultList.forEach(function(e,a){t.$set(e,"isShow",!0)}),t.newCollegeOrPlayerData.push({title:e.college.name,name:e.college.code,isShow:!0,details:e.statisticsResultList})}):3===t.curCheckType?e.data.forEach(function(e){e.statisticsResultList.forEach(function(e,a){t.$set(e,"isShow",!0)}),t.newCollegeOrPlayerData.push({title:e.user.name,name:e.user.userId,isShow:!0,details:e.statisticsResultList})}):4===t.curCheckType&&e.data.forEach(function(e){e.statisticsResultList.forEach(function(e,a){t.$set(e,"isShow",!0)}),t.newCollegeOrPlayerData.push({title:e.clazz.classFullName,name:e.clazz.classId,isShow:!0,details:e.statisticsResultList})}),t.saveCollegeOrPlyaerCountData=JSON.parse(i()(t.newCollegeOrPlayerData))):t.$toast(e.message)}}).always(function(){t.$waiting.close()})},_afterSelectDisTypes:function(t){var e=this;"0"!==t.val&&t.val?(this.countSearchStudentType=t.val,this.countStudentTypeName=t.target.selected):this.countSearchStudentType="","0"===t.val?(this.saveCountData.select.studentType="0",this.defaultOptions.studentType="0"):(this.defaultOptions.studentType=this.countSearchStudentType,this.saveCountData.select.studentType=this.defaultOptions.studentType),this.isCollegeOrPlayer?this.getCollegeOrPlayerData():(this.curCountItems=[],this.countData.forEach(function(t){var a=[];t.details.forEach(function(t){a.push(t.name)}),e.curCountItems.push({title:t.title,name:t.name,combination:t.combination,options:a})}),this.getAllCountData("search"))},_afterSelectCollege:function(t){var e=this;"0"!==t.val&&t.val?(this.countSearchCollegeCode=t.val,this.countCollegeName=t.target.selected):this.countSearchCollegeCode="","0"===t.val?(this.defaultOptions.college="0",this.saveCountData.select.college="0"):(this.defaultOptions.college=this.countSearchCollegeCode,this.saveCountData.select.college=this.defaultOptions.college),this.isCollegeOrPlayer?this.getCollegeOrPlayerData():(this.curCountItems=[],this.countData.forEach(function(t){var a=[];t.details.forEach(function(t){a.push(t.name)}),e.curCountItems.push({title:t.title,name:t.name,combination:t.combination,options:a})}),this.getAllCountData("search"))},_afterSelectGrade:function(t){var e=this;"0"!==t.val&&t.val?(this.countSearchGrade=t.val,this.countGradeName=t.target.selected):this.countSearchGrade="","0"===t.val?(this.defaultOptions.grade="0",this.saveCountData.select.grade="0"):(this.defaultOptions.grade=this.countSearchGrade,this.saveCountData.select.grade=this.defaultOptions.grade),this.isCollegeOrPlayer?this.getCollegeOrPlayerData():(this.curCountItems=[],this.countData.forEach(function(t){var a=[];t.details.forEach(function(t){a.push(t.name)}),e.curCountItems.push({title:t.title,name:t.name,combination:t.combination,options:a})}),this.getAllCountData("search"))},_checkCountItem:function(t,e){var a=this,s=this.countItemSelectArr.indexOf(t.name);if(this.isCombination=!1,s>=0){if(this.isCollegeOrPlayer||(this.isRecordCurOptionsArr=!0),this.countItemSelectArr.splice(s,1),!this.isCollegeOrPlayer){this.newAddcountItem.length;this.countOptionArr.selectArr.forEach(function(t,s){t.id===e&&a.countOptionArr.selectArr.splice(s,1)})}this.countData.forEach(function(e,s){e.name===t.name&&a.countData.splice(s,1)})}else{if(this.countItemSelectArr.push(t.name),this.countData=[],this.newAddcountItem.length>0)JSON.parse(i()(this.newAddcountItem)).reverse().forEach(function(t,e){a.countData.unshift(t)});if(this.countItemData.forEach(function(t,e){a.countItemSelectArr.indexOf(t.name)>=0&&a.countData.push(JSON.parse(i()(t)))}),!this.isCollegeOrPlayer){var o=[];t.details.forEach(function(t){o.push(t.name)});var n={id:e,value:o};this.countOptionArr.selectArr.splice(e,0,n),this.countOptionArr.selectArr.forEach(function(t,e){0===t.value.length&&a.countOptionArr.selectArr.splice(e,1)}),this.countOptionArr.selectArr=this.countOptionArr.selectArr.sort(this.compare("id")),this.countData.forEach(function(t,e){if(a.countOptionArr.selectArr[e].id===e){var s=JSON.parse(i()(t.details));delete t.details,a.$set(t,"details",[]),s.forEach(function(s,i){a.countOptionArr.selectArr[e].value.indexOf(s.name)>=0&&t.details.push(s)})}})}}},compare:function(t){return function(e,a){return e[t]-a[t]}},_clickCountItem:function(t,e,a){var s=this;n()(t.target).siblings(".count-list-more").addClass("display-block"),n()(t.target).siblings(".count-list-more").removeClass("display-none"),this.countOptionIndex=a,this.curCountOptions=e,this.countOptionMark=e.name,this.isCombination=e.combination,this.countOptionData=JSON.parse(i()(e)),this.countOptionArr.selectArr.forEach(function(t){t.id===a&&(s.countOptionSelectArr=t.value)})},_checkCountOption:function(t){var e=this,a=this.countOptionSelectArr.indexOf(t.name);if(this.isCollegeOrPlayer)a>=0?(this.countOptionSelectArr.splice(a,1),0===this.countOptionSelectArr.length?(this._changeCountRadio(this.countOptionIndex,this.curCountOptions),n()(".count-list-more").addClass("display-none"),n()(".count-list-more").removeClass("display-block")):this.newCollegeOrPlayerData.forEach(function(a,s){a.details.forEach(function(a){a.name===e.countOptionMark&&a.statisticsResult.forEach(function(e,s){e.name===t.name&&a.statisticsResult.splice(s,1)})})})):(this.countOptionSelectArr.push(t.name),this.newCollegeOrPlayerData.forEach(function(t,a){t.details.forEach(function(t){t.name===e.countOptionMark&&(t.statisticsResult=[],e.countOptionData.details.forEach(function(a,s){if(e.countOptionSelectArr.indexOf(a.name)>=0){var o=JSON.parse(i()(a));t.statisticsResult.push(o)}}))})}));else if(a>=0)this.countOptionSelectArr.splice(a,1),0===this.countOptionSelectArr.length?(this.isCombination?(this.countData[this.countOptionIndex].details.forEach(function(a,s){a.name===t.name&&e.countData[e.countOptionIndex].details.splice(s,1)}),this.countItemData.splice(this.countOptionIndex,1),this.newAddcountItem.splice(this.countOptionIndex,1),this.countOptionArr.selectArr.splice(this.countOptionIndex,1),this.countData.splice(this.countOptionIndex,1)):this._checkCountItem(this.curCountOptions,this.countOptionIndex),n()(".count-list-more").addClass("display-none"),n()(".count-list-more").removeClass("display-block")):this.isCombination?this.countData[this.countOptionIndex].details.forEach(function(a,s){a.name===t.name&&e.countData[e.countOptionIndex].details.splice(s,1)}):this.countData.forEach(function(a,s){a.name===e.countOptionMark&&a.details.forEach(function(e,s){e.name===t.name&&a.details.splice(s,1)})});else{if(this.countOptionSelectArr.push(t.name),1===this.countOptionSelectArr.length)if(this.isCombination)this.countItemData.forEach(function(t,a){e.countOptionMark===t.name&&e.countData.push(JSON.parse(i()(t)))});else{if(this.countData=[],this.countItemSelectArr.push(this.countOptionMark),this.countItemData.forEach(function(t,a){e.countItemSelectArr.indexOf(t.name)>=0&&e.countData.push(JSON.parse(i()(t)))}),this.newAddcountItem.length>0)JSON.parse(i()(this.newAddcountItem)).reverse().forEach(function(t){e.countData.unshift(t)});this.countData.forEach(function(t,a){t.details.forEach(function(s,i){if(e.countOptionArr.selectArr[a].value.indexOf(s.name)<0){var o=t.details.length-e.countOptionArr.selectArr[a].value.length;t.details.splice(i,o)}})})}this.countData[this.countOptionIndex].details=[],this.countOptionData.details.forEach(function(t,a){if(e.countOptionSelectArr.indexOf(t.name)>=0){var s=JSON.parse(i()(t));e.countData[e.countOptionIndex].details.push(s)}})}},_checkCombCountItem:function(t,e){var a=this,s=this.combCountItemSelectData.nameArr.indexOf(t.name);if(s>=0)this.combCountItemSelectData.nameArr.splice(s,1),this.combCountItemSelectData.titleArr.splice(s,1),this.selectCombOptions.forEach(function(t,s){t.id===e&&a.selectCombOptions.splice(s,1)});else{if(this.combCountItemSelectData.nameArr.length>=4)return this.$toast("最多只能选择4个统计项"),!1;this.combCountItemSelectData.nameArr.push(t.name),this.combCountItemSelectData.titleArr.push(t.title);var i=[];t.details.forEach(function(t){i.push(t.name)}),this.selectCombOptions.push({id:e,selectArr:i})}},_clickCombCountItem:function(t,e,a){var s=this;n()(t.target).siblings(".count-list-more").addClass("display-block"),n()(t.target).siblings(".count-list-more").removeClass("display-none"),this.selectCombOptions.forEach(function(t,e){t.id===a&&(s.curSelectCombOptions=t.selectArr)}),this.combCountOptionIndex=a,this.combCountOptionData=JSON.parse(i()(e))},_checkCombCountOption:function(t){var e=this.curSelectCombOptions.indexOf(t.name);e>=0?this.curSelectCombOptions.splice(e,1):this.curSelectCombOptions.push(t.name)},_closeCountItemModal:function(t){n()(t.target).parent().parent(".count-list-more").addClass("display-none"),n()(t.target).parent().parent(".count-list-more").removeClass("display-block")},_deleteCombCount:function(t,e){var a=this;this.newAddcountItem.splice(e,1),this.countItemData.forEach(function(e,s){t.name===e.name&&a.countItemData.splice(s,1)}),this.countData.forEach(function(e,s){t.name===e.name&&a.countData.splice(s,1)}),this.countOptionArr.selectArr.splice(e,1);var s=this.newAddcountItem.length;this.countOptionArr.selectArr.forEach(function(t,e){t.id=e<=s-1?e:t.id-1})},_sureCombination:function(t){var e=this;if(t)return!1;if(this.combCountItemSelectData.nameArr.length<=1)this.$toast("至少选择2个统计项");else{this.isDisabled=!0;var a=[];this.selectCombOptions.forEach(function(t){a.push(t.selectArr)}),this.combstatisticsItems.options=this.multiCartesian(a);var s=0,o=0,n=this.combCountItemSelectData.nameArr.length;this.combCountItemSelectData.nameArr.forEach(function(t){var a="";a=n===++s?"":"x",e.combstatisticsItems.name+=t+a}),this.combCountItemSelectData.titleArr.forEach(function(t){var a="";a=n===++o?"":"x",e.combstatisticsItems.title+=t+a});var r=[];r.push(this.combstatisticsItems),Object(c.e)({url:"/api/statistics/formEngine/business/"+this.curBusinessId+"/statistics?playerId="+this.playerId,type:"post",data:{statisticsItems:r},success:function(t){e.isDisabled=!1,t.state?(t.data.forEach(function(t){var a=[];e.countData.unshift(JSON.parse(i()(t))),e.countItemData.unshift(JSON.parse(i()(t))),t.details.forEach(function(t){a.push(t.name)}),e.countOptionArr.selectArr.forEach(function(t,e){var a=t.id+1;t.id=a});var s={id:0,value:a};e.countOptionArr.selectArr.unshift(JSON.parse(i()(s))),e.newAddcountItem.unshift(t)}),e.isAddCombinationCount=!1):e.$toast(t.message)}})}},cartesian:function(t,e){for(var a=[],s=0;s<t.length;s++)for(var i=0;i<e.length;i++)a.push(this.getCombinationStr(t[s],e[i]));return a},getCombinationStr:function(t,e){return t+"&"+e},multiCartesian:function(t){var e=t.length;if(0==e)return[];if(1==e)return t[0];for(var a=t[0],s=1;s<e;s++)a=this.cartesian(a,t[s]);return a},_showCombinationCount:function(){this.isAddCombinationCount=!0,this.combstatisticsItems={combination:!0,title:"",name:"",options:[]},this.combCountItemSelectData.nameArr=[],this.combCountItemSelectData.titleArr=[],this.selectCombOptions=[]},_exportCurCount:function(t,e){var a=this;this.$waiting.show();var s=new Date,o=s.getMonth()+1,n=s.getDate(),r=s.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(n<10?"0"+n:n),l=t.title+"统计"+r+".xlsx",u={},d=[];this.isCollegeOrPlayer?(t.statisticsResult.forEach(function(t){d.push(t.name)}),this.$set(u,"combination",!1)):(t.details.forEach(function(t){d.push(t.name)}),this.$set(u,"combination",t.combination)),this.$set(u,"title",t.title),this.$set(u,"name",t.name),this.$set(u,"options",d);var h=i()(u);Object(c.e)({url:"/api/statistics/formEngine/excel/token",type:"post",data:{file_export_params:h},success:function(t){if(t.state){var s="";1===a.curCheckType?s=a.exportCurCountUrl+"&fileName="+l+"&token="+t.data:2===a.curCheckType?s=a.exportCurCountUrl+"&collegeCode="+e.name+"&fileName="+l+"&token="+t.data:3===a.curCheckType?s=a.exportCurCountUrl+"&instructorUserId="+e.name+"&fileName="+l+"&token="+t.data:4===a.curCheckType&&(s=a.exportCurCountUrl+"&instructorUserId="+e.name+"&fileName="+l+"&token="+t.data),window.location.href=s}else a.$toast(t.message)}}).always(function(){a.$waiting.close()})},changeCountTab:function(t){var e=this;if("export"===t){this.$waiting.show();var a=this.countCollegeName+this.countGradeName+this.countStudentTypeName,s=new Date,o=s.getMonth()+1,n=s.getDate(),r=s.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(n<10?"0"+n:n),l=a+this.curApp.name+"统计"+r+".xlsx",u=[],d=JSON.parse(i()(this.countData)),h="",p="";1===this.curCheckType?(d.forEach(function(t){var a=t.details;delete t.details,e.$set(t,"options",[]),a.forEach(function(e){t.options.push(e.name)}),u.push(t)}),p=i()(u)):p=i()(this.curStatisticsItems),Object(c.e)({url:"/api/statistics/formEngine/excel/token",type:"post",data:{file_export_params:p},success:function(t){t.state?(h=(e.curCheckType,e.exportCountUrt+"&fileName="+l+"&token="+t.data),window.location.href=h):e.$toast(t.message)}}).always(function(){e.$waiting.close()})}else this.countTabActive="filter"===t?"filter":"setting"},_closeCountModal:function(){var t=this;this.countModal=!1,this.saveCountData.countTabActive=this.countTabActive,this.saveCountData.countData=this.countData,this.saveCountData.countItemSelectArr=this.countItemSelectArr,this.saveCountData.oldCountItemData=this.countItemData,this.saveCountData.combCountItemData=this.combinationCountItemData,this.saveCountData.newAddcountItem=this.newAddcountItem,this.saveCountData.countOptionArray=this.countOptionArr.selectArr;var e=i()(this.saveCountData);Object(c.e)({url:"/api/statistics/business/"+this.curBusinessId+"/settings/cache?playerId="+this.playerId,type:"put",data:{data:e},success:function(e){e.state||t.$toast(e.message)}})}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.curApp?a("div",{staticClass:"app-detail-page-form",class:t.data?"":"sub"},[a("div",{staticClass:"header"},[t.data?t._e():a("i",{staticClass:"maticon pull-left back-link",domProps:{innerHTML:t._s(t.icons("arrow_back"))},on:{click:t._back}},[t._v("arrow_back")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.collapsed,expression:"collapsed"}],staticClass:"appNameControl"},[t._v(t._s(t.curApp.name))]),t._v(" "),a("a",{staticClass:"pull-right apartment-link",attrs:{href:"javascript:;"},on:{click:function(e){return t.unfoldAndfold()}}},[t.collapsed?a("span",[t._v("展开")]):a("span",[t._v("收起")])]),t._v(" "),t.headerShow?a("div",{staticClass:"title-div",class:t.collapsed?"collapsed":""},[a("div",{staticClass:"app-icon-div"},[a("div",{style:{"background-image":t.curApp.background}},[t.curApp.imgType&&"1"!==t.curApp.imgType?"2"===t.curApp.imgType?a("i",{staticClass:"app-icon"},[a("span",{staticClass:"saasicon-44px",class:["saasicon-44px-"+t.curApp.imgPath]})]):t._e():a("i",{staticClass:"maticon app-icon",domProps:{innerHTML:t._s(t.icons(t.curApp.imgPath))}},[t._v(t._s(t.curApp.imgPath))])])]),t._v(" "),a("div",{staticClass:"form-group app-name"},[a("label",[t._v(t._s(t.curApp.name))])]),t._v(" "),t.businessList.length>0?a("div",{staticClass:"input-group app-business"},[a("span",{staticClass:"input-group-addon"},[t._v("业务期")]),t._v(" "),a("v-select",{staticClass:"btn-block",attrs:{options:t.businessList,"options-value":"id","options-label":"name","close-on-select":"",justify:""},on:{afterSelected:t._afterSelectBusiness},model:{value:t.curBusinessId,callback:function(e){t.curBusinessId=e},expression:"curBusinessId"}})],1):t._e(),t._v(" "),a("div",{staticClass:"input-group text-center app-business"},[a("span",[t._v(t._s(t.errorMessage))])])]):t._e(),t._v(" "),a("div",{staticClass:"tab-div"},[t.curBusiness?a("GeminiScrollbar",{staticClass:"tab-container",attrs:{scrollY:!1}},[t.curBusiness?a("div",{staticClass:"tab",class:"guide"===t.curTab?"active":"",attrs:{title:"指南"},on:{click:function(e){return t.guide()}}},[t._v("指南")]):t._e(),t._v(" "),t.curBusiness&&t.curBusiness.canApplyOnAuthority?a("div",{staticClass:"tab",class:"preview"===t.curTab?"active":"",attrs:{title:"我的表单"},on:{click:function(e){return t.myForm()}}},[t._v("我的表单")]):t._e(),t._v(" "),t._l(t.curBusiness.players,function(e,s){return t.curBusiness?a("div",{key:s,staticClass:"tab",class:t.curTab===e.name?"active":"",attrs:{title:e.name},on:{click:function(a){return t.showPlayerTable(e)}}},[t._v(t._s(e.name))]):t._e()})],2):t._e()],1)]),t._v(" "),t.curBusiness?a("div",{staticClass:"middle",class:t.collapsed?"middle-top":""},["guide"===t.curTab?a("GeminiScrollbar",{staticClass:"tab-content"},[a("div",{staticClass:"guide-content",domProps:{innerHTML:t._s(t.curBusiness.business.guide)}})]):t._e(),t._v(" "),t.myFormPreview?a("div",{staticClass:"preview-container"},[t.multiForm?a("div",{staticClass:"tab-content"},[a("v-table",{directives:[{name:"show",rawName:"v-show",value:t.tableShowControl&&!t.countPartShow&&!t.showPlayerForm,expression:"tableShowControl&&(!countPartShow)&&(!showPlayerForm)"}],attrs:{pagesize:"10",idField:"id",url:t.myFormTableUrl,columnsControl:!0,method:t.method,order:!0,search:!1,columns:t.myFormsColumn},on:{columnExchanged:t._columnExchanged2}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn add clearBtnBorder add-form-btn",attrs:{type:"button"},on:{click:t._addForm}},[t._v("新增")])])])],1):a("div",[a("preview",{attrs:{appid:t.data.appData.id,data:t.formData_components,title:t.formData_name,backArrowControl:t.backControl,script:t.formData_property_script,saveBtnContrl:t.saveBtnContrl,log:t.log,defaultData:t.recordData,businessId:t.curBusinessId,previewformType:"curPage",previewType:"form",fileServer:t.uploadFile},on:{exportModel:t.exportModel,submit:t._submit,back:function(e){t.showPlayerForm=!1}}})],1)]):t._e(),t._v(" "),t.showPlayerForm?a("div",{staticClass:"preview-container"},[a("preview",{attrs:{appid:t.data.appData.id,data:t.formData_components_check,title:t.formData_name_check,saveBtnContrl:t.saveBtnContrl,script:t.formData_property_script_check,log:t.log,defaultData:t.recordData,previewformType:"childerPage",previewType:"form",fileServer:t.uploadFile},on:{submit:t._submit,back:function(e){t.showPlayerForm=!1,t._focus()},exportModel:t.exportModel}})],1):t._e(),t._v(" "),t.partnerContent?a("div",{staticClass:"partner-table app-detail-table"},[t.importPartners?a("v-import",t._b({on:{backParentPage:function(e){return t.backParentPage()}}},"v-import",t.importParams,!1)):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tableShowControl&&!t.countPartShow&&!t.showPlayerForm,expression:"tableShowControl&&(!countPartShow)&&(!showPlayerForm)"}],staticClass:"business-node-time",domProps:{innerHTML:t._s(t.curBusinessTime)}}),t._v(" "),a("v-table",{directives:[{name:"show",rawName:"v-show",value:t.tableShowControl&&!t.countPartShow&&!t.showPlayerForm,expression:"tableShowControl&&(!countPartShow)&&(!showPlayerForm)"}],ref:t.curTab+"_table",attrs:{columnsControl:!0,url:t.url+t.advancedSearchParams+t.sortParams,method:t.method,pagesize:"10",order:!0,idField:"id",columns:t.columns,search:!1},on:{columnExchanged:t._columnExchanged,srotClick:t._srotClick}},[a("span",{attrs:{slot:"btn-group"},slot:"btn-group"},[a("span",{staticClass:"pull-right operation-group",on:{click:function(e){return t._showBaobiao()}}},[t._v("报表")]),t._v(" "),a("span",{staticClass:"pull-right operation-group export",on:{click:function(e){return t.exportOperation()}}},[t._v("导出")]),t._v(" "),t.curPlayer.batch?a("span",{class:t.curPlayer.batch?"operation-group":"operation-group-disabled",on:{click:function(e){return t.bulkOperation()}}},[t._v("通过Excel批量操作")]):t._e(),t._v(" "),a("span",{staticClass:"pull-right operation-group",on:{click:function(e){return t._showCountModal()}}},[t._v("统计")]),t._v(" "),a("span",{staticClass:"pull-right operation-group export",on:{click:function(e){return t._showSearch()}}},[t._v("高级搜索")])])])],1):t._e(),t._v(" "),a("v-modal",{staticClass:"modelBaobiao",attrs:{show:t.showSearchModel,effect:"fade",width:"720"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("高级搜索")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[t._l(t.advancedSearch.searchItems,function(e,s){return a("div",{key:"search-item-"+s,staticClass:"form-group advancedSearch-group"},[a("div",{staticClass:"box_flex align_center advanced"},[a("v-select",{attrs:{options:t.advancedSearch.tableOptions,"options-value":"name","options-label":"title",search:!0},on:{afterSelected:function(a){return t.advanceSelected("table",e)}},model:{value:e.table,callback:function(a){t.$set(e,"table",a)},expression:"searchItem.table"}}),t._v(" "),e.tableChild?t._e():a("v-select",{attrs:{options:e.condition,search:!0},on:{afterSelected:t.advanceSelected},model:{value:e.conditionVal,callback:function(a){t.$set(e,"conditionVal",a)},expression:"searchItem.conditionVal"}}),t._v(" "),"empty"!==e.conditionVal&&"filled"!==e.conditionVal?a("div",{staticClass:"box_flex align_center"},[e.table&&-1!==e.table.indexOf("table")?a("v-select",{attrs:{options:t.getTableChildList(e.table),search:!0,"options-value":"name","options-label":"title","data-index":s},on:{afterSelected:function(a){return t.advanceSelected("tableChild",e)}},model:{value:e.tableChild,callback:function(a){t.$set(e,"tableChild",a)},expression:"searchItem.tableChild"}}):t._e(),t._v(" "),e.tableChild?a("v-select",{attrs:{options:e.childCondition,search:!0},on:{afterSelected:t.advanceSelected},model:{value:e.childConditionVal,callback:function(a){t.$set(e,"childConditionVal",a)},expression:"searchItem.childConditionVal"}}):t._e(),t._v(" "),"empty"!==e.childConditionVal&&"filled"!==e.childConditionVal?a("div",{staticClass:"box_flex align_center"},[e.table&&-1!==e.table.indexOf("address")?a("v-select",{attrs:{options:t.getAddressOptions("province"),search:!0,"options-value":"name","options-label":"name","data-index":s},on:{afterSelected:t.advanceSelected},model:{value:e.province,callback:function(a){t.$set(e,"province",a)},expression:"searchItem.province"}}):t._e(),t._v(" "),e.province&&e.table&&-1!==e.table.indexOf("address")?a("v-select",{attrs:{options:t.getAddressOptions("city",e.province),search:!0,"options-value":"name","options-label":"name"},on:{afterSelected:t.advanceSelected},model:{value:e.city,callback:function(a){t.$set(e,"city",a)},expression:"searchItem.city"}}):t._e(),t._v(" "),e.city&&-1!==e.table.indexOf("address")?a("v-select",{attrs:{options:t.getAddressOptions("area",e.city,e.province),search:!0,"options-value":"name","options-label":"name"},on:{afterSelected:t.advanceSelected},model:{value:e.area,callback:function(a){t.$set(e,"area",a)},expression:"searchItem.area"}}):t._e(),t._v(" "),!(e.table&&-1!==e.table.indexOf("select")||e.table&&-1!==e.table.indexOf("radio"))||"eq"!==e.conditionVal&&"ne"!==e.conditionVal?"in"===e.conditionVal||"nin"===e.conditionVal||e.table&&-1!==e.table.indexOf("checkbox")&&("eq"===e.conditionVal||"ne"===e.conditionVal)?a("v-select",{attrs:{options:t.getInOptions(e.table),search:!0,multiple:"true"},on:{afterSelected:t.advanceSelected},model:{value:e.values,callback:function(a){t.$set(e,"values",a)},expression:"searchItem.values"}}):-1===e.tableChild.indexOf("checkbox")||"eq"!==e.childConditionVal&&"ne"!==e.childConditionVal?"in"!==e.childConditionVal&&"nin"!==e.childConditionVal&&(-1===e.tableChild.indexOf("select")&&-1===e.tableChild.indexOf("radio")||"eq"!==e.childConditionVal&&"ne"!==e.childConditionVal)?e.table&&-1===e.table.indexOf("address")?a("input",{directives:[{name:"model",rawName:"v-model",value:e.values,expression:"searchItem.values"}],staticClass:"value-input",attrs:{type:"text"},domProps:{value:e.values},on:{input:function(a){a.target.composing||t.$set(e,"values",a.target.value)}}}):t._e():a("v-select",{attrs:{options:t.getInOptions(e.table,e.tableChild),search:!0,multiple:"true"},on:{afterSelected:t.advanceSelected},model:{value:e.values,callback:function(a){t.$set(e,"values",a)},expression:"searchItem.values"}}):a("v-select",{attrs:{options:t.getInOptions(e.table,e.tableChild),search:!0},on:{afterSelected:t.advanceSelected},model:{value:e.values,callback:function(a){t.$set(e,"values",a)},expression:"searchItem.values"}}):a("v-select",{attrs:{options:t.getInOptions(e.table),search:!0},on:{afterSelected:t.advanceSelected},model:{value:e.values,callback:function(a){t.$set(e,"values",a)},expression:"searchItem.values"}})],1):t._e()],1):t._e(),t._v(" "),a("button",{staticClass:"btn deleteBtn clearBtnBorder",staticStyle:{"margin-left":"12px"},attrs:{type:"button","data-index":s},on:{click:function(e){return t.deleteSearchItem(s)}}},[t._v("删除")])],1)])}),t._v(" "),a("button",{staticClass:"btn addBtn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.addSearchItem()}}},[t._v("新增")])],2),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showSearchModel=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",class:{disabled:t.isDisabled},attrs:{type:"button"},on:{click:function(e){return t.execAdvancedSearch()}}},[t._v("搜索")])])]),t._v(" "),a("v-modal",{staticClass:"outputModal",attrs:{show:t.outputModalShow,effect:"fade",width:"520"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("导出——字段选择")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("ul",{staticClass:"list-group"},t._l(t.formFields,function(e,s){return t.notAllowOutput.indexOf(e.componentType)<0?a("li",{key:s,staticClass:"list-group-item field-item",class:t.outputList.indexOf(e.name)<0?"":"output-active",on:{click:function(a){return t._changeOutputList(e)}}},[t.outputList.indexOf(e.name)<0?a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")]):a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]),t._v(" "),a("span",[t._v(t._s(e.title))])]):t._e()}),0)]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("div",{staticClass:"input-group merge-table pull-left"},[a("span",{on:{click:t._mergeTable}},[t.isMergeTable?a("i",{staticClass:"maticon role-icon",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon role-icon",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"role-name"},[t._v("是否将勾选的字段合并在同个表格")])]),t._v(" "),a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.outputModalShow=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._sureToOutput}},[t._v("确定")])])]),t._v(" "),a("v-modal",{staticClass:"modelBaobiao",attrs:{show:t.showBaobiaomodel,effect:"fade",width:"650"}},[a("div",{staticClass:"modal-body",staticStyle:{height:"500px !important",overflow:"hidden"},attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"tab-div"},t._l(t.jisuanArray,function(e,s){return a("div",{staticClass:"tab",class:{active:t.clickIndex==s},on:{click:function(e){return t._checkBiao(s)}}},[t._v(t._s(e.reportName))])}),0),t._v(" "),a("div",{staticClass:"middle",staticStyle:{overflow:"hidden"}},[a("div",{staticClass:"left_menu",staticStyle:{"overflow-x":"hidden","overflow-y":"auto"}},t._l(t.jisuanArray[t.clickIndex].appReportFlowRangeVO,function(e){return a("div",{staticClass:"menu_item"},[a("p",{staticClass:"titlemenu"},[t._v(t._s("全校"==e.range?"":e.range+":"))]),t._v(" "),t._l(e.appReportCountVO,function(e){return a("p",{staticClass:"caculate"},[a("span",{staticClass:"fx"},[t._v(t._s(e.countName))]),t._v(" "),a("span",{staticClass:"zhi"},[t._v(t._s(e.countResult))])])})],2)}),0),t._v(" "),a("div",{staticClass:"right_select"},[a("h5",{staticClass:"titleselect"},[t._v("选择表单统计范围 :")]),t._v(" "),"bySchool"==t.curPlayerType?a("div",{staticClass:"info-options"},[a("span",{on:{click:function(e){return t._setValue(1)}}},[a("i",{staticClass:"maticon",class:1==t.opt?"active":"",domProps:{innerHTML:t._s(t.icons(1==t.opt?"radio_button_checked":"radio_button_unchecked"))}}),t._v("全校\n              ")])]):t._e(),t._v(" "),"byCollege"==t.curPlayerType||"bySchool"==t.curPlayerType?a("div",{staticClass:"info-options"},[a("span",{on:{click:function(e){return t._setValue(2)}}},[a("i",{staticClass:"maticon",class:2==t.opt?"active":"",domProps:{innerHTML:t._s(t.icons(2==t.opt?"radio_button_checked":"radio_button_unchecked"))}}),t._v("各学院对比\n              ")])]):t._e(),t._v(" "),"byTeacher"==t.curPlayerType||"byCollege"==t.curPlayerType||"bySchool"==t.curPlayerType?a("div",{staticClass:"info-options"},[a("span",{on:{click:function(e){return t._setValue(3)}}},[a("i",{staticClass:"maticon",class:3==t.opt?"active":"",domProps:{innerHTML:t._s(t.icons(3==t.opt?"radio_button_checked":"radio_button_unchecked"))}}),t._v("各辅导员对比\n              ")])]):t._e(),t._v(" "),"byClass"==t.curPlayerType||"bySchool"==t.curPlayerType||"byCollege"==t.curPlayerType||"byTeacher"==t.curPlayerType?a("div",{staticClass:"info-options"},[a("span",{on:{click:function(e){return t._setValue(4)}}},[a("i",{staticClass:"maticon",class:4==t.opt?"active":"",domProps:{innerHTML:t._s(t.icons(4==t.opt?"radio_button_checked":"radio_button_unchecked"))}}),t._v("各班级对比\n              ")])]):t._e()])])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showBaobiaomodel=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._baobiaoExport}},[t._v("导出")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showDetail,effect:"fade"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(t._s(t.student.name))])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},t._l(t.student.categories,function(e,s){return a("div",{key:s,staticClass:"category"},[a("p",{staticClass:"text-muted category-title"},[t._v(t._s(e.title))]),t._v(" "),a("ul",{staticClass:"category-list"},t._l(e.fields,function(e,s){return a("li",{key:s},[a("span",{staticClass:"field-name"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"field-value"},[t._v(t._s(e.value||t.fieldDefaultText))])])}),0)])}),0),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showDetail=!1}}},[t._v("返回")])])])],1):t._e(),t._v(" "),a("v-modal",{staticClass:"count-modal",staticStyle:{top:"-10px"},attrs:{show:t.countModal,effect:"fade",width:"1080"}},[a("div",{staticClass:"modal-header count-header box_flex box_between",attrs:{slot:"modal-header"},slot:"modal-header"},[a("div",{staticClass:"box_flex align_center"},[a("i",{staticClass:"maticon close-modal",domProps:{innerHTML:t._s(t.icons("close"))},on:{click:t._closeCountModal}},[t._v("close")]),t._v(" "),a("span",{staticClass:"count-title"},[t._v("统计")])]),t._v(" "),a("div",{staticClass:"pull-right modal-header-right"},[a("i",{staticClass:"maticon upload-all-count",class:{active:"upload"===t.countTabActive},attrs:{title:"导出"},domProps:{innerHTML:t._s(t.icons("file_download"))},on:{click:function(e){return t.changeCountTab("export")}}},[t._v("file_download")]),t._v(" "),a("i",{staticClass:"maticon filter-icon",class:{active:"filter"===t.countTabActive},attrs:{title:"筛选"},domProps:{innerHTML:t._s(t.icons("filter_list"))},on:{click:function(e){return t.changeCountTab("filter")}}},[t._v("filter_list")]),t._v(" "),a("i",{staticClass:"maticon setting-icon",class:{active:"setting"===t.countTabActive},attrs:{title:"设置"},domProps:{innerHTML:t._s(t.icons("settings"))},on:{click:function(e){return t.changeCountTab("setting")}}},[t._v("settings")])])]),t._v(" "),a("div",{attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"row count-row"},[t.isCollegeOrPlayer?a("div",[t.newCurCountData.length>0?a("div",{staticClass:"count-modal-left",class:t.countTabActive?"col-sm-9":"col-sm-12",style:"height:"+t.countContentHeight+"px;"},t._l(t.newCurCountData,function(e,s){return a("div",{key:s,staticClass:"row bar-row"},[a("div",{staticClass:"col-sm-2 count-bar-title",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"col-sm-10 new-count-left-chart"},t._l(e.details,function(s,i){return s.isShow?a("div",{key:i,staticClass:"new-count-container"},[a("div",{staticClass:"new-title",attrs:{title:s.title}},[t._v(t._s(s.title))]),t._v(" "),a("div",{staticClass:"count-bar-container",style:"500px;",attrs:{title:t.countTabActive}},t._l(s.statisticsResult,function(e,i){return a("div",{key:i,staticClass:"bar-container",style:"width:"+((t.newBarLength-s.statisticsResult.length*t.barCircleWidth)*parseFloat(e.percent)/100+8)+"px;"},[a("p",{staticClass:"count-bar",style:"opacity:"+(1-(s.statisticsResult.length>0?.75*i/s.statisticsResult.length:0))+";",attrs:{title:e.name+" "+e.percent}}),t._v(" "),(t.newBarLength-s.statisticsResult.length*t.barCircleWidth)*parseFloat(e.percent)/100+8>=40?a("p",{staticClass:"count-bar-text",style:"width:"+((t.newBarLength-s.statisticsResult.length*t.barCircleWidth)*parseFloat(e.percent)/100+8)+"px;",attrs:{title:e.name+" "+e.count+"人"}},[t._v(t._s(e.name)+" "+t._s(e.count)+"人")]):a("p",{staticClass:"count-bar-text"},[t._v(" ")])])}),0),t._v(" "),a("i",{staticClass:"maticon more-vert-icon dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))}},[t._v("more_vert")]),t._v(" "),a("ul",{staticClass:"dropdown-menu count-bar-more"},[a("li",{on:{click:function(a){return t._exportCurCount(s,e)}}},[t._v("导出此统计项数据")])])]):t._e()}),0)])}),0):a("div",{staticClass:"count-modal-left",class:t.countTabActive?"col-sm-9":"col-sm-12",style:"height:"+t.countContentHeight+"px;"},[a("h3",{staticClass:"text-center"},[t._v("暂无统计")])])]):a("div",[t.curCountData.length>0?a("div",{staticClass:"count-modal-left",class:t.countTabActive?"col-sm-9":"col-sm-12",style:"height:"+t.countContentHeight+"px;"},t._l(t.curCountData,function(e,s){return a("div",{key:s,staticClass:"row bar-row"},[a("div",{staticClass:"col-sm-2 count-bar-title",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"col-sm-10 count-left-chart"},[a("div",{staticClass:"count-bar-container",style:558},t._l(e.details,function(s,i){return a("div",{key:i,staticClass:"bar-container",style:"width:"+((t.barLength-e.details.length*t.barCircleWidth)*parseFloat(s.percent)/100+8)+"px;"},[a("p",{staticClass:"count-bar",style:"opacity:"+(1-(e.details.length>0?.75*i/e.details.length:0))+";",attrs:{title:s.name+" "+s.percent}}),t._v(" "),(t.barLength-e.details.length*t.barCircleWidth)*parseFloat(s.percent)/100+8>=40?a("p",{staticClass:"count-bar-text",style:"width:"+((t.barLength-e.details.length*t.barCircleWidth)*parseFloat(s.percent)/100+8)+"px;",attrs:{title:s.name+" "+s.count+"人"}},[t._v(t._s(s.name)+" "+t._s(s.count)+"人")]):a("p",{staticClass:"count-bar-text"},[t._v(" ")])])}),0),t._v(" "),a("i",{staticClass:"maticon more-vert-icon dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))}},[t._v("more_vert")]),t._v(" "),a("ul",{staticClass:"dropdown-menu count-bar-more"},[a("li",{on:{click:function(a){return t._exportCurCount(e)}}},[t._v("导出此统计项数据")])])])])}),0):a("div",{staticClass:"count-modal-left",class:t.countTabActive?"col-sm-9":"col-sm-12",style:"height:"+t.countContentHeight+"px;"},[a("h3",{staticClass:"text-center"},[t._v("暂无统计")])])]),t._v(" "),t.countTabActive?a("div",{staticClass:"col-sm-3 count-modal-right"},["filter"===t.countTabActive?a("div",{staticClass:"filter-container",style:"height:"+t.setHeight+"px;"},[2!=t.curCheckType?a("v-select",{staticClass:"btn-block filter-select",attrs:{options:t.collegeSelectOptions,"options-value":"code","options-label":"name",value:t.defaultOptions.college,autoSelect:!1},on:{afterSelected:t._afterSelectCollege}}):t._e(),t._v(" "),a("v-select",{staticClass:"btn-block filter-select",attrs:{options:t.gradeOptions,"options-value":"id","options-label":"label",autoSelect:!1,value:t.defaultOptions.grade},on:{afterSelected:t._afterSelectGrade}}),t._v(" "),a("v-select",{staticClass:"btn-block filter-select",attrs:{options:t.dictTypes,"options-value":"value","options-label":"label",autoSelect:!1,value:t.defaultOptions.studentType},on:{afterSelected:t._afterSelectDisTypes}})],1):"setting"===t.countTabActive?a("div",{staticClass:"setting-container"},[t.isAddCombinationCount?a("div",{staticClass:"add-combination-count",style:"height:"+t.setHeight+"px;"},[a("div",{staticClass:"header-title"},[t._v("组合统计项")]),t._v(" "),a("div",{staticClass:"combination-count-list",style:"height:"+t.combContentHeight+"px;"},t._l(t.combinationCountItemData,function(e,s){return a("div",{key:s,staticClass:"input-group"},[a("span",{on:{click:function(a){return t._checkCombCountItem(e,s)}}},[t.combCountItemSelectData.nameArr.indexOf(e.name)>=0?a("i",{staticClass:"maticon checkbox-icon checked-color active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon checkbox-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"checkbox-name",class:t.combCountItemSelectData.nameArr.indexOf(e.name)>=0?"checked-color":"unchecked-color",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),t.combCountItemSelectData.nameArr.indexOf(e.name)>=0?a("i",{staticClass:"maticon pull-right more-icon dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))},on:{click:function(a){return t._clickCombCountItem(a,e,s)}}},[t._v("more_vert")]):t._e(),t._v(" "),a("ul",{staticClass:"dropdown-menu count-list-more"},[a("div",{staticClass:"creat-modal-header"},[a("i",{staticClass:"maticon pull-right close-btn",domProps:{innerHTML:t._s(t.icons("close"))},on:{click:t._closeCountItemModal}},[t._v("close")])]),t._v(" "),a("div",{staticClass:"creat-modal-content"},t._l(e.details,function(e,s){return a("div",{staticClass:"input-group"},[a("span",{on:{click:function(a){return t._checkCombCountOption(e)}}},[t.curSelectCombOptions.indexOf(e.name)>=0?a("i",{staticClass:"maticon checkbox-icon checked-color active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon checkbox-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"checkbox-name",class:t.curSelectCombOptions.indexOf(e.name)>=0?"checked-color":"unchecked-color",attrs:{title:e.name}},[t._v(t._s(e.name))]),t._v(" "),a("i",{staticClass:"maticon pull-right more-icon",domProps:{innerHTML:t._s(t.icons("more_vert"))}},[t._v("more_vert")])])}),0)])])}),0),t._v(" "),a("div",{staticClass:"combination-count-footer"},[a("button",{staticClass:"btn pull-right count-sureBtn clearBtnBorder",class:{disabled:t.isDisabled},attrs:{type:"button"},on:{click:function(e){return t._sureCombination(t.isDisabled)}}},[t._v("确定")]),t._v(" "),a("button",{staticClass:"btn pull-right count-cancelBtn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.isAddCombinationCount=!1}}},[t._v("取消")])])]):a("div",{staticClass:"setting-container-list box_flex column",style:"height:"+t.setHeight+"px;"},[a("div",{staticClass:"radio-list flex_shrink"},t._l(t.countRadios,function(e,s){return e.isShow?a("div",{key:s,staticClass:"input-group"},[a("span",[e.isChecked?a("i",{staticClass:"maticon radio-icon checked-color",domProps:{innerHTML:t._s(t.icons("radio_button_checked"))},on:{click:function(a){return t._changeRadio(s,e)}}},[t._v("radio_button_checked")]):a("i",{staticClass:"maticon radio-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("radio_button_unchecked"))},on:{click:function(a){return t._changeRadio(s,e)}}},[t._v("radio_button_unchecked")])]),t._v(" "),a("span",{staticClass:"radio-name",class:e.isChecked?"checked-color":"unchecked-color"},[t._v(t._s(e.label))])]):t._e()}),0),t._v(" "),t.isCollegeOrPlayer?t._e():a("div",{staticClass:"add-btn"},[a("button",{staticClass:"btn add-combination-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._showCombinationCount}},[t._v("新增组合统计项")])]),t._v(" "),a("div",{staticClass:"combination-count-list grow_1"},t._l(t.countItemData,function(e,s){return a("div",{key:s,staticClass:"input-group"},[e.combination?a("span",[a("i",{staticClass:"maticon checkbox-icon checked-color",domProps:{innerHTML:t._s(t.icons("delete"))},on:{click:function(a){return t._deleteCombCount(e,s)}}},[t._v("delete")])]):a("span",[t.isCollegeOrPlayer?a("span",{on:{click:function(a){return t._changeCountRadio(s,e)}}},[t.multipleSelectComparison.indexOf(e.name)>=0?a("i",{staticClass:"maticon checkbox-icon checked-color active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon checkbox-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]):a("span",{on:{click:function(a){return t._checkCountItem(e,s)}}},[t.countItemSelectArr.indexOf(e.name)>=0?a("i",{staticClass:"maticon checkbox-icon checked-color active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon checkbox-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])])]),t._v(" "),a("span",{staticClass:"checkbox-name",class:t.countItemSelectArr.indexOf(e.name)>=0?"checked-color":"unchecked-color",attrs:{title:e.title}},[t._v(t._s(e.title))]),t._v(" "),t.isCollegeOrPlayer?a("i",{directives:[{name:"show",rawName:"v-show",value:e.isChecked,expression:"col.isChecked"}],staticClass:"maticon pull-right more-icon unchecked-color dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))},on:{click:function(a){return t._clickCountItem(a,e,s)}}},[t._v("more_vert")]):a("i",{directives:[{name:"show",rawName:"v-show",value:t.countItemSelectArr.indexOf(e.name)>=0||e.combination,expression:"countItemSelectArr.indexOf(col.name)>=0 || col.combination"}],staticClass:"maticon pull-right more-icon unchecked-color dropdown-toggle",attrs:{"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"},domProps:{innerHTML:t._s(t.icons("more_vert"))},on:{click:function(a){return t._clickCountItem(a,e,s)}}},[t._v("more_vert")]),t._v(" "),a("ul",{staticClass:"dropdown-menu count-list-more"},[a("div",{staticClass:"creat-modal-header"},[a("i",{staticClass:"maticon pull-right close-btn",domProps:{innerHTML:t._s(t.icons("close"))},on:{click:t._closeCountItemModal}},[t._v("close")])]),t._v(" "),a("div",{staticClass:"creat-modal-content"},t._l(e.details,function(e,s){return a("div",{key:s,staticClass:"input-group"},[a("span",{on:{click:function(a){return t._checkCountOption(e)}}},[t.countOptionSelectArr.indexOf(e.name)>=0?a("i",{staticClass:"maticon checkbox-icon checked-color active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon checkbox-icon unchecked-color",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"checkbox-name",class:t.countOptionSelectArr.indexOf(e.name)>=0?"checked-color":"unchecked-color",attrs:{title:e.name}},[t._v(t._s(e.name))])])}),0)])])}),0)])]):t._e()]):t._e()])])])],1):t._e()},staticRenderFns:[]};var d=a("C7Lr")(l,u,!1,function(t){a("rzhg")},null,null);e.default=d.exports},rzhg:function(t,e){}});